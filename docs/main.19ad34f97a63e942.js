"use strict";(self.webpackChunkportafolioNuevo2=self.webpackChunkportafolioNuevo2||[]).push([[179],{781:()=>{function zt(n){return"function"==typeof n}function ju(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const $u=ju(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Gl(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class ir{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(zt(i))try{i()}catch(s){e=s instanceof $u?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{pv(s)}catch(o){e=e??[],o instanceof $u?e=[...e,...o.errors]:e.push(o)}}if(e)throw new $u(e)}}add(e){var t;if(e&&e!==this)if(this.closed)pv(e);else{if(e instanceof ir){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Gl(t,e)}remove(e){const{_finalizers:t}=this;t&&Gl(t,e),e instanceof ir&&e._removeParent(this)}}ir.EMPTY=(()=>{const n=new ir;return n.closed=!0,n})();const fv=ir.EMPTY;function hv(n){return n instanceof ir||n&&"closed"in n&&zt(n.remove)&&zt(n.add)&&zt(n.unsubscribe)}function pv(n){zt(n)?n():n.unsubscribe()}const Xs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},qu={setTimeout(n,e,...t){const{delegate:i}=qu;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=qu;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function mv(n){qu.setTimeout(()=>{const{onUnhandledError:e}=Xs;if(!e)throw n;e(n)})}function gv(){}const CI=xp("C",void 0,void 0);function xp(n,e,t){return{kind:n,value:e,error:t}}let Ys=null;function Xu(n){if(Xs.useDeprecatedSynchronousErrorHandling){const e=!Ys;if(e&&(Ys={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Ys;if(Ys=null,t)throw i}}else n()}class wp extends ir{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,hv(e)&&e.add(this)):this.destination=FI}static create(e,t,i){return new Wl(e,t,i)}next(e){this.isStopped?Mp(function II(n){return xp("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Mp(function AI(n){return xp("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Mp(CI,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const PI=Function.prototype.bind;function bp(n,e){return PI.call(n,e)}class LI{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Yu(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Yu(i)}else Yu(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Yu(t)}}}class Wl extends wp{constructor(e,t,i){let r;if(super(),zt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Xs.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&bp(e.next,s),error:e.error&&bp(e.error,s),complete:e.complete&&bp(e.complete,s)}):r=e}this.destination=new LI(r)}}function Yu(n){Xs.useDeprecatedSynchronousErrorHandling?function RI(n){Xs.useDeprecatedSynchronousErrorHandling&&Ys&&(Ys.errorThrown=!0,Ys.error=n)}(n):mv(n)}function Mp(n,e){const{onStoppedNotification:t}=Xs;t&&qu.setTimeout(()=>t(n,e))}const FI={closed:!0,next:gv,error:function NI(n){throw n},complete:gv},Sp="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ep(n){return n}let Jn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function kI(n){return n&&n instanceof wp||function OI(n){return n&&zt(n.next)&&zt(n.error)&&zt(n.complete)}(n)&&hv(n)}(t)?t:new Wl(t,i,r);return Xu(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=_v(i))((r,s)=>{const o=new Wl({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Sp](){return this}pipe(...t){return function yv(n){return 0===n.length?Ep:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=_v(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function _v(n){var e;return null!==(e=n??Xs.Promise)&&void 0!==e?e:Promise}const BI=ju(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Zu=(()=>{class n extends Jn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new vv(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new BI}next(t){Xu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Xu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Xu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?fv:(this.currentObservers=null,s.push(t),new ir(()=>{this.currentObservers=null,Gl(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Jn;return t.source=this,t}}return n.create=(e,t)=>new vv(e,t),n})();class vv extends Zu{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:fv}}class HI extends Zu{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Zs(n){return e=>{if(function UI(n){return zt(n?.lift)}(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ks(n,e,t,i,r){return new VI(n,e,t,i,r)}class VI extends wp{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function os(n){return this instanceof os?(this.v=n,this):new os(n)}function Mv(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Ap(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const Sv=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ev(n){return zt(n?.then)}function Tv(n){return zt(n[Sp])}function Dv(n){return Symbol.asyncIterator&&zt(n?.[Symbol.asyncIterator])}function Cv(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Av=function aR(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Iv(n){return zt(n?.[Av])}function Rv(n){return function bv(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(f){i[f]&&(r[f]=function(h){return new Promise(function(p,g){s.push([f,h,p,g])>1||a(f,h)})})}function a(f,h){try{!function l(f){f.value instanceof os?Promise.resolve(f.value.v).then(c,u):d(s[0][2],f)}(i[f](h))}catch(p){d(s[0][3],p)}}function c(f){a("next",f)}function u(f){a("throw",f)}function d(f,h){f(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield os(t.read());if(r)return yield os(void 0);yield yield os(i)}}finally{t.releaseLock()}})}function Pv(n){return zt(n?.getReader)}function Ir(n){if(n instanceof Jn)return n;if(null!=n){if(Tv(n))return function lR(n){return new Jn(e=>{const t=n[Sp]();if(zt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Sv(n))return function cR(n){return new Jn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Ev(n))return function uR(n){return new Jn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,mv)})}(n);if(Dv(n))return Lv(n);if(Iv(n))return function dR(n){return new Jn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Pv(n))return function fR(n){return Lv(Rv(n))}(n)}throw Cv(n)}function Lv(n){return new Jn(e=>{(function hR(n,e){var t,i,r,s;return function xv(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Mv(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function as(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Nv(n,e,t=1/0){return zt(e)?Nv((i,r)=>function zI(n,e){return Zs((t,i)=>{let r=0;t.subscribe(Ks(i,s=>{i.next(n.call(e,s,r++))}))})}((s,o)=>e(i,s,r,o))(Ir(n(i,r))),t):("number"==typeof e&&(t=e),Zs((i,r)=>function pR(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const f=()=>{d&&!l.length&&!c&&e.complete()},h=g=>c<i?p(g):l.push(g),p=g=>{s&&e.next(g),c++;let _=!1;Ir(t(g,u++)).subscribe(Ks(e,y=>{r?.(y),s?h(y):e.next(y)},()=>{_=!0},void 0,()=>{if(_)try{for(c--;l.length&&c<i;){const y=l.shift();o?as(e,o,()=>p(y)):p(y)}f()}catch(y){e.error(y)}}))};return n.subscribe(Ks(e,h,()=>{d=!0,f()})),()=>{a?.()}}(i,r,n,t)))}const Fv=new Jn(n=>n.complete());function Ip(n){return n[n.length-1]}function Ov(n){return function yR(n){return n&&zt(n.schedule)}(Ip(n))?n.pop():void 0}function kv(n,e=0){return Zs((t,i)=>{t.subscribe(Ks(i,r=>as(i,n,()=>i.next(r),e),()=>as(i,n,()=>i.complete(),e),r=>as(i,n,()=>i.error(r),e)))})}function Bv(n,e=0){return Zs((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function Hv(n,e){if(!n)throw new Error("Iterable cannot be null");return new Jn(t=>{as(t,e,()=>{const i=n[Symbol.asyncIterator]();as(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Uv(n,e){return e?function SR(n,e){if(null!=n){if(Tv(n))return function vR(n,e){return Ir(n).pipe(Bv(e),kv(e))}(n,e);if(Sv(n))return function wR(n,e){return new Jn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Ev(n))return function xR(n,e){return Ir(n).pipe(Bv(e),kv(e))}(n,e);if(Dv(n))return Hv(n,e);if(Iv(n))return function bR(n,e){return new Jn(t=>{let i;return as(t,e,()=>{i=n[Av](),as(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>zt(i?.return)&&i.return()})}(n,e);if(Pv(n))return function MR(n,e){return Hv(Rv(n),e)}(n,e)}throw Cv(n)}(n,e):Ir(n)}function ER(...n){const e=Ov(n),t=function _R(n,e){return"number"==typeof Ip(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Ir(i[0]):function mR(n=1/0){return Nv(Ep,n)}(t)(Uv(i,e)):Fv}function Vv(n={}){const{connector:e=(()=>new Zu),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,u=!1,d=!1;const f=()=>{a?.unsubscribe(),a=void 0},h=()=>{f(),o=l=void 0,u=d=!1},p=()=>{const g=o;h(),g?.unsubscribe()};return Zs((g,_)=>{c++,!d&&!u&&f();const y=l=l??e();_.add(()=>{c--,0===c&&!d&&!u&&(a=Rp(p,r))}),y.subscribe(_),!o&&c>0&&(o=new Wl({next:m=>y.next(m),error:m=>{d=!0,f(),a=Rp(h,t,m),y.error(m)},complete:()=>{u=!0,f(),a=Rp(h,i),y.complete()}}),Ir(g).subscribe(o))})(s)}}function Rp(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Wl({next:()=>{i.unsubscribe(),n()}});return Ir(e(...t)).subscribe(i)}function AR(n,e){return n===e}function mt(n){for(let e in n)if(n[e]===mt)return e;throw Error("Could not find renamed property on target object.")}function dn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(dn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Pp(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const IR=mt({__forward_ref__:mt});function Lp(n){return n.__forward_ref__=Lp,n.toString=function(){return dn(this())},n}function Re(n){return function Np(n){return"function"==typeof n&&n.hasOwnProperty(IR)&&n.__forward_ref__===Lp}(n)?n():n}function Fp(n){return n&&!!n.\u0275providers}class fe extends Error{constructor(e,t){super(function Ju(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Le(n){return"string"==typeof n?n:null==n?"":String(n)}function Qu(n,e){throw new fe(-201,!1)}function Ci(n,e){null==n&&function ht(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function St(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Qo(n){return{providers:n.providers||[],imports:n.imports||[]}}function ed(n){return Gv(n,td)||Gv(n,jv)}function Gv(n,e){return n.hasOwnProperty(e)?n[e]:null}function Wv(n){return n&&(n.hasOwnProperty(Op)||n.hasOwnProperty(kR))?n[Op]:null}const td=mt({\u0275prov:mt}),Op=mt({\u0275inj:mt}),jv=mt({ngInjectableDef:mt}),kR=mt({ngInjectorDef:mt});var Ie=(()=>((Ie=Ie||{})[Ie.Default=0]="Default",Ie[Ie.Host=1]="Host",Ie[Ie.Self=2]="Self",Ie[Ie.SkipSelf=4]="SkipSelf",Ie[Ie.Optional=8]="Optional",Ie))();let kp;function Qn(n){const e=kp;return kp=n,e}function qv(n,e,t){const i=ed(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Ie.Optional?null:void 0!==e?e:void Qu(dn(n))}const Et=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),jl={},Bp="__NG_DI_FLAG__",nd="ngTempTokenPath",HR=/\n/gm,Xv="__source";let ea;function cs(n){const e=ea;return ea=n,e}function zR(n,e=Ie.Default){if(void 0===ea)throw new fe(-203,!1);return null===ea?qv(n,void 0,e):ea.get(n,e&Ie.Optional?null:void 0,e)}function it(n,e=Ie.Default){return(function $v(){return kp}()||zR)(Re(n),e)}function It(n,e=Ie.Default){return it(n,id(e))}function id(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Hp(n){const e=[];for(let t=0;t<n.length;t++){const i=Re(n[t]);if(Array.isArray(i)){if(0===i.length)throw new fe(900,!1);let r,s=Ie.Default;for(let o=0;o<i.length;o++){const a=i[o],l=GR(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(it(r,s))}else e.push(it(i))}return e}function GR(n){return n[Bp]}function Rr(n){return{toString:n}.toString()}var rr=(()=>((rr=rr||{})[rr.OnPush=0]="OnPush",rr[rr.Default=1]="Default",rr))(),hi=(()=>{return(n=hi||(hi={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",hi;var n})();const sr={},at=[],rd=mt({\u0275cmp:mt}),Up=mt({\u0275dir:mt}),Vp=mt({\u0275pipe:mt}),Zv=mt({\u0275mod:mt}),Pr=mt({\u0275fac:mt}),ql=mt({__NG_ELEMENT_ID__:mt}),Kv=mt({__NG_ENV_ID__:mt});function Jv(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function zp(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];ex(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function Qv(n){return 3===n||4===n||6===n}function ex(n){return 64===n.charCodeAt(0)}function Xl(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||tx(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function tx(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const nx="ng-template";function $R(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==Jv(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function ix(n){return 4===n.type&&n.value!==nx}function qR(n,e,t){return e===(4!==n.type||t?n.value:nx)}function XR(n,e,t){let i=4;const r=n.attrs||[],s=function KR(n){for(let e=0;e<n.length;e++)if(Qv(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!qR(n,l,t)||""===l&&1===e.length){if(zi(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!$R(n.attrs,c,t)){if(zi(i))return!1;o=!0}continue}const d=YR(8&i?"class":l,r,ix(n),t);if(-1===d){if(zi(i))return!1;o=!0;continue}if(""!==c){let f;f=d>s?"":r[d+1].toLowerCase();const h=8&i?f:null;if(h&&-1!==Jv(h,c,0)||2&i&&c!==f){if(zi(i))return!1;o=!0}}}}else{if(!o&&!zi(i)&&!zi(l))return!1;if(o&&zi(l))continue;o=!1,i=l|1&i}}return zi(i)||o}function zi(n){return 0==(1&n)}function YR(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function JR(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function rx(n,e,t=!1){for(let i=0;i<e.length;i++)if(XR(n,e[i],t))return!0;return!1}function sx(n,e){return n?":not("+e.trim()+")":e}function eP(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!zi(o)&&(e+=sx(s,r),r=""),i=o,s=s||!zi(i);t++}return""!==r&&(e+=sx(s,r)),e}function ta(n){return Rr(()=>{const e=ax(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===rr.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||hi.Emulated,styles:n.styles||at,_:null,schemas:n.schemas||null,tView:null,id:""};lx(t);const i=n.dependencies;return t.directiveDefs=sd(i,!1),t.pipeDefs=sd(i,!0),t.id=function lP(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function rP(n){return ct(n)||In(n)}function sP(n){return null!==n}function Yl(n){return Rr(()=>({type:n.type,bootstrap:n.bootstrap||at,declarations:n.declarations||at,imports:n.imports||at,exports:n.exports||at,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function ox(n,e){if(null==n)return sr;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function Ai(n){return Rr(()=>{const e=ax(n);return lx(e),e})}function ct(n){return n[rd]||null}function In(n){return n[Up]||null}function ti(n){return n[Vp]||null}function ax(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||sr,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||at,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ox(n.inputs,e),outputs:ox(n.outputs)}}function lx(n){n.features?.forEach(e=>e(n))}function sd(n,e){if(!n)return null;const t=e?ti:rP;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(sP)}const fn=0,le=1,Fe=2,Nt=3,Gi=4,Kl=5,Rn=6,na=7,Qt=8,ia=9,Js=10,Oe=11,Jl=12,cx=13,ra=14,en=15,Ql=16,sa=17,or=18,ec=19,ux=20,us=21,Lr=22,od=23,ad=24,Qe=25,Gp=1,dx=2,ar=7,oa=9,Pn=11;function mi(n){return Array.isArray(n)&&"object"==typeof n[Gp]}function ni(n){return Array.isArray(n)&&!0===n[Gp]}function Wp(n){return 0!=(4&n.flags)}function Qs(n){return n.componentOffset>-1}function cd(n){return 1==(1&n.flags)}function Wi(n){return!!n.template}function jp(n){return 0!=(512&n[Fe])}function eo(n,e){return n.hasOwnProperty(Pr)?n[Pr]:null}let pP=Et.WeakRef??class hP{constructor(e){this.ref=e}deref(){return this.ref}},gP=0,lr=null,ud=!1;function vn(n){const e=lr;return lr=n,e}class gx{constructor(){this.id=gP++,this.ref=function mP(n){return new pP(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const i=t.producerNode.deref();if(void 0!==i&&t.atTrackingVersion===this.trackingVersion){if(i.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),i?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=ud;ud=!0;try{for(const[t,i]of this.consumers){const r=i.consumerNode.deref();void 0!==r&&r.trackingVersion===i.atTrackingVersion?r.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),r?.producers.delete(this.id))}}finally{ud=e}}producerAccessed(){if(ud)throw new Error("");if(null===lr)return;let e=lr.producers.get(this.id);void 0===e?(e={consumerNode:lr.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:lr.trackingVersion},lr.producers.set(this.id,e),this.consumers.set(lr.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=lr.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==lr?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let yx=null;const vx=()=>{};class xP extends gx{constructor(e,t,i){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=vx,this.registerOnCleanup=r=>{this.cleanupFn=r},this.consumerAllowSignalWrites=i}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=vn(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=vx,this.watch(this.registerOnCleanup)}finally{vn(e)}}cleanup(){this.cleanupFn()}}class wP{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function xx(n){return n.type.prototype.ngOnChanges&&(n.setInput=MP),bP}function bP(){const n=bx(this),e=n?.current;if(e){const t=n.previous;if(t===sr)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function MP(n,e,t,i){const r=this.declaredInputs[t],s=bx(n)||function SP(n,e){return n[wx]=e}(n,{previous:sr,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new wP(l&&l.currentValue,e,a===sr),n[i]=e}const wx="__ngSimpleChanges__";function bx(n){return n[wx]||null}const cr=function(n,e,t){};function At(n){for(;Array.isArray(n);)n=n[fn];return n}function ii(n,e){return At(e[n.index])}function Ex(n,e){return n.data[e]}function gi(n,e){const t=e[n];return mi(t)?t:t[fn]}function ds(n,e){return null==e?null:n[e]}function Tx(n){n[sa]=0}function RP(n){1024&n[Fe]||(n[Fe]|=1024,Cx(n,1))}function Dx(n){1024&n[Fe]&&(n[Fe]&=-1025,Cx(n,-1))}function Cx(n,e){let t=n[Nt];if(null===t)return;t[Kl]+=e;let i=t;for(t=t[Nt];null!==t&&(1===e&&1===i[Kl]||-1===e&&0===i[Kl]);)t[Kl]+=e,i=t,t=t[Nt]}const Ae={lFrame:Hx(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Rx(){return Ae.bindingsEnabled}function q(){return Ae.lFrame.lView}function rt(){return Ae.lFrame.tView}function Sn(){let n=Px();for(;null!==n&&64===n.type;)n=n.parent;return n}function Px(){return Ae.lFrame.currentTNode}function ur(n,e){const t=Ae.lFrame;t.currentTNode=n,t.isParent=e}function Kp(){return Ae.lFrame.isParent}function ca(){return Ae.lFrame.bindingIndex++}function jP(n,e){const t=Ae.lFrame;t.bindingIndex=t.bindingRootIndex=n,Qp(e)}function Qp(n){Ae.lFrame.currentDirectiveIndex=n}function tm(n){Ae.lFrame.currentQueryIndex=n}function qP(n){const e=n[le];return 2===e.type?e.declTNode:1===e.type?n[Rn]:null}function kx(n,e,t){if(t&Ie.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Ie.Host||(r=qP(s),null===r||(s=s[ra],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ae.lFrame=Bx();return i.currentTNode=e,i.lView=n,!0}function nm(n){const e=Bx(),t=n[le];Ae.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Bx(){const n=Ae.lFrame,e=null===n?null:n.child;return null===e?Hx(n):e}function Hx(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Ux(){const n=Ae.lFrame;return Ae.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Vx=Ux;function im(){const n=Ux();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Gn(){return Ae.lFrame.selectedIndex}function to(n){Ae.lFrame.selectedIndex=n}let Gx=!0;function md(){return Gx}function fs(n){Gx=n}function gd(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function yd(n,e,t){Wx(n,e,3,t)}function _d(n,e,t,i){(3&n[Fe])===t&&Wx(n,e,t,i)}function rm(n,e){let t=n[Fe];(3&t)===e&&(t&=8191,t+=1,n[Fe]=t)}function Wx(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[sa]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[sa]+=65536),(a<s||-1==s)&&(tL(n,t,e,l),n[sa]=(4294901760&n[sa])+l+2),l++}function jx(n,e){cr(4,n,e);const t=vn(null);try{e.call(n)}finally{vn(t),cr(5,n,e)}}function tL(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Fe]>>13<n[sa]>>16&&(3&n[Fe])===e&&(n[Fe]+=8192,jx(a,s)):jx(a,s)}const ua=-1;class ic{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function $x(n){return n!==ua}function vd(n){return 32767&n}function xd(n,e){let t=function sL(n){return n>>16}(n),i=e;for(;t>0;)i=i[ra],t--;return i}let om=!0;function wd(n){const e=om;return om=n,e}const qx=255,Xx=5;let oL=0;const dr={};function bd(n,e){const t=Yx(n,e);if(-1!==t)return t;const i=e[le];i.firstCreatePass&&(n.injectorIndex=e.length,am(i.data,n),am(e,null),am(i.blueprint,null));const r=lm(n,e),s=n.injectorIndex;if($x(r)){const o=vd(r),a=xd(r,e),l=a[le].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function am(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Yx(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function lm(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=nw(r),null===i)return ua;if(t++,r=r[ra],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return ua}function cm(n,e,t){!function aL(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(ql)&&(i=t[ql]),null==i&&(i=t[ql]=oL++);const r=i&qx;e.data[n+(r>>Xx)]|=1<<r}(n,e,t)}function Zx(n,e,t){if(t&Ie.Optional||void 0!==n)return n;Qu()}function Kx(n,e,t,i){if(t&Ie.Optional&&void 0===i&&(i=null),!(t&(Ie.Self|Ie.Host))){const r=n[ia],s=Qn(void 0);try{return r?r.get(e,i,t&Ie.Optional):qv(e,i,t&Ie.Optional)}finally{Qn(s)}}return Zx(i,0,t)}function Jx(n,e,t,i=Ie.Default,r){if(null!==n){if(2048&e[Fe]&&!(i&Ie.Self)){const o=function hL(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Fe]&&!(512&o[Fe]);){const a=Qx(s,o,t,i|Ie.Self,dr);if(a!==dr)return a;let l=s.parent;if(!l){const c=o[ux];if(c){const u=c.get(t,dr,i);if(u!==dr)return u}l=nw(o),o=o[ra]}s=l}return r}(n,e,t,i,dr);if(o!==dr)return o}const s=Qx(n,e,t,i,dr);if(s!==dr)return s}return Kx(e,t,i,r)}function Qx(n,e,t,i,r){const s=function uL(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ql)?n[ql]:void 0;return"number"==typeof e?e>=0?e&qx:dL:e}(t);if("function"==typeof s){if(!kx(e,n,i))return i&Ie.Host?Zx(r,0,i):Kx(e,t,i,r);try{const o=s(i);if(null!=o||i&Ie.Optional)return o;Qu()}finally{Vx()}}else if("number"==typeof s){let o=null,a=Yx(n,e),l=ua,c=i&Ie.Host?e[en][Rn]:null;for((-1===a||i&Ie.SkipSelf)&&(l=-1===a?lm(n,e):e[a+8],l!==ua&&tw(i,!1)?(o=e[le],a=vd(l),e=xd(l,e)):a=-1);-1!==a;){const u=e[le];if(ew(s,a,u.data)){const d=cL(a,e,t,o,i,c);if(d!==dr)return d}l=e[a+8],l!==ua&&tw(i,e[le].data[a+8]===c)&&ew(s,a,e)?(o=u,a=vd(l),e=xd(l,e)):a=-1}}return r}function cL(n,e,t,i,r,s){const o=e[le],a=o.data[n+8],u=function Md(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,f=r?a+u:n.directiveEnd;for(let h=i?a:a+u;h<f;h++){const p=o[h];if(h<l&&t===p||h>=l&&p.type===t)return h}if(r){const h=o[l];if(h&&Wi(h)&&h.type===t)return l}return null}(a,o,t,null==i?Qs(a)&&om:i!=o&&0!=(3&a.type),r&Ie.Host&&s===a);return null!==u?no(e,o,u,a):dr}function no(n,e,t,i){let r=n[t];const s=e.data;if(function nL(n){return n instanceof ic}(r)){const o=r;o.resolving&&function RR(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new fe(-200,`Circular dependency in DI detected for ${n}${t}`)}(function ft(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Le(n)}(s[t]));const a=wd(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Qn(o.injectImpl):null;kx(n,i,Ie.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function eL(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=xx(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&Qn(l),wd(a),o.resolving=!1,Vx()}}return r}function ew(n,e,t){return!!(t[e+(n>>Xx)]&1<<n)}function tw(n,e){return!(n&Ie.Self||n&Ie.Host&&e)}class da{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return Jx(this._tNode,this._lView,e,id(i),t)}}function dL(){return new da(Sn(),q())}function nw(n){const e=n[le],t=e.type;return 2===t?e.declTNode:1===t?n[Rn]:null}function oc(n,e){n.forEach(t=>Array.isArray(t)?oc(t,e):e(t))}function rw(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Sd(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Ad(n){return 128==(128&n.flags)}var ri=(()=>((ri=ri||{})[ri.Important=1]="Important",ri[ri.DashCase=2]="DashCase",ri))();const wm=new Map;let zL=0;const Mm="__ngContext__";function Ln(n,e){mi(e)?(n[Mm]=e[ec],function WL(n){wm.set(n[ec],n)}(e)):n[Mm]=e}let Sm;function Em(n,e){return Sm(n,e)}function uc(n){const e=n[Nt];return ni(e)?e[Nt]:e}function Ew(n){return Dw(n[Jl])}function Tw(n){return Dw(n[Gi])}function Dw(n){for(;null!==n&&!ni(n);)n=n[Gi];return n}function va(n,e,t,i,r){if(null!=i){let s,o=!1;ni(i)?s=i:mi(i)&&(o=!0,i=i[fn]);const a=At(i);0===n&&null!==t?null==r?Pw(e,t,a):io(e,t,a,r||null,!0):1===n&&null!==t?io(e,t,a,r||null,!0):2===n?function Fd(n,e,t){const i=Ld(n,e);i&&function cN(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function fN(n,e,t,i,r){const s=t[ar];s!==At(t)&&va(e,n,i,s,r);for(let a=Pn;a<t.length;a++){const l=t[a];fc(l[le],l,n,e,i,s)}}(e,n,s,t,r)}}function Pd(n,e,t){return n.createElement(e,t)}function Aw(n,e){const t=n[oa],i=t.indexOf(e);Dx(e),t.splice(i,1)}function Dm(n,e){if(n.length<=Pn)return;const t=Pn+e,i=n[t];if(i){const r=i[Ql];null!==r&&r!==n&&Aw(r,i),e>0&&(n[t-1][Gi]=i[Gi]);const s=Sd(n,Pn+e);!function tN(n,e){fc(n,e,e[Oe],2,null,null),e[fn]=null,e[Rn]=null}(i[le],i);const o=s[or];null!==o&&o.detachView(s[le]),i[Nt]=null,i[Gi]=null,i[Fe]&=-129}return i}function Iw(n,e){if(!(256&e[Fe])){const t=e[Oe];e[od]?.destroy(),e[ad]?.destroy(),t.destroyNode&&fc(n,e,t,3,null,null),function rN(n){let e=n[Jl];if(!e)return Cm(n[le],n);for(;e;){let t=null;if(mi(e))t=e[Jl];else{const i=e[Pn];i&&(t=i)}if(!t){for(;e&&!e[Gi]&&e!==n;)mi(e)&&Cm(e[le],e),e=e[Nt];null===e&&(e=n),mi(e)&&Cm(e[le],e),t=e&&e[Gi]}e=t}}(e)}}function Cm(n,e){if(!(256&e[Fe])){e[Fe]&=-129,e[Fe]|=256,function lN(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof ic)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];cr(4,a,l);try{l.call(a)}finally{cr(5,a,l)}}else{cr(4,r,s);try{s.call(r)}finally{cr(5,r,s)}}}}}(n,e),function aN(n,e){const t=n.cleanup,i=e[na];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[na]=null);const r=e[us];if(null!==r){e[us]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[le].type&&e[Oe].destroy();const t=e[Ql];if(null!==t&&ni(e[Nt])){t!==e[Nt]&&Aw(t,e);const i=e[or];null!==i&&i.detachView(n)}!function jL(n){wm.delete(n[ec])}(e)}}function Am(n,e,t){return function Rw(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[fn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===hi.None||s===hi.Emulated)return null}return ii(i,t)}}(n,e.parent,t)}function io(n,e,t,i,r){n.insertBefore(e,t,i,r)}function Pw(n,e,t){n.appendChild(e,t)}function Lw(n,e,t,i,r){null!==i?io(n,e,t,i,r):Pw(n,e,t)}function Ld(n,e){return n.parentNode(e)}let Im,Nm,Ow=function Fw(n,e,t){return 40&n.type?ii(n,t):null};function Nd(n,e,t,i){const r=Am(n,i,e),s=e[Oe],a=function Nw(n,e,t){return Ow(n,e,t)}(i.parent||e[Rn],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Lw(s,r,t[l],a,!1);else Lw(s,r,t,a,!1);void 0!==Im&&Im(s,i,e,t,r)}function dc(n,e){if(null!==e){const t=e.type;if(3&t)return ii(e,n);if(4&t)return Rm(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return dc(n,i);{const r=n[e.index];return ni(r)?Rm(-1,r):At(r)}}if(32&t)return Em(e,n)()||At(n[e.index]);{const i=Bw(n,e);return null!==i?Array.isArray(i)?i[0]:dc(uc(n[en]),i):dc(n,e.next)}}return null}function Bw(n,e){return null!==e?n[en][Rn].projection[e.projection]:null}function Rm(n,e){const t=Pn+n+1;if(t<e.length){const i=e[t],r=i[le].firstChild;if(null!==r)return dc(i,r)}return e[ar]}function Pm(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Ln(At(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)Pm(n,e,t.child,i,r,s,!1),va(e,n,r,a,s);else if(32&l){const c=Em(t,i);let u;for(;u=c();)va(e,n,r,u,s);va(e,n,r,a,s)}else 16&l?Uw(n,e,i,t,r,s):va(e,n,r,a,s);t=o?t.projectionNext:t.next}}function fc(n,e,t,i,r,s){Pm(t,i,n.firstChild,e,r,s,!1)}function Uw(n,e,t,i,r,s){const o=t[en],l=o[Rn].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)va(e,n,r,l[c],s);else{let c=l;const u=o[Nt];Ad(i)&&(c.flags|=128),Pm(n,e,c,u,r,s,!0)}}function Vw(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function zw(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&zp(n,e,i),null!==r&&Vw(n,e,r),null!==s&&function pN(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class ke{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=St({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Hd=new ke("ENVIRONMENT_INITIALIZER"),tb=new ke("INJECTOR",-1),nb=new ke("INJECTOR_DEF_TYPES");class ib{get(e,t=jl){if(t===jl){const i=new Error(`NullInjectorError: No provider for ${dn(e)}!`);throw i.name="NullInjectorError",i}return t}}function zN(...n){return{\u0275providers:sb(0,n),\u0275fromNgModule:!0}}function sb(n,...e){const t=[],i=new Set;let r;return oc(e,s=>{const o=s;Um(o,t,[],i)&&(r||=[],r.push(o))}),void 0!==r&&ob(r,t),t}function ob(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];Vm(r,s=>{e.push(s)})}}function Um(n,e,t,i){if(!(n=Re(n)))return!1;let r=null,s=Wv(n);const o=!s&&ct(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=Wv(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Um(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{oc(s.imports,u=>{Um(u,e,t,i)&&(c||=[],c.push(u))})}finally{}void 0!==c&&ob(c,e)}if(!a){const c=eo(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:at},{provide:nb,useValue:r,multi:!0},{provide:Hd,useValue:()=>it(r),multi:!0})}const l=s.providers;null==l||a||Vm(l,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}function Vm(n,e){for(let t of n)Fp(t)&&(t=t.\u0275providers),Array.isArray(t)?Vm(t,e):e(t)}const GN=mt({provide:String,useValue:mt});function zm(n){return null!==n&&"object"==typeof n&&GN in n}function ro(n){return"function"==typeof n}const Gm=new ke("Set Injector scope."),Ud={},jN={};let Wm;function Vd(){return void 0===Wm&&(Wm=new ib),Wm}class wa{}class jm extends wa{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,qm(e,o=>this.processProvider(o)),this.records.set(tb,ba(void 0,this)),r.has("environment")&&this.records.set(wa,ba(void 0,this));const s=this.records.get(Gm);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(nb.multi,at,Ie.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=cs(this),i=Qn(void 0);try{return e()}finally{cs(t),Qn(i)}}get(e,t=jl,i=Ie.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Kv))return e[Kv](this);i=id(i);const r=cs(this),s=Qn(void 0);try{if(!(i&Ie.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function ZN(n){return"function"==typeof n||"object"==typeof n&&n instanceof ke}(e)&&ed(e);a=l&&this.injectableDefInScope(l)?ba($m(e),Ud):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&Ie.Self?Vd():this.parent).get(e,t=i&Ie.Optional&&t===jl?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[nd]=o[nd]||[]).unshift(dn(e)),r)throw o;return function WR(n,e,t,i){const r=n[nd];throw e[Xv]&&r.unshift(e[Xv]),n.message=function jR(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=dn(e);if(Array.isArray(e))r=e.map(dn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):dn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(HR,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[nd]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{Qn(s),cs(r)}}resolveInjectorInitializers(){const e=cs(this),t=Qn(void 0);try{const i=this.get(Hd.multi,at,Ie.Self);for(const r of i)r()}finally{cs(e),Qn(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(dn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new fe(205,!1)}processProvider(e){let t=ro(e=Re(e))?e:Re(e&&e.provide);const i=function qN(n){return zm(n)?ba(void 0,n.useValue):ba(function cb(n,e,t){let i;if(ro(n)){const r=Re(n);return eo(r)||$m(r)}if(zm(n))i=()=>Re(n.useValue);else if(function lb(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Hp(n.deps||[]));else if(function ab(n){return!(!n||!n.useExisting)}(n))i=()=>it(Re(n.useExisting));else{const r=Re(n&&(n.useClass||n.provide));if(!function XN(n){return!!n.deps}(n))return eo(r)||$m(r);i=()=>new r(...Hp(n.deps))}return i}(n),Ud)}(e);if(ro(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=ba(void 0,Ud,!0),r.factory=()=>Hp(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Ud&&(t.value=jN,t.value=t.factory()),"object"==typeof t.value&&t.value&&function YN(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Re(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function $m(n){const e=ed(n),t=null!==e?e.factory:eo(n);if(null!==t)return t;if(n instanceof ke)throw new fe(204,!1);if(n instanceof Function)return function $N(n){const e=n.length;if(e>0)throw function ac(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new fe(204,!1);const t=function OR(n){return n&&(n[td]||n[jv])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new fe(204,!1)}function ba(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function qm(n,e){for(const t of n)Array.isArray(t)?qm(t,e):t&&Fp(t)?qm(t.\u0275providers,e):e(t)}const zd=new ke("AppId",{providedIn:"root",factory:()=>KN}),KN="ng",ub=new ke("Platform Initializer"),Ma=new ke("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),db=new ke("CSP nonce",{providedIn:"root",factory:()=>function hc(){if(void 0!==Nm)return Nm;if(typeof document<"u")return document;throw new fe(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let hb=(n,e)=>null;function pb(n,e){return hb(n,e)}class o2{}class yb{}class l2{resolveComponentFactory(e){throw function a2(n){const e=Error(`No component factory found for ${dn(n)}.`);return e.ngComponent=n,e}(e)}}let qd=(()=>{class n{}return n.NULL=new l2,n})();function c2(){return Sa(Sn(),q())}function Sa(n,e){return new Ea(ii(n,e))}let Ea=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=c2,n})();class vb{}let f2=(()=>{class n{}return n.\u0275prov=St({token:n,providedIn:"root",factory:()=>null}),n})();class rg{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const h2=new rg("16.1.1"),sg={};function xc(n){for(;n;){n[Fe]|=64;const e=uc(n);if(jp(n)&&!e)return n;n=e}return null}function og(n){return n.ngOriginalError}class so{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&og(e);for(;t&&og(t);)t=og(t);return t||null}}const Mb=new ke("",{providedIn:"root",factory:()=>!1});class Cb extends gx{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){xc(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,i){const r=vn(this);this.trackingVersion++;try{e(t,i)}finally{vn(r)}}destroy(){this.trackingVersion++}}let Yd=null;function Ab(){return Yd??=new Cb,Yd}function Ib(n,e){return n[e]??Ab()}function Rb(n,e){const t=Ab();t.hasReadASignal&&(n[e]=Yd,t.lView=n,Yd=new Cb)}const Be={};function Zd(n){Pb(rt(),q(),Gn()+n,!1)}function Pb(n,e,t,i){if(!i)if(3==(3&e[Fe])){const s=n.preOrderCheckHooks;null!==s&&yd(e,s,t)}else{const s=n.preOrderHooks;null!==s&&_d(e,s,0,t)}to(t)}function Ob(n,e=null,t=null,i){const r=kb(n,e,t,i);return r.resolveInjectorInitializers(),r}function kb(n,e=null,t=null,i,r=new Set){const s=[t||at,zN(n)];return i=i||("object"==typeof n?void 0:dn(n)),new jm(s,e||Vd(),i||null,r)}let oo=(()=>{class n{static create(t,i){if(Array.isArray(t))return Ob({name:""},i,t,"");{const r=t.name??"";return Ob({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=jl,n.NULL=new ib,n.\u0275prov=St({token:n,providedIn:"any",factory:()=>it(tb)}),n.__NG_ELEMENT_ID__=-1,n})();function qe(n,e=Ie.Default){const t=q();return null===t?it(n,e):Jx(Sn(),t,Re(n),e)}function Kd(n,e,t,i,r,s,o,a,l,c,u){const d=e.blueprint.slice();return d[fn]=r,d[Fe]=140|i,(null!==c||n&&2048&n[Fe])&&(d[Fe]|=2048),Tx(d),d[Nt]=d[ra]=n,d[Qt]=t,d[Js]=o||n&&n[Js],d[Oe]=a||n&&n[Oe],d[ia]=l||n&&n[ia]||null,d[Rn]=s,d[ec]=function GL(){return zL++}(),d[Lr]=u,d[ux]=c,d[en]=2==e.type?n[en]:d,d}function Da(n,e,t,i,r){let s=n.data[e];if(null===s)s=function ag(n,e,t,i,r){const s=Px(),o=Kp(),l=n.data[e]=function F2(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return function la(){return null!==Ae.skipHydrationRootTNode}()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function WP(){return Ae.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function nc(){const n=Ae.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return ur(s,!0),s}function wc(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Bb(n,e,t,i,r){const s=Ib(e,od),o=Gn(),a=2&i;try{if(to(-1),a&&e.length>Qe&&Pb(n,e,Qe,!1),cr(a?2:0,r),a)s.runInContext(t,i,r);else{const c=vn(null);try{t(i,r)}finally{vn(c)}}}finally{a&&null===e[od]&&Rb(e,od),to(o),cr(a?3:1,r)}}function lg(n,e,t){if(Wp(e)){const i=vn(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{vn(i)}}}function cg(n,e,t){Rx()&&(function z2(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Qs(t)&&function Y2(n,e,t){const i=ii(e,n),r=Hb(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=Jd(n,Kd(n,r,null,o,i,e,null,n[Js].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||bd(t,e),Ln(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=no(e,n,a,t);Ln(c,e),null!==o&&Z2(0,a-r,c,l,0,o),Wi(l)&&(gi(t.index,e)[Qt]=no(e,n,a,t))}}(n,e,t,ii(t,e)),64==(64&t.flags)&&Wb(n,e,t))}function ug(n,e,t=ii){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Hb(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=dg(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function dg(n,e,t,i,r,s,o,a,l,c,u){const d=Qe+i,f=d+r,h=function A2(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Be);return t}(d,f),p="function"==typeof c?c():c;return h[le]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}let Ub=n=>null;function Vb(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?zb(t,e,r,s):i.hasOwnProperty(r)&&zb(t,e,i[r],s)}return t}function zb(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function fg(n,e,t,i){if(Rx()){const r=null===i?null:{"":-1},s=function W2(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(rx(e,o.selectors,!1))if(i||(i=[]),Wi(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),hg(n,e,a.length)}else i.unshift(o),hg(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&Gb(n,e,t,o,r,a),r&&function j2(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new fe(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Xl(t.mergedAttrs,t.attrs)}function Gb(n,e,t,i,r,s){for(let c=0;c<i.length;c++)cm(bd(t,e),n,i[c].type);!function q2(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=wc(n,e,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];t.mergedAttrs=Xl(t.mergedAttrs,u.hostAttrs),X2(n,t,e,l,u),$2(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function O2(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],f=t?t.get(d):null,p=f?f.outputs:null;l=Vb(d.inputs,u,l,f?f.inputs:null),c=Vb(d.outputs,u,c,p);const g=null===l||null===o||ix(e)?null:K2(l,u,o);a.push(g)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function Wb(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function $P(){return Ae.lFrame.currentDirectiveIndex}();try{to(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];Qp(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&G2(l,c)}}finally{to(-1),Qp(o)}}function G2(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function hg(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function $2(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Wi(e)&&(t[""]=n)}}function X2(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=eo(r.type)),o=new ic(s,Wi(r),qe);n.blueprint[i]=o,t[i]=o,function U2(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function V2(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,wc(n,t,r.hostVars,Be),r)}function Z2(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)jb(i,t,o[a++],o[a++],o[a++])}function jb(n,e,t,i,r){const s=vn(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{vn(s)}}function K2(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function $b(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function qb(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];tm(t[i]),o.contentQueries(2,e[s],s)}}}function Jd(n,e){return n[Jl]?n[cx][Gi]=e:n[Jl]=e,n[cx]=e,e}function mg(n,e,t){tm(0);const i=vn(null);try{e(n,t)}finally{vn(i)}}function Kb(n,e){const t=n[ia],i=t?t.get(so,null):null;i&&i.handleError(e)}function gg(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];jb(n.data[o],e[o],i,a,r)}}function Br(n,e,t){const i=function pd(n,e){return At(e[n])}(e,n);!function Cw(n,e,t){n.setValue(e,t)}(n[Oe],i,t)}function J2(n,e){const t=gi(e,n),i=t[le];!function Q2(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[fn];null!==r&&null===t[Lr]&&(t[Lr]=pb(r,t[ia])),yg(i,t,t[Qt])}function yg(n,e,t){nm(e);try{const i=n.viewQuery;null!==i&&mg(1,i,t);const r=n.template;null!==r&&Bb(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&qb(n,e),n.staticViewQueries&&mg(2,n.viewQuery,t);const s=n.components;null!==s&&function eF(n,e){for(let t=0;t<e.length;t++)J2(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Fe]&=-5,im()}}let Jb=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=new xP(t,c=>{this.all.has(c)&&this.queue.set(c,s)},r);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=St({token:n,providedIn:"root",factory:()=>new n}),n})();function Qd(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Pp(r,a):2==s&&(i=Pp(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function bc(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(At(s)),ni(s)){for(let a=Pn;a<s.length;a++){const l=s[a],c=l[le].firstChild;null!==c&&bc(l[le],l,c,i)}s[ar]!==s[fn]&&i.push(s[ar])}const o=t.type;if(8&o)bc(n,e,t.child,i);else if(32&o){const a=Em(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Bw(e,t);if(Array.isArray(a))i.push(...a);else{const l=uc(e[en]);bc(l[le],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function ef(n,e,t,i=!0){const r=e[Js].rendererFactory;r.begin&&r.begin();try{Qb(n,e,n.template,t)}catch(o){throw i&&Kb(e,o),o}finally{r.end&&r.end(),e[Js].effectManager?.flush()}}function Qb(n,e,t,i){const r=e[Fe];if(256!=(256&r)){e[Js].effectManager?.flush(),nm(e);try{Tx(e),function Nx(n){return Ae.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Bb(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&yd(e,c,null)}else{const c=n.preOrderHooks;null!==c&&_d(e,c,0,null),rm(e,0)}if(function sF(n){for(let e=Ew(n);null!==e;e=Tw(e)){if(!e[dx])continue;const t=e[oa];for(let i=0;i<t.length;i++){RP(t[i])}}}(e),eM(e,2),null!==n.contentQueries&&qb(n,e),o){const c=n.contentCheckHooks;null!==c&&yd(e,c)}else{const c=n.contentHooks;null!==c&&_d(e,c,1),rm(e,1)}!function C2(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=Ib(e,ad);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)to(~s);else{const o=s,a=t[++r],l=t[++r];jP(a,o),i.runInContext(l,2,e[o])}}}finally{null===e[ad]&&Rb(e,ad),to(-1)}}(n,e);const a=n.components;null!==a&&nM(e,a,0);const l=n.viewQuery;if(null!==l&&mg(2,l,i),o){const c=n.viewCheckHooks;null!==c&&yd(e,c)}else{const c=n.viewHooks;null!==c&&_d(e,c,2),rm(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Fe]&=-73,Dx(e)}finally{im()}}}function eM(n,e){for(let t=Ew(n);null!==t;t=Tw(t))for(let i=Pn;i<t.length;i++)tM(t[i],e)}function oF(n,e,t){tM(gi(e,n),t)}function tM(n,e){if(!function AP(n){return 128==(128&n[Fe])}(n))return;const t=n[le];if(80&n[Fe]&&0===e||1024&n[Fe]||2===e)Qb(t,n,t.template,n[Qt]);else if(n[Kl]>0){eM(n,1);const r=n[le].components;null!==r&&nM(n,r,1)}}function nM(n,e,t){for(let i=0;i<e.length;i++)oF(n,e[i],t)}class Mc{get rootNodes(){const e=this._lView,t=e[le];return bc(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Qt]}set context(e){this._lView[Qt]=e}get destroyed(){return 256==(256&this._lView[Fe])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Nt];if(ni(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Dm(e,i),Sd(t,i))}this._attachedToViewContainer=!1}Iw(this._lView[le],this._lView)}onDestroy(e){!function Ax(n,e){if(256==(256&n[Fe]))throw new fe(911,!1);null===n[us]&&(n[us]=[]),n[us].push(e)}(this._lView,e)}markForCheck(){xc(this._cdRefInjectingView||this._lView)}detach(){this._lView[Fe]&=-129}reattach(){this._lView[Fe]|=128}detectChanges(){ef(this._lView[le],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new fe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function iN(n,e){fc(n,e,e[Oe],2,null,null)}(this._lView[le],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new fe(902,!1);this._appRef=e}}class aF extends Mc{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;ef(e[le],e,e[Qt],!1)}checkNoChanges(){}get context(){return null}}class iM extends qd{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=ct(e);return new Sc(t,this.ngModule)}}function rM(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class cF{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=id(i);const r=this.injector.get(e,sg,i);return r!==sg||t===sg?r:this.parentInjector.get(e,t,i)}}class Sc extends yb{get inputs(){return rM(this.componentDef.inputs)}get outputs(){return rM(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function tP(n){return n.map(eP).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof wa?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new cF(e,s):e,a=o.get(vb,null);if(null===a)throw new fe(407,!1);const u={rendererFactory:a,sanitizer:o.get(f2,null),effectManager:o.get(Jb,null)},d=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",h=i?function I2(n,e,t,i){const s=i.get(Mb,!1)||t===hi.ShadowDom,o=n.selectRootElement(e,s);return function R2(n){Ub(n)}(o),o}(d,i,this.componentDef.encapsulation,o):Pd(d,f,function lF(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(f)),_=this.componentDef.signals?4608:this.componentDef.onPush?576:528,y=dg(0,null,null,1,0,null,null,null,null,null,null),m=Kd(null,y,null,_,null,null,u,d,o,null,null);let x,v;nm(m);try{const w=this.componentDef;let M,T=null;w.findHostDirectiveDefs?(M=[],T=new Map,w.findHostDirectiveDefs(w,M,T),M.push(w)):M=[w];const C=function dF(n,e){const t=n[le],i=Qe;return n[i]=e,Da(t,i,2,"#host",null)}(m,h),R=function fF(n,e,t,i,r,s,o){const a=r[le];!function hF(n,e,t,i){for(const r of n)e.mergedAttrs=Xl(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Qd(e,e.mergedAttrs,!0),null!==t&&zw(i,t,e))}(i,n,e,o);let l=null;null!==e&&(l=pb(e,r[ia]));const c=s.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const d=Kd(r,Hb(t),null,u,r[n.index],n,s,c,null,null,l);return a.firstCreatePass&&hg(a,n,i.length-1),Jd(r,d),r[n.index]=d}(C,h,w,M,m,u,d);v=Ex(y,Qe),h&&function mF(n,e,t,i){if(i)zp(n,t,["ng-version",h2.full]);else{const{attrs:r,classes:s}=function nP(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!zi(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&zp(n,t,r),s&&s.length>0&&Vw(n,t,s.join(" "))}}(d,w,h,i),void 0!==t&&function gF(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(v,this.ngContentSelectors,t),x=function pF(n,e,t,i,r,s){const o=Sn(),a=r[le],l=ii(o,r);Gb(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Ln(no(r,a,o.directiveStart+u,o),r);Wb(a,r,o),l&&Ln(l,r);const c=no(r,a,o.directiveStart+o.componentOffset,o);if(n[Qt]=r[Qt]=c,null!==s)for(const u of s)u(c,e);return lg(a,o,n),c}(R,w,M,T,m,[yF]),yg(y,m,null)}finally{im()}return new uF(this.componentType,x,Sa(v,m),m,v)}}class uF extends o2{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new aF(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;gg(s[le],s,r,e,t),this.previousInputValues.set(e,t),xc(gi(this._tNode.index,s))}}get injector(){return new da(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function yF(){const n=Sn();gd(q()[le],n)}function Nn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Sg(n,e,t,i,r,s,o,a){const l=q(),c=rt(),u=n+Qe,d=c.firstCreatePass?function qF(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Da(e,n,4,o||null,ds(c,a));fg(e,t,u,ds(c,l)),gd(e,u);const d=u.tView=dg(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];ur(d,!1);const f=MM(c,l,d,n);md()&&Nd(c,l,f,d),Ln(f,l),Jd(l,l[u]=$b(f,l,f,d)),cd(d)&&cg(c,l,d),null!=o&&ug(l,d,a)}let MM=function SM(n,e,t,i){return fs(!0),e[Oe].createComment("")};function lf(n,e,t){const i=q();return Nn(i,ca(),e)&&function _i(n,e,t,i,r,s,o,a){const l=ii(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(gg(n,t,u,i,r),Qs(e)&&function B2(n,e){const t=gi(e,n);16&t[Fe]||(t[Fe]|=64)}(t,e.index)):3&e.type&&(i=function k2(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(rt(),function Ft(){const n=Ae.lFrame;return Ex(n.tView,n.selectedIndex)}(),i,n,e,i[Oe],t,!1),lf}function Eg(n,e,t,i,r){const o=r?"class":"style";gg(n,t,e.inputs[o],o,i)}function En(n,e,t,i){const r=q(),s=rt(),o=Qe+n,a=r[Oe],l=s.firstCreatePass?function JF(n,e,t,i,r,s){const o=e.consts,l=Da(e,n,2,i,ds(o,r));return fg(e,t,l,ds(o,s)),null!==l.attrs&&Qd(l,l.attrs,!1),null!==l.mergedAttrs&&Qd(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=EM(s,r,l,a,e,n);r[o]=c;const u=cd(l);return ur(l,!0),zw(a,c,l),32!=(32&l.flags)&&md()&&Nd(s,r,c,l),0===function LP(){return Ae.lFrame.elementDepthCount}()&&Ln(c,r),function NP(){Ae.lFrame.elementDepthCount++}(),u&&(cg(s,r,l),lg(s,l,r)),null!==i&&ug(r,l),En}function nn(){let n=Sn();Kp()?function Jp(){Ae.lFrame.isParent=!1}():(n=n.parent,ur(n,!1));const e=n;(function OP(n){return Ae.skipHydrationRootTNode===n})(e)&&function UP(){Ae.skipHydrationRootTNode=null}(),function FP(){Ae.lFrame.elementDepthCount--}();const t=rt();return t.firstCreatePass&&(gd(t,n),Wp(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function iL(n){return 0!=(8&n.flags)}(e)&&Eg(t,e,q(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function rL(n){return 0!=(16&n.flags)}(e)&&Eg(t,e,q(),e.stylesWithoutHost,!1),nn}function pn(n,e,t,i){return En(n,e,t,i),nn(),pn}let EM=(n,e,t,i,r,s)=>(fs(!0),Pd(i,r,function zx(){return Ae.lFrame.currentNamespace}()));function Cg(n){return!!n&&"function"==typeof n.then}function CM(n){return!!n&&"function"==typeof n.subscribe}function Ag(n,e,t,i){const r=q(),s=rt(),o=Sn();return function IM(n,e,t,i,r,s,o){const a=cd(i),c=n.firstCreatePass&&function Yb(n){return n.cleanup||(n.cleanup=[])}(n),u=e[Qt],d=function Xb(n){return n[na]||(n[na]=[])}(e);let f=!0;if(3&i.type||o){const g=ii(i,e),_=o?o(g):g,y=d.length,m=o?v=>o(At(v[i.index])):i.index;let x=null;if(!o&&a&&(x=function sO(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[na],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=s,x.__ngLastListenerFn__=s,f=!1;else{s=PM(i,e,u,s,!1);const v=t.listen(_,r,s);d.push(s,v),c&&c.push(r,m,y,y+1)}}else s=PM(i,e,u,s,!1);const h=i.outputs;let p;if(f&&null!==h&&(p=h[r])){const g=p.length;if(g)for(let _=0;_<g;_+=2){const w=e[p[_]][p[_+1]].subscribe(s),M=d.length;d.push(s,w),c&&c.push(r,i.index,M,-(M+1))}}}(s,r,r[Oe],o,n,e,i),Ag}function RM(n,e,t,i){try{return cr(6,e,t),!1!==t(i)}catch(r){return Kb(n,r),!1}finally{cr(7,e,t)}}function PM(n,e,t,i,r){return function s(o){if(o===Function)return i;xc(n.componentOffset>-1?gi(n.index,e):e);let l=RM(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=RM(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&o.preventDefault(),l}}function Wn(n,e=""){const t=q(),i=rt(),r=n+Qe,s=i.firstCreatePass?Da(i,r,1,e,null):i.data[r],o=iS(i,t,s,e,n);t[r]=o,md()&&Nd(i,t,o,s),ur(s,!1)}let iS=(n,e,t,i,r)=>(fs(!0),function Rd(n,e){return n.createText(e)}(e[Oe],i));function Fg(n){return Og("",n,""),Fg}function Og(n,e,t){const i=q(),r=function Aa(n,e,t,i){return Nn(n,ca(),t)?e+Le(t)+i:Be}(i,n,e,t);return r!==Be&&Br(i,Gn(),r),Og}const Ha="en-US";let ES=Ha;class Ua{}class Q3{}class Gg extends Ua{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new iM(this);const r=function pi(n,e){const t=n[Zv]||null;if(!t&&!0===e)throw new Error(`Type ${dn(n)} does not have '\u0275mod' property.`);return t}(e);this._bootstrapComponents=function kr(n){return n instanceof Function?n():n}(r.bootstrap),this._r3Injector=kb(e,t,[{provide:Ua,useValue:this},{provide:qd,useValue:this.componentFactoryResolver},...i],dn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Wg extends Q3{constructor(e){super(),this.moduleType=e}create(e){return new Gg(this.moduleType,e,[])}}function $g(n){return e=>{setTimeout(n,void 0,e)}}const Hr=class Ik extends Zu{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=$g(s),r&&(r=$g(r)),o&&(o=$g(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof ir&&e.add(a),a}};let Ur=(()=>{class n{}return n.__NG_ELEMENT_ID__=Nk,n})();const Pk=Ur,Lk=class extends Pk{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t,null)}createEmbeddedViewImpl(e,t,i){const o=this._declarationTContainer.tView,a=Kd(this._declarationLView,o,e,4096&this._declarationLView[Fe]?4096:16,null,o.declTNode,null,null,null,t||null,i||null);a[Ql]=this._declarationLView[this._declarationTContainer.index];const c=this._declarationLView[or];return null!==c&&(a[or]=c.createEmbeddedView(o)),yg(o,a,e),new Mc(a)}};function Nk(){return function mf(n,e){return 4&n.type?new Lk(e,n,Sa(n,e)):null}(Sn(),q())}let gr=(()=>{class n{}return n.__NG_ELEMENT_ID__=Vk,n})();function Vk(){return function pE(n,e){let t;const i=e[n.index];return ni(i)?t=i:(t=$b(i,e,null,n),e[n.index]=t,Jd(e,t)),mE(t,e,n,i),new fE(t,n,e)}(Sn(),q())}const zk=gr,fE=class extends zk{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Sa(this._hostTNode,this._hostLView)}get injector(){return new da(this._hostTNode,this._hostLView)}get parentInjector(){const e=lm(this._hostTNode,this._hostLView);if($x(e)){const t=xd(e,this._hostLView),i=vd(e);return new da(t[le].data[i+8],t)}return new da(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=hE(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Pn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function sc(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const g=t||{};a=g.index,i=g.injector,r=g.projectableNodes,s=g.environmentInjector||g.ngModuleRef}const l=o?e:new Sc(ct(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const _=(o?c:this.parentInjector).get(wa,null);_&&(s=_)}ct(l.componentType??{});const h=l.create(c,r,null,s);return this.insertImpl(h.hostView,a,false),h}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView,s=r[le];if(function IP(n){return ni(n[Nt])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const c=r[Nt],u=new fE(c,c[Rn],c[Nt]);u.detach(u.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;if(function sN(n,e,t,i){const r=Pn+i,s=t.length;i>0&&(t[r-1][Gi]=e),i<s-Pn?(e[Gi]=t[r],rw(t,Pn+i,e)):(t.push(e),e[Gi]=null),e[Nt]=t;const o=e[Ql];null!==o&&t!==o&&function oN(n,e){const t=n[oa];e[en]!==e[Nt][Nt][en]&&(n[dx]=!0),null===t?n[oa]=[e]:t.push(e)}(o,e);const a=e[or];null!==a&&a.insertView(n),e[Fe]|=128}(s,r,a,o),!i){const l=Rm(o,a),c=r[Oe],u=Ld(c,a[ar]);null!==u&&function nN(n,e,t,i,r,s){i[fn]=r,i[Rn]=e,fc(n,i,t,1,r,s)}(s,a[Rn],c,r,u,l)}return e.attachToViewContainerRef(),rw(Yg(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=hE(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Dm(this._lContainer,t);i&&(Sd(Yg(this._lContainer),t),Iw(i[le],i))}detach(e){const t=this._adjustIndex(e,-1),i=Dm(this._lContainer,t);return i&&null!=Sd(Yg(this._lContainer),t)?new Mc(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function hE(n){return n[8]}function Yg(n){return n[8]||(n[8]=[])}let mE=function gE(n,e,t,i){if(n[ar])return;let r;r=8&t.type?At(i):function Gk(n,e){const t=n[Oe],i=t.createComment(""),r=ii(e,n);return io(t,Ld(t,r),i,function uN(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[ar]=r};const MB=new ke("Application Initializer");let sy=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=It(MB,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(Cg(s))t.push(s);else if(CM(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Vr=new ke("LocaleId",{providedIn:"root",factory:()=>It(Vr,Ie.Optional|Ie.SkipSelf)||function EB(){return typeof $localize<"u"&&$localize.locale||Ha}()});let DB=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new HI(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const RB=(()=>Promise.resolve(0))();function oy(n){typeof Zone>"u"?RB.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}function VE(...n){}class gn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Hr(!1),this.onMicrotaskEmpty=new Hr(!1),this.onStable=new Hr(!1),this.onError=new Hr(!1),typeof Zone>"u")throw new fe(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function PB(){let n=Et.requestAnimationFrame,e=Et.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function FB(n){const e=()=>{!function NB(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Et,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,ly(n),n.isCheckStableRunning=!0,ay(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),ly(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return zE(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),GE(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return zE(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),GE(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,ly(n),ay(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!gn.isInAngularZone())throw new fe(909,!1)}static assertNotInAngularZone(){if(gn.isInAngularZone())throw new fe(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,LB,VE,VE);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const LB={};function ay(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ly(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function zE(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function GE(n){n._nesting--,ay(n)}class OB{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Hr,this.onMicrotaskEmpty=new Hr,this.onStable=new Hr,this.onError=new Hr}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const WE=new ke("",{providedIn:"root",factory:jE});function jE(){const n=It(gn);let e=!0;return ER(new Jn(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Jn(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{gn.assertNotInAngularZone(),oy(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{gn.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(Vv()))}const $E=new ke(""),yf=new ke("");let dy,cy=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,dy||(function kB(n){dy=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{gn.assertNotInAngularZone(),oy(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())oy(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(it(gn),it(uy),it(yf))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),uy=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return dy?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),ms=null;const qE=new ke("AllowMultipleToken"),fy=new ke("PlatformDestroyListeners"),XE=new ke("appBootstrapListener");function KE(n,e,t=[]){const i=`Platform: ${e}`,r=new ke(i);return(s=[])=>{let o=hy();if(!o||o.injector.get(qE,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function UB(n){if(ms&&!ms.get(qE,!1))throw new fe(400,!1);(function YE(){!function _P(n){yx=n}(()=>{throw new fe(600,!1)})})(),ms=n;const e=n.get(QE);(function ZE(n){n.get(ub,null)?.forEach(t=>t())})(n)}(function JE(n=[],e){return oo.create({name:e,providers:[{provide:Gm,useValue:"platform"},{provide:fy,useValue:new Set([()=>ms=null])},...n]})}(a,i))}return function zB(n){const e=hy();if(!e)throw new fe(401,!1);return e}()}}function hy(){return ms?.get(QE)??null}let QE=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function GB(n="zone.js",e){return"noop"===n?new OB:"zone.js"===n?new gn(e):n}(i?.ngZone,function eT(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function tk(n,e,t){return new Gg(n,e,t)}(t.moduleType,this.injector,function sT(n){return[{provide:gn,useFactory:n},{provide:Hd,multi:!0,useFactory:()=>{const e=It(jB,{optional:!0});return()=>e.initialize()}},{provide:rT,useFactory:WB},{provide:WE,useFactory:jE}]}(()=>r)),o=s.injector.get(so,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{_f(this._modules,s),a.unsubscribe()})}),function tT(n,e,t){try{const i=t();return Cg(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(sy);return a.runInitializers(),a.donePromise.then(()=>(function TS(n){Ci(n,"Expected localeId to be defined"),"string"==typeof n&&(ES=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Vr,Ha)||Ha),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=nT({},i);return function BB(n,e,t){const i=new Wg(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Bc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new fe(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new fe(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(fy,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(it(oo))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function nT(n,e){return Array.isArray(e)?e.reduce(nT,n):{...n,...e}}let Bc=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=It(rT),this.zoneIsStable=It(WE),this.componentTypes=[],this.components=[],this.isStable=It(DB).hasPendingTasks.pipe(function DR(n,e){return Zs((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Ks(i,l=>{r?.unsubscribe();let c=0;const u=s++;Ir(n(l,u)).subscribe(r=Ks(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}(t=>t?function TR(...n){return Uv(n,Ov(n))}(!1):this.zoneIsStable),function CR(n,e=Ep){return n=n??AR,Zs((t,i)=>{let r,s=!0;t.subscribe(Ks(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),Vv()),this._injector=It(wa)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof yb;if(!this._injector.get(sy).done)throw!r&&function Zl(n){const e=ct(n)||In(n)||ti(n);return null!==e&&e.standalone}(t),new fe(405,!1);let o;o=r?t:this._injector.get(qd).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function HB(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Ua),c=o.create(oo.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get($E,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),_f(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new fe(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;_f(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(XE,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>_f(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new fe(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function _f(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const rT=new ke("",{providedIn:"root",factory:()=>It(so).handleError.bind(void 0)});function WB(){const n=It(gn),e=It(so);return t=>n.runOutsideAngular(()=>e.handleError(t))}let jB=(()=>{class n{constructor(){this.zone=It(gn),this.applicationRef=It(Bc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const lH=KE(null,"core",[]);let cH=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(it(Bc))},n.\u0275mod=Yl({type:n}),n.\u0275inj=Qo({}),n})(),xy=null;function wy(){return xy}class xH{}const fo=new ke("DocumentToken");let PT=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new uU,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){LT("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){LT("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(qe(gr),qe(Ur))},n.\u0275dir=Ai({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class uU{constructor(){this.$implicit=null,this.ngIf=null}}function LT(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${dn(e)}'.`)}let FU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yl({type:n}),n.\u0275inj=Qo({}),n})();function kT(n){return"server"===n}class cV extends xH{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class By extends cV{static makeCurrent(){!function vH(n){xy||(xy=n)}(new By)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function uV(){return Gc=Gc||document.querySelector("base"),Gc?Gc.getAttribute("href"):null}();return null==t?null:function dV(n){Nf=Nf||document.createElement("a"),Nf.setAttribute("href",n);const e=Nf.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Gc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function sU(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Nf,Gc=null,hV=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const Hy=new ke("EventManagerPlugins");let GT=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new fe(5101,!1);return this._eventNameToPlugin.set(t,i),i}}return n.\u0275fac=function(t){return new(t||n)(it(Hy),it(gn))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();class WT{constructor(e){this._doc=e}}const Uy="ng-app-id";let jT=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=kT(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${Uy}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(Uy),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(Uy,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(it(fo),it(zd),it(db,8),it(Ma))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const Vy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},zy=/%COMP%/g,yV=new ke("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function qT(n,e){return e.map(t=>t.replace(zy,n))}let XT=(()=>{class n{constructor(t,i,r,s,o,a,l,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=kT(a),this.defaultRenderer=new Gy(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===hi.ShadowDom&&(i={...i,encapsulation:hi.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof ZT?r.applyToHost(t):r instanceof Wy&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestory,d=this.platformIsServer;switch(i.encapsulation){case hi.Emulated:s=new ZT(l,c,i,this.appId,u,o,a,d);break;case hi.ShadowDom:return new wV(l,c,t,i,o,a,this.nonce,d);default:s=new Wy(l,c,i,u,o,a,d)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}}return n.\u0275fac=function(t){return new(t||n)(it(GT),it(jT),it(zd),it(yV),it(fo),it(Ma),it(gn),it(db))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();class Gy{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Vy[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(YT(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(YT(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new fe(5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=Vy[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=Vy[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(ri.DashCase|ri.Important)?e.style.setProperty(t,i,r&ri.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&ri.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=wy().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function YT(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class wV extends Gy{constructor(e,t,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=qT(r.id,r.styles);for(const u of c){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Wy extends Gy{constructor(e,t,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=l?qT(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class ZT extends Wy{constructor(e,t,i,r,s,o,a,l){const c=r+"-"+i.id;super(e,t,i,s,o,a,l,c),this.contentAttr=function _V(n){return"_ngcontent-%COMP%".replace(zy,n)}(c),this.hostAttr=function vV(n){return"_nghost-%COMP%".replace(zy,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let bV=(()=>{class n extends WT{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(it(fo))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const KT=["alt","control","meta","shift"],MV={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},SV={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let EV=(()=>{class n extends WT{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>wy().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),KT.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=MV[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),KT.forEach(o=>{o!==r&&(0,SV[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(it(fo))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const QT=[{provide:Ma,useValue:"browser"},{provide:ub,useValue:function TV(){By.makeCurrent()},multi:!0},{provide:fo,useFactory:function CV(){return function _N(n){Nm=n}(document),document},deps:[]}],AV=KE(lH,"browser",QT),IV=new ke(""),eD=[{provide:yf,useClass:class fV{addToWindow(e){Et.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new fe(5103,!1);return s},Et.getAllAngularTestabilities=()=>e.getAllTestabilities(),Et.getAllAngularRootElements=()=>e.getAllRootElements(),Et.frameworkStabilizers||(Et.frameworkStabilizers=[]),Et.frameworkStabilizers.push(i=>{const r=Et.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?wy().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:$E,useClass:cy,deps:[gn,uy,yf]},{provide:cy,useClass:cy,deps:[gn,uy,yf]}],tD=[{provide:Gm,useValue:"root"},{provide:so,useFactory:function DV(){return new so},deps:[]},{provide:Hy,useClass:bV,multi:!0,deps:[fo,gn,Ma]},{provide:Hy,useClass:EV,multi:!0,deps:[fo]},XT,jT,GT,{provide:vb,useExisting:XT},{provide:class UU{},useClass:hV,deps:[]},[]];let RV=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:zd,useValue:t.appId}]}}}return n.\u0275fac=function(t){return new(t||n)(it(IV,12))},n.\u0275mod=Yl({type:n}),n.\u0275inj=Qo({providers:[...tD,...eD],imports:[FU,cH]}),n})();function sD(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}typeof window<"u"&&window;const HV=0,oD=1,UV=2,aD=1,VV=2,Wc=3,ho=0,on=1,po=2,ys=0,Ga=1,cD=2,uD=3,dD=4,zV=5,Wa=100,GV=101,WV=102,fD=103,hD=104,jV=200,$V=201,qV=202,XV=203,pD=204,mD=205,YV=206,ZV=207,KV=208,JV=209,QV=210,ez=0,tz=1,nz=2,qy=3,iz=4,rz=5,sz=6,oz=7,Ff=0,az=1,lz=2,_s=0,cz=1,uz=2,dz=3,fz=4,hz=5,mo=301,go=302,Of=303,kf=304,jc=306,Bf=307,yo=1e3,qn=1001,$c=1002,an=1003,Hf=1004,Uf=1005,Rt=1006,Yy=1007,vs=1008,_o=1009,pz=1010,mz=1011,qc=1012,gz=1013,Vf=1014,xs=1015,ja=1016,yz=1017,_z=1018,$a=1020,vz=1021,xz=1022,Xn=1023,wz=1024,bz=1025,vo=1026,qa=1027,Mz=1028,Sz=1029,Ez=1030,Tz=1031,Dz=1033,Zy=33776,Ky=33777,Jy=33778,Qy=33779,gD=35840,yD=35841,_D=35842,vD=35843,Cz=36196,xD=37492,wD=37496,bD=37808,MD=37809,SD=37810,ED=37811,TD=37812,DD=37813,CD=37814,AD=37815,ID=37816,RD=37817,PD=37818,LD=37819,ND=37820,FD=37821,OD=36492,Xc=2300,Xa=2301,Ya=2400,Za=2401,ws=3e3,xt=3001,Fz=3201,xo=0,Oz=1,Yc=35044,Zc=35048,HD="300 es",i_=1035;class wo{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Tn=[];for(let n=0;n<256;n++)Tn[n]=(n<16?"0":"")+n.toString(16);let Gf=1234567;const bo=Math.PI/180,Kc=180/Math.PI;function vi(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Tn[255&n]+Tn[n>>8&255]+Tn[n>>16&255]+Tn[n>>24&255]+"-"+Tn[255&e]+Tn[e>>8&255]+"-"+Tn[e>>16&15|64]+Tn[e>>24&255]+"-"+Tn[63&t|128]+Tn[t>>8&255]+"-"+Tn[t>>16&255]+Tn[t>>24&255]+Tn[255&i]+Tn[i>>8&255]+Tn[i>>16&255]+Tn[i>>24&255]).toUpperCase()}function Dn(n,e,t){return Math.max(e,Math.min(t,n))}function r_(n,e){return(n%e+e)%e}function Jc(n,e,t){return(1-t)*n+t*e}function s_(n){return 0==(n&n-1)&&0!==n}function UD(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Wf(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}var Kz=Object.freeze({__proto__:null,DEG2RAD:bo,RAD2DEG:Kc,generateUUID:vi,clamp:Dn,euclideanModulo:r_,mapLinear:function Bz(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function Hz(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:Jc,damp:function Uz(n,e,t,i){return Jc(n,e,1-Math.exp(-t*i))},pingpong:function Vz(n,e=1){return e-Math.abs(r_(n,2*e)-e)},smoothstep:function zz(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function Gz(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function Wz(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function jz(n,e){return n+Math.random()*(e-n)},randFloatSpread:function $z(n){return n*(.5-Math.random())},seededRandom:function qz(n){return void 0!==n&&(Gf=n%2147483647),Gf=16807*Gf%2147483647,(Gf-1)/2147483646},degToRad:function Xz(n){return n*bo},radToDeg:function Yz(n){return n*Kc},isPowerOfTwo:s_,ceilPowerOfTwo:UD,floorPowerOfTwo:Wf,setQuaternionFromProperEuler:function Zz(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),u=o((e+i)/2),d=s((e-i)/2),f=o((e-i)/2),h=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":n.set(a*u,l*d,l*f,a*c);break;case"YZY":n.set(l*f,a*u,l*d,a*c);break;case"ZXZ":n.set(l*d,l*f,a*u,a*c);break;case"XZX":n.set(a*u,l*p,l*h,a*c);break;case"YXY":n.set(l*h,a*u,l*p,a*c);break;case"ZYZ":n.set(l*p,l*h,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}});class X{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}X.prototype.isVector2=!0;class xn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],f=i[2],h=i[5],p=i[8],g=r[0],_=r[3],y=r[6],m=r[1],x=r[4],v=r[7],w=r[2],M=r[5],T=r[8];return s[0]=o*g+a*m+l*w,s[3]=o*_+a*x+l*M,s[6]=o*y+a*v+l*T,s[1]=c*g+u*m+d*w,s[4]=c*_+u*x+d*M,s[7]=c*y+u*v+d*T,s[2]=f*g+h*m+p*w,s[5]=f*_+h*x+p*M,s[8]=f*y+h*v+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,f=a*l-u*s,h=c*s-o*l,p=t*d+i*f+r*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=d*g,e[1]=(r*c-u*i)*g,e[2]=(a*i-r*o)*g,e[3]=f*g,e[4]=(u*t-r*l)*g,e[5]=(r*s-a*t)*g,e[6]=h*g,e[7]=(i*l-c*t)*g,e[8]=(o*t-i*s)*g,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=t*s+i*l,r[3]=t*o+i*c,r[6]=t*a+i*u,r[1]=-i*s+t*l,r[4]=-i*o+t*c,r[7]=-i*a+t*u,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function VD(n){for(let e=n.length-1;e>=0;--e)if(n[e]>65535)return!0;return!1}function Qc(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}xn.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const zD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zi={h:0,s:0,l:0},jf={h:0,s:0,l:0};function o_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function Ja(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function a_(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let Qa,re=(()=>{class n{constructor(t,i,r){return void 0===i&&void 0===r?this.set(t):this.setRGB(t,i,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,i,r){return this.r=t,this.g=i,this.b=r,this}setHSL(t,i,r){if(t=r_(t,1),i=Dn(i,0,1),r=Dn(r,0,1),0===i)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+i):r+i-r*i,o=2*r-s;this.r=o_(o,s,t+1/3),this.g=o_(o,s,t),this.b=o_(o,s,t-1/3)}return this}setStyle(t){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseInt(s[2],10)/100,u=parseInt(s[3],10)/100;return i(s[4]),this.setHSL(l,c,u)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=r[1],o=s.length;if(3===o)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===o)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const i=zD[t.toLowerCase()];return void 0!==i?this.setHex(i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Ja(t.r),this.g=Ja(t.g),this.b=Ja(t.b),this}copyLinearToSRGB(t){return this.r=a_(t.r),this.g=a_(t.g),this.b=a_(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const i=this.r,r=this.g,s=this.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return t.h=l,t.s=c,t.l=u,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,i,r){return this.getHSL(Zi),Zi.h+=t,Zi.s+=i,Zi.l+=r,this.setHSL(Zi.h,Zi.s,Zi.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,r){return this.r=t.r+(i.r-t.r)*r,this.g=t.g+(i.g-t.g)*r,this.b=t.b+(i.b-t.b)*r,this}lerpHSL(t,i){this.getHSL(Zi),t.getHSL(jf);const r=Jc(Zi.h,jf.h,i),s=Jc(Zi.s,jf.s,i),o=Jc(Zi.l,jf.l,i);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return n.NAMES=zD,n})();re.prototype.isColor=!0,re.prototype.r=1,re.prototype.g=1,re.prototype.b=1;class Mo{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Qa&&(Qa=Qc("canvas")),Qa.width=e.width,Qa.height=e.height;const i=Qa.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Qa}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Qc("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Ja(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Ja(t[i]/255)):Ja(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class el{constructor(e=null){this.uuid=vi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(l_(r[o].isDataTexture?r[o].image:r[o]))}else s=l_(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function l_(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Mo.getDataURL(n):n.data?{data:Array.prototype.slice.call(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}el.prototype.isSource=!0;let Qz=0,Fn=(()=>{class n extends wo{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=qn,s=qn,o=Rt,a=vs,l=Xn,c=_o,u=1,d=ws){super(),Object.defineProperty(this,"id",{value:Qz++}),this.uuid=vi(),this.name="",this.source=new el(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new X(0,0),this.repeat=new X(1,1),this.center=new X(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new xn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case yo:t.x=t.x-Math.floor(t.x);break;case qn:t.x=t.x<0?0:1;break;case $c:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case yo:t.y=t.y-Math.floor(t.y);break;case qn:t.y=t.y<0?0:1;break;case $c:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n})();Fn.prototype.isTexture=!0;class gt{constructor(e=0,t=0,i=0,r=1){this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],f=l[1],h=l[5],p=l[9],g=l[2],_=l[6],y=l[10];if(Math.abs(u-f)<.01&&Math.abs(d-g)<.01&&Math.abs(p-_)<.01){if(Math.abs(u+f)<.1&&Math.abs(d+g)<.1&&Math.abs(p+_)<.1&&Math.abs(c+h+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(c+1)/2,v=(h+1)/2,w=(y+1)/2,M=(u+f)/4,T=(d+g)/4,C=(p+_)/4;return x>v&&x>w?x<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(x),r=M/i,s=T/i):v>w?v<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(v),i=M/r,s=C/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=T/s,r=C/s),this.set(i,r,s,t),this}let m=Math.sqrt((_-p)*(_-p)+(d-g)*(d-g)+(f-u)*(f-u));return Math.abs(m)<.001&&(m=1),this.x=(_-p)/m,this.y=(d-g)/m,this.z=(f-u)/m,this.w=Math.acos((c+h+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}gt.prototype.isVector4=!0;class ai extends wo{constructor(e,t,i={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new gt(0,0,e,t),this.scissorTest=!1,this.viewport=new gt(0,0,e,t),this.texture=new Fn({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:Rt,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}ai.prototype.isWebGLRenderTarget=!0;class eu extends Fn{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=an,this.minFilter=an,this.wrapR=qn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}eu.prototype.isDataArrayTexture=!0,class eG extends ai{constructor(e,t,i){super(e,t),this.depth=i,this.texture=new eu(null,e,t,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGLArrayRenderTarget=!0;class $f extends Fn{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=an,this.minFilter=an,this.wrapR=qn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}$f.prototype.isData3DTexture=!0,class tG extends ai{constructor(e,t,i){super(e,t),this.depth=i,this.texture=new $f(null,e,t,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGL3DRenderTarget=!0,class nG extends ai{constructor(e,t,i,r={}){super(e,t,r);const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone()}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class Cn{constructor(e=0,t=0,i=0,r=1){this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const f=s[o+0],h=s[o+1],p=s[o+2],g=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=f,e[t+1]=h,e[t+2]=p,void(e[t+3]=g);if(d!==g||l!==f||c!==h||u!==p){let _=1-a;const y=l*f+c*h+u*p+d*g,m=y>=0?1:-1,x=1-y*y;if(x>Number.EPSILON){const w=Math.sqrt(x),M=Math.atan2(w,y*m);_=Math.sin(_*M)/w,a=Math.sin(a*M)/w}const v=a*m;if(l=l*_+f*v,c=c*_+h*v,u=u*_+p*v,d=d*_+g*v,_===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=w,c*=w,u*=w,d*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],f=s[o+1],h=s[o+2],p=s[o+3];return e[t]=a*p+u*d+l*h-c*f,e[t+1]=l*p+u*f+c*d-a*h,e[t+2]=c*p+u*h+a*f-l*d,e[t+3]=u*p-a*d-l*f-c*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),f=l(i/2),h=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=f*u*d+c*h*p,this._y=c*h*d-f*u*p,this._z=c*u*p+f*h*d,this._w=c*u*d-f*h*p;break;case"YXZ":this._x=f*u*d+c*h*p,this._y=c*h*d-f*u*p,this._z=c*u*p-f*h*d,this._w=c*u*d+f*h*p;break;case"ZXY":this._x=f*u*d-c*h*p,this._y=c*h*d+f*u*p,this._z=c*u*p+f*h*d,this._w=c*u*d-f*h*p;break;case"ZYX":this._x=f*u*d-c*h*p,this._y=c*h*d+f*u*p,this._z=c*u*p-f*h*d,this._w=c*u*d+f*h*p;break;case"YZX":this._x=f*u*d+c*h*p,this._y=c*h*d+f*u*p,this._z=c*u*p-f*h*d,this._w=c*u*d-f*h*p;break;case"XZY":this._x=f*u*d-c*h*p,this._y=c*h*d-f*u*p,this._z=c*u*p+f*h*d,this._w=c*u*d+f*h*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],f=i+a+d;if(f>0){const h=.5/Math.sqrt(f+1);this._w=.25/h,this._x=(u-l)*h,this._y=(s-c)*h,this._z=(o-r)*h}else if(i>a&&i>d){const h=2*Math.sqrt(1+i-a-d);this._w=(u-l)/h,this._x=.25*h,this._y=(r+o)/h,this._z=(s+c)/h}else if(a>d){const h=2*Math.sqrt(1+a-i-d);this._w=(s-c)/h,this._x=(r+o)/h,this._y=.25*h,this._z=(l+u)/h}else{const h=2*Math.sqrt(1+d-i-a);this._w=(o-r)/h,this._x=(s+c)/h,this._y=(l+u)/h,this._z=.25*h}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Dn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const h=1-t;return this._w=h*o+t*this._w,this._x=h*i+t*this._x,this._y=h*r+t*this._y,this._z=h*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,f=Math.sin(t*u)/c;return this._w=o*d+this._w*f,this._x=i*d+this._x*f,this._y=r*d+this._y*f,this._z=s*d+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Cn.prototype.isQuaternion=!0;class E{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(GD.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(GD.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,f=-s*t-o*i-a*r;return this.x=c*l+f*-s+u*-a-d*-o,this.y=u*l+f*-o+d*-s-c*-a,this.z=d*l+f*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return c_.copy(this).projectOnVector(e),this.sub(c_)}reflect(e){return this.sub(c_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Dn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}E.prototype.isVector3=!0;const c_=new E,GD=new Cn;class xi{constructor(e=new E(1/0,1/0,1/0),t=new E(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],d=e[l+1],f=e[l+2];u<t&&(t=u),d<i&&(i=d),f<r&&(r=f),u>s&&(s=u),d>o&&(o=d),f>a&&(a=f)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),d=e.getY(l),f=e.getZ(l);u<t&&(t=u),d<i&&(i=d),f<r&&(r=f),u>s&&(s=u),d>o&&(o=d),f>a&&(a=f)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=So.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)So.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(So)}else null===i.boundingBox&&i.computeBoundingBox(),u_.copy(i.boundingBox),u_.applyMatrix4(e.matrixWorld),this.union(u_);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,So),So.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(tu),qf.subVectors(this.max,tu),tl.subVectors(e.a,tu),nl.subVectors(e.b,tu),il.subVectors(e.c,tu),bs.subVectors(nl,tl),Ms.subVectors(il,nl),Eo.subVectors(tl,il);let t=[0,-bs.z,bs.y,0,-Ms.z,Ms.y,0,-Eo.z,Eo.y,bs.z,0,-bs.x,Ms.z,0,-Ms.x,Eo.z,0,-Eo.x,-bs.y,bs.x,0,-Ms.y,Ms.x,0,-Eo.y,Eo.x,0];return!(!d_(t,tl,nl,il,qf)||(t=[1,0,0,0,1,0,0,0,1],!d_(t,tl,nl,il,qf)))&&(Xf.crossVectors(bs,Ms),t=[Xf.x,Xf.y,Xf.z],d_(t,tl,nl,il,qf))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return So.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(So).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Gr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Gr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Gr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Gr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Gr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Gr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Gr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Gr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Gr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}xi.prototype.isBox3=!0;const Gr=[new E,new E,new E,new E,new E,new E,new E,new E],So=new E,u_=new xi,tl=new E,nl=new E,il=new E,bs=new E,Ms=new E,Eo=new E,tu=new E,qf=new E,Xf=new E,To=new E;function d_(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){To.fromArray(n,s);const a=r.x*Math.abs(To.x)+r.y*Math.abs(To.y)+r.z*Math.abs(To.z),l=e.dot(To),c=t.dot(To),u=i.dot(To);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const iG=new xi,WD=new E,Yf=new E,f_=new E;class Ss{constructor(e=new E,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):iG.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){f_.subVectors(e,this.center);const t=f_.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.add(f_.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?Yf.set(0,0,1).multiplyScalar(e.radius):Yf.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(WD.copy(e.center).add(Yf)),this.expandByPoint(WD.copy(e.center).sub(Yf)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Wr=new E,h_=new E,Zf=new E,Es=new E,p_=new E,Kf=new E,m_=new E;class Do{constructor(e=new E,t=new E(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Wr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Wr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Wr.copy(this.direction).multiplyScalar(t).add(this.origin),Wr.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){h_.copy(e).add(t).multiplyScalar(.5),Zf.copy(t).sub(e).normalize(),Es.copy(this.origin).sub(h_);const s=.5*e.distanceTo(t),o=-this.direction.dot(Zf),a=Es.dot(this.direction),l=-Es.dot(Zf),c=Es.lengthSq(),u=Math.abs(1-o*o);let d,f,h,p;if(u>0)if(d=o*l-a,f=o*a-l,p=s*u,d>=0)if(f>=-p)if(f<=p){const g=1/u;d*=g,f*=g,h=d*(d+o*f+2*a)+f*(o*d+f+2*l)+c}else f=s,d=Math.max(0,-(o*f+a)),h=-d*d+f*(f+2*l)+c;else f=-s,d=Math.max(0,-(o*f+a)),h=-d*d+f*(f+2*l)+c;else f<=-p?(d=Math.max(0,-(-o*s+a)),f=d>0?-s:Math.min(Math.max(-s,-l),s),h=-d*d+f*(f+2*l)+c):f<=p?(d=0,f=Math.min(Math.max(-s,-l),s),h=f*(f+2*l)+c):(d=Math.max(0,-(o*s+a)),f=d>0?s:Math.min(Math.max(-s,-l),s),h=-d*d+f*(f+2*l)+c);else f=o>0?-s:s,d=Math.max(0,-(o*f+a)),h=-d*d+f*(f+2*l)+c;return i&&i.copy(this.direction).multiplyScalar(d).add(this.origin),r&&r.copy(Zf).multiplyScalar(f).add(h_),h}intersectSphere(e,t){Wr.subVectors(e.center,this.origin);const i=Wr.dot(this.direction),r=Wr.dot(Wr)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,f=this.origin;return c>=0?(i=(e.min.x-f.x)*c,r=(e.max.x-f.x)*c):(i=(e.max.x-f.x)*c,r=(e.min.x-f.x)*c),u>=0?(s=(e.min.y-f.y)*u,o=(e.max.y-f.y)*u):(s=(e.max.y-f.y)*u,o=(e.min.y-f.y)*u),i>o||s>r||((s>i||i!=i)&&(i=s),(o<r||r!=r)&&(r=o),d>=0?(a=(e.min.z-f.z)*d,l=(e.max.z-f.z)*d):(a=(e.max.z-f.z)*d,l=(e.min.z-f.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Wr)}intersectTriangle(e,t,i,r,s){p_.subVectors(t,e),Kf.subVectors(i,e),m_.crossVectors(p_,Kf);let a,o=this.direction.dot(m_);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Es.subVectors(this.origin,e);const l=a*this.direction.dot(Kf.crossVectors(Es,Kf));if(l<0)return null;const c=a*this.direction.dot(p_.cross(Es));if(c<0||l+c>o)return null;const u=-a*Es.dot(m_);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class me{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,l,c,u,d,f,h,p,g,_){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=d,y[14]=f,y[3]=h,y[7]=p,y[11]=g,y[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new me).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/rl.setFromMatrixColumn(e,0).length(),s=1/rl.setFromMatrixColumn(e,1).length(),o=1/rl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const f=o*u,h=o*d,p=a*u,g=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=h+p*c,t[5]=f-g*c,t[9]=-a*l,t[2]=g-f*c,t[6]=p+h*c,t[10]=o*l}else if("YXZ"===e.order){const f=l*u,h=l*d,p=c*u,g=c*d;t[0]=f+g*a,t[4]=p*a-h,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=h*a-p,t[6]=g+f*a,t[10]=o*l}else if("ZXY"===e.order){const f=l*u,h=l*d,p=c*u,g=c*d;t[0]=f-g*a,t[4]=-o*d,t[8]=p+h*a,t[1]=h+p*a,t[5]=o*u,t[9]=g-f*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const f=o*u,h=o*d,p=a*u,g=a*d;t[0]=l*u,t[4]=p*c-h,t[8]=f*c+g,t[1]=l*d,t[5]=g*c+f,t[9]=h*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const f=o*l,h=o*c,p=a*l,g=a*c;t[0]=l*u,t[4]=g-f*d,t[8]=p*d+h,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=h*d+p,t[10]=f-g*d}else if("XZY"===e.order){const f=o*l,h=o*c,p=a*l,g=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=f*d+g,t[5]=o*u,t[9]=h*d-p,t[2]=p*d-h,t[6]=a*u,t[10]=g*d+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(rG,e,sG)}lookAt(e,t,i){const r=this.elements;return wi.subVectors(e,t),0===wi.lengthSq()&&(wi.z=1),wi.normalize(),Ts.crossVectors(i,wi),0===Ts.lengthSq()&&(1===Math.abs(i.z)?wi.x+=1e-4:wi.z+=1e-4,wi.normalize(),Ts.crossVectors(i,wi)),Ts.normalize(),Jf.crossVectors(wi,Ts),r[0]=Ts.x,r[4]=Jf.x,r[8]=wi.x,r[1]=Ts.y,r[5]=Jf.y,r[9]=wi.y,r[2]=Ts.z,r[6]=Jf.z,r[10]=wi.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],f=i[9],h=i[13],p=i[2],g=i[6],_=i[10],y=i[14],m=i[3],x=i[7],v=i[11],w=i[15],M=r[0],T=r[4],C=r[8],R=r[12],P=r[1],b=r[5],I=r[9],L=r[13],F=r[2],O=r[6],B=r[10],U=r[14],k=r[3],j=r[7],J=r[11],Q=r[15];return s[0]=o*M+a*P+l*F+c*k,s[4]=o*T+a*b+l*O+c*j,s[8]=o*C+a*I+l*B+c*J,s[12]=o*R+a*L+l*U+c*Q,s[1]=u*M+d*P+f*F+h*k,s[5]=u*T+d*b+f*O+h*j,s[9]=u*C+d*I+f*B+h*J,s[13]=u*R+d*L+f*U+h*Q,s[2]=p*M+g*P+_*F+y*k,s[6]=p*T+g*b+_*O+y*j,s[10]=p*C+g*I+_*B+y*J,s[14]=p*R+g*L+_*U+y*Q,s[3]=m*M+x*P+v*F+w*k,s[7]=m*T+x*b+v*O+w*j,s[11]=m*C+x*I+v*B+w*J,s[15]=m*R+x*L+v*U+w*Q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],f=e[10],h=e[14];return e[3]*(+s*l*d-r*c*d-s*a*f+i*c*f+r*a*h-i*l*h)+e[7]*(+t*l*h-t*c*f+s*o*f-r*o*h+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*h-s*o*d+i*o*h+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*f+r*o*d-i*o*f+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],f=e[10],h=e[11],p=e[12],g=e[13],_=e[14],y=e[15],m=d*_*c-g*f*c+g*l*h-a*_*h-d*l*y+a*f*y,x=p*f*c-u*_*c-p*l*h+o*_*h+u*l*y-o*f*y,v=u*g*c-p*d*c+p*a*h-o*g*h-u*a*y+o*d*y,w=p*d*l-u*g*l-p*a*f+o*g*f+u*a*_-o*d*_,M=t*m+i*x+r*v+s*w;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/M;return e[0]=m*T,e[1]=(g*f*s-d*_*s-g*r*h+i*_*h+d*r*y-i*f*y)*T,e[2]=(a*_*s-g*l*s+g*r*c-i*_*c-a*r*y+i*l*y)*T,e[3]=(d*l*s-a*f*s-d*r*c+i*f*c+a*r*h-i*l*h)*T,e[4]=x*T,e[5]=(u*_*s-p*f*s+p*r*h-t*_*h-u*r*y+t*f*y)*T,e[6]=(p*l*s-o*_*s-p*r*c+t*_*c+o*r*y-t*l*y)*T,e[7]=(o*f*s-u*l*s+u*r*c-t*f*c-o*r*h+t*l*h)*T,e[8]=v*T,e[9]=(p*d*s-u*g*s-p*i*h+t*g*h+u*i*y-t*d*y)*T,e[10]=(o*g*s-p*a*s+p*i*c-t*g*c-o*i*y+t*a*y)*T,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*h-t*a*h)*T,e[12]=w*T,e[13]=(u*g*r-p*d*r+p*i*f-t*g*f-u*i*_+t*d*_)*T,e[14]=(p*a*r-o*g*r-p*i*l+t*g*l+o*i*_-t*a*_)*T,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*f+t*a*f)*T,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,f=s*c,h=s*u,p=s*d,g=o*u,_=o*d,y=a*d,m=l*c,x=l*u,v=l*d,w=i.x,M=i.y,T=i.z;return r[0]=(1-(g+y))*w,r[1]=(h+v)*w,r[2]=(p-x)*w,r[3]=0,r[4]=(h-v)*M,r[5]=(1-(f+y))*M,r[6]=(_+m)*M,r[7]=0,r[8]=(p+x)*T,r[9]=(_-m)*T,r[10]=(1-(f+g))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=rl.set(r[0],r[1],r[2]).length();const o=rl.set(r[4],r[5],r[6]).length(),a=rl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ki.copy(this);const c=1/s,u=1/o,d=1/a;return Ki.elements[0]*=c,Ki.elements[1]*=c,Ki.elements[2]*=c,Ki.elements[4]*=u,Ki.elements[5]*=u,Ki.elements[6]*=u,Ki.elements[8]*=d,Ki.elements[9]*=d,Ki.elements[10]*=d,t.setFromRotationMatrix(Ki),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(i-r),u=(t+e)/(t-e),d=(i+r)/(i-r),f=-(o+s)/(o-s),h=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(o-s),d=(t+e)*l,f=(i+r)*c,h=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-h,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}me.prototype.isMatrix4=!0;const rl=new E,Ki=new me,rG=new E(0,0,0),sG=new E(1,1,1),Ts=new E,Jf=new E,wi=new E,jD=new me,$D=new Cn;class Co{constructor(e=0,t=0,i=0,r=Co.DefaultOrder){this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],d=r[2],f=r[6],h=r[10];switch(t){case"XYZ":this._y=Math.asin(Dn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,h),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Dn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(Dn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,h),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Dn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,h),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Dn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-Dn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return jD.makeRotationFromQuaternion(e),this.setFromRotationMatrix(jD,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return $D.setFromEuler(this),this.setFromQuaternion($D,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Co.prototype.isEuler=!0,Co.DefaultOrder="XYZ",Co.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class g_{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let oG=0;const qD=new E,sl=new Cn,jr=new me,Qf=new E,nu=new E,aG=new E,lG=new Cn,XD=new E(1,0,0),YD=new E(0,1,0),ZD=new E(0,0,1),cG={type:"added"},KD={type:"removed"};class ut extends wo{constructor(){super(),Object.defineProperty(this,"id",{value:oG++}),this.uuid=vi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ut.DefaultUp.clone();const e=new E,t=new Co,i=new Cn,r=new E(1,1,1);t._onChange(function s(){i.setFromEuler(t,!1)}),i._onChange(function o(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new me},normalMatrix:{value:new xn}}),this.matrix=new me,this.matrixWorld=new me,this.matrixAutoUpdate=ut.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new g_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return sl.setFromAxisAngle(e,t),this.quaternion.multiply(sl),this}rotateOnWorldAxis(e,t){return sl.setFromAxisAngle(e,t),this.quaternion.premultiply(sl),this}rotateX(e){return this.rotateOnAxis(XD,e)}rotateY(e){return this.rotateOnAxis(YD,e)}rotateZ(e){return this.rotateOnAxis(ZD,e)}translateOnAxis(e,t){return qD.copy(e).applyQuaternion(this.quaternion),this.position.add(qD.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(XD,e)}translateY(e){return this.translateOnAxis(YD,e)}translateZ(e){return this.translateOnAxis(ZD,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(jr.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Qf.copy(e):Qf.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),nu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?jr.lookAt(nu,Qf,this.up):jr.lookAt(Qf,nu,this.up),this.quaternion.setFromRotationMatrix(jr),r&&(jr.extractRotation(r.matrixWorld),sl.setFromRotationMatrix(jr),this.quaternion.premultiply(sl.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(cG)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(KD)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(KD)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),jr.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),jr.multiply(e.parent.matrixWorld)),e.applyMatrix4(jr),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(void 0!==o)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nu,e,aG),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nu,lG,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(a,l){return void 0===a[l.uuid]&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++)s(e.shapes,l[c]);else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++)r.animations.push(s(e.animations,this.animations[a]))}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),d=o(e.shapes),f=o(e.skeletons),h=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),d.length>0&&(i.shapes=d),f.length>0&&(i.skeletons=f),h.length>0&&(i.animations=h),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let i=0;i<e.children.length;i++)this.add(e.children[i].clone());return this}}ut.DefaultUp=new E(0,1,0),ut.DefaultMatrixAutoUpdate=!0,ut.prototype.isObject3D=!0;const Ji=new E,$r=new E,y_=new E,qr=new E,ol=new E,al=new E,JD=new E,__=new E,v_=new E,x_=new E;class ln{constructor(e=new E,t=new E,i=new E){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Ji.subVectors(e,t),r.cross(Ji);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Ji.subVectors(r,t),$r.subVectors(i,t),y_.subVectors(e,t);const o=Ji.dot(Ji),a=Ji.dot($r),l=Ji.dot(y_),c=$r.dot($r),u=$r.dot(y_),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const f=1/d,h=(c*l-a*u)*f,p=(o*u-a*l)*f;return s.set(1-h-p,p,h)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,qr),qr.x>=0&&qr.y>=0&&qr.x+qr.y<=1}static getUV(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,qr),l.set(0,0),l.addScaledVector(s,qr.x),l.addScaledVector(o,qr.y),l.addScaledVector(a,qr.z),l}static isFrontFacing(e,t,i,r){return Ji.subVectors(i,t),$r.subVectors(e,t),Ji.cross($r).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ji.subVectors(this.c,this.b),$r.subVectors(this.a,this.b),.5*Ji.cross($r).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ln.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ln.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return ln.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return ln.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ln.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;ol.subVectors(r,i),al.subVectors(s,i),__.subVectors(e,i);const l=ol.dot(__),c=al.dot(__);if(l<=0&&c<=0)return t.copy(i);v_.subVectors(e,r);const u=ol.dot(v_),d=al.dot(v_);if(u>=0&&d<=u)return t.copy(r);const f=l*d-u*c;if(f<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(ol,o);x_.subVectors(e,s);const h=ol.dot(x_),p=al.dot(x_);if(p>=0&&h<=p)return t.copy(s);const g=h*c-l*p;if(g<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(al,a);const _=u*p-h*d;if(_<=0&&d-u>=0&&h-p>=0)return JD.subVectors(s,r),a=(d-u)/(d-u+(h-p)),t.copy(r).addScaledVector(JD,a);const y=1/(_+g+f);return o=g*y,a=f*y,t.copy(i).addScaledVector(ol,o).addScaledVector(al,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let uG=0;class kt extends wo{constructor(){super(),Object.defineProperty(this,"id",{value:uG++}),this.uuid=vi(),this.name="",this.type="Material",this.fog=!0,this.blending=Ga,this.side=ho,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=pD,this.blendDst=mD,this.blendEquation=Wa,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=qy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Ga&&(i.blending=this.blending),this.side!==ho&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}kt.prototype.isMaterial=!0,kt.fromType=function(){return null};class bi extends kt{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new re(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ff,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}bi.prototype.isMeshBasicMaterial=!0;const Dt=new E,eh=new X;class yt{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=Yc,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new re),t[i++]=o.r,t[i++]=o.g,t[i++]=o.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new X),t[i++]=o.x,t[i++]=o.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new E),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new gt),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=o.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)eh.fromBufferAttribute(this,t),eh.applyMatrix3(e),this.setXY(t,eh.x,eh.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Dt.fromBufferAttribute(this,t),Dt.applyMatrix3(e),this.setXYZ(t,Dt.x,Dt.y,Dt.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Dt.x=this.getX(t),Dt.y=this.getY(t),Dt.z=this.getZ(t),Dt.applyMatrix4(e),this.setXYZ(t,Dt.x,Dt.y,Dt.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Dt.x=this.getX(t),Dt.y=this.getY(t),Dt.z=this.getZ(t),Dt.applyNormalMatrix(e),this.setXYZ(t,Dt.x,Dt.y,Dt.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Dt.x=this.getX(t),Dt.y=this.getY(t),Dt.z=this.getZ(t),Dt.transformDirection(e),this.setXYZ(t,Dt.x,Dt.y,Dt.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Yc&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}yt.prototype.isBufferAttribute=!0;class w_ extends yt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class b_ extends yt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}(class gG extends yt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}).prototype.isFloat16BufferAttribute=!0;class ge extends yt{constructor(e,t,i){super(new Float32Array(e),t,i)}}let _G=0;const Ni=new me,M_=new ut,ll=new E,Mi=new xi,iu=new xi,wn=new E;class Te extends wo{constructor(){super(),Object.defineProperty(this,"id",{value:_G++}),this.uuid=vi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(VD(e)?b_:w_)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new xn).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ni.makeRotationFromQuaternion(e),this.applyMatrix4(Ni),this}rotateX(e){return Ni.makeRotationX(e),this.applyMatrix4(Ni),this}rotateY(e){return Ni.makeRotationY(e),this.applyMatrix4(Ni),this}rotateZ(e){return Ni.makeRotationZ(e),this.applyMatrix4(Ni),this}translate(e,t,i){return Ni.makeTranslation(e,t,i),this.applyMatrix4(Ni),this}scale(e,t,i){return Ni.makeScale(e,t,i),this.applyMatrix4(Ni),this}lookAt(e){return M_.lookAt(e),M_.updateMatrix(),this.applyMatrix4(M_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ll).negate(),this.translate(ll.x,ll.y,ll.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ge(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new xi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new E(-1/0,-1/0,-1/0),new E(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Mi.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(wn.addVectors(this.boundingBox.min,Mi.min),this.boundingBox.expandByPoint(wn),wn.addVectors(this.boundingBox.max,Mi.max),this.boundingBox.expandByPoint(wn)):(this.boundingBox.expandByPoint(Mi.min),this.boundingBox.expandByPoint(Mi.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Ss);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new E,1/0);if(e){const i=this.boundingSphere.center;if(Mi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)iu.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(wn.addVectors(Mi.min,iu.min),Mi.expandByPoint(wn),wn.addVectors(Mi.max,iu.max),Mi.expandByPoint(wn)):(Mi.expandByPoint(iu.min),Mi.expandByPoint(iu.max));Mi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)wn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(wn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)wn.fromBufferAttribute(a,c),l&&(ll.fromBufferAttribute(e,c),wn.add(ll)),r=Math.max(r,i.distanceToSquared(wn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new yt(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let P=0;P<a;P++)c[P]=new E,u[P]=new E;const d=new E,f=new E,h=new E,p=new X,g=new X,_=new X,y=new E,m=new E;function x(P,b,I){d.fromArray(r,3*P),f.fromArray(r,3*b),h.fromArray(r,3*I),p.fromArray(o,2*P),g.fromArray(o,2*b),_.fromArray(o,2*I),f.sub(d),h.sub(d),g.sub(p),_.sub(p);const L=1/(g.x*_.y-_.x*g.y);isFinite(L)&&(y.copy(f).multiplyScalar(_.y).addScaledVector(h,-g.y).multiplyScalar(L),m.copy(h).multiplyScalar(g.x).addScaledVector(f,-_.x).multiplyScalar(L),c[P].add(y),c[b].add(y),c[I].add(y),u[P].add(m),u[b].add(m),u[I].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:i.length}]);for(let P=0,b=v.length;P<b;++P){const I=v[P],L=I.start;for(let O=L,B=L+I.count;O<B;O+=3)x(i[O+0],i[O+1],i[O+2])}const w=new E,M=new E,T=new E,C=new E;function R(P){T.fromArray(s,3*P),C.copy(T);const b=c[P];w.copy(b),w.sub(T.multiplyScalar(T.dot(b))).normalize(),M.crossVectors(C,b);const L=M.dot(u[P])<0?-1:1;l[4*P]=w.x,l[4*P+1]=w.y,l[4*P+2]=w.z,l[4*P+3]=L}for(let P=0,b=v.length;P<b;++P){const I=v[P],L=I.start;for(let O=L,B=L+I.count;O<B;O+=3)R(i[O+0]),R(i[O+1]),R(i[O+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new yt(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let f=0,h=i.count;f<h;f++)i.setXYZ(f,0,0,0);const r=new E,s=new E,o=new E,a=new E,l=new E,c=new E,u=new E,d=new E;if(e)for(let f=0,h=e.count;f<h;f+=3){const p=e.getX(f+0),g=e.getX(f+1),_=e.getX(f+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,g),o.fromBufferAttribute(t,_),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,g),c.fromBufferAttribute(i,_),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(g,l.x,l.y,l.z),i.setXYZ(_,c.x,c.y,c.z)}else for(let f=0,h=t.count;f<h;f+=3)r.fromBufferAttribute(t,f+0),s.fromBufferAttribute(t,f+1),o.fromBufferAttribute(t,f+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(f+0,u.x,u.y,u.z),i.setXYZ(f+1,u.x,u.y,u.z),i.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(void 0===e.attributes[r])continue;const o=i[r].array,a=e.attributes[r],l=a.array,c=a.itemSize*t,u=Math.min(l.length,o.length-c);for(let d=0,f=c;d<u;d++,f++)o[f]=l[d]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)wn.fromBufferAttribute(e,t),wn.normalize(),e.setXYZ(t,wn.x,wn.y,wn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,f=new c.constructor(l.length*u);let h=0,p=0;for(let g=0,_=l.length;g<_;g++){h=a.isInterleavedBufferAttribute?l[g]*a.data.stride+a.offset:l[g]*u;for(let y=0;y<u;y++)f[p++]=c[h++]}return new yt(f,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Te,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const h=e(c[u],i);l.push(h)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,f=c.length;d<f;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let f=0,h=d.length;f<h;f++)u.push(d[f].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Te.prototype.isBufferGeometry=!0;const QD=new me,cl=new Do,S_=new Ss,Ds=new E,Cs=new E,As=new E,E_=new E,T_=new E,D_=new E,th=new E,nh=new E,ih=new E,rh=new X,sh=new X,oh=new X,C_=new E,ah=new E;class _n extends ut{constructor(e=new Te,t=new bi){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),S_.copy(i.boundingSphere),S_.applyMatrix4(s),!1===e.ray.intersectsSphere(S_))||(QD.copy(s).invert(),cl.copy(e.ray).applyMatrix4(QD),null!==i.boundingBox&&!1===cl.intersectsBox(i.boundingBox)))return;let o;if(i.isBufferGeometry){const a=i.index,l=i.attributes.position,c=i.morphAttributes.position,u=i.morphTargetsRelative,d=i.attributes.uv,f=i.attributes.uv2,h=i.groups,p=i.drawRange;if(null!==a)if(Array.isArray(r))for(let g=0,_=h.length;g<_;g++){const y=h[g],m=r[y.materialIndex];for(let w=Math.max(y.start,p.start),M=Math.min(a.count,Math.min(y.start+y.count,p.start+p.count));w<M;w+=3){const T=a.getX(w),C=a.getX(w+1),R=a.getX(w+2);o=lh(this,m,e,cl,l,c,u,d,f,T,C,R),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=y.materialIndex,t.push(o))}}else for(let y=Math.max(0,p.start),m=Math.min(a.count,p.start+p.count);y<m;y+=3){const x=a.getX(y),v=a.getX(y+1),w=a.getX(y+2);o=lh(this,r,e,cl,l,c,u,d,f,x,v,w),o&&(o.faceIndex=Math.floor(y/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let g=0,_=h.length;g<_;g++){const y=h[g],m=r[y.materialIndex];for(let w=Math.max(y.start,p.start),M=Math.min(l.count,Math.min(y.start+y.count,p.start+p.count));w<M;w+=3)o=lh(this,m,e,cl,l,c,u,d,f,w,w+1,w+2),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=y.materialIndex,t.push(o))}else for(let y=Math.max(0,p.start),m=Math.min(l.count,p.start+p.count);y<m;y+=3)o=lh(this,r,e,cl,l,c,u,d,f,y,y+1,y+2),o&&(o.faceIndex=Math.floor(y/3),t.push(o))}else i.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function lh(n,e,t,i,r,s,o,a,l,c,u,d){Ds.fromBufferAttribute(r,c),Cs.fromBufferAttribute(r,u),As.fromBufferAttribute(r,d);const f=n.morphTargetInfluences;if(s&&f){th.set(0,0,0),nh.set(0,0,0),ih.set(0,0,0);for(let p=0,g=s.length;p<g;p++){const _=f[p],y=s[p];0!==_&&(E_.fromBufferAttribute(y,c),T_.fromBufferAttribute(y,u),D_.fromBufferAttribute(y,d),o?(th.addScaledVector(E_,_),nh.addScaledVector(T_,_),ih.addScaledVector(D_,_)):(th.addScaledVector(E_.sub(Ds),_),nh.addScaledVector(T_.sub(Cs),_),ih.addScaledVector(D_.sub(As),_)))}Ds.add(th),Cs.add(nh),As.add(ih)}n.isSkinnedMesh&&(n.boneTransform(c,Ds),n.boneTransform(u,Cs),n.boneTransform(d,As));const h=function vG(n,e,t,i,r,s,o,a){let l;if(l=e.side===on?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,e.side!==po,a),null===l)return null;ah.copy(a),ah.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(ah);return c<t.near||c>t.far?null:{distance:c,point:ah.clone(),object:n}}(n,e,t,i,Ds,Cs,As,C_);if(h){a&&(rh.fromBufferAttribute(a,c),sh.fromBufferAttribute(a,u),oh.fromBufferAttribute(a,d),h.uv=ln.getUV(C_,Ds,Cs,As,rh,sh,oh,new X)),l&&(rh.fromBufferAttribute(l,c),sh.fromBufferAttribute(l,u),oh.fromBufferAttribute(l,d),h.uv2=ln.getUV(C_,Ds,Cs,As,rh,sh,oh,new X));const p={a:c,b:u,c:d,normal:new E,materialIndex:0};ln.getNormal(Ds,Cs,As,p.normal),h.face=p}return h}_n.prototype.isMesh=!0;class Ao extends Te{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let f=0,h=0;function p(g,_,y,m,x,v,w,M,T,C,R){const P=v/T,b=w/C,I=v/2,L=w/2,F=M/2,O=T+1,B=C+1;let U=0,k=0;const j=new E;for(let J=0;J<B;J++){const Q=J*b-L;for(let ee=0;ee<O;ee++)j[g]=(ee*P-I)*m,j[_]=Q*x,j[y]=F,c.push(j.x,j.y,j.z),j[g]=0,j[_]=0,j[y]=M>0?1:-1,u.push(j.x,j.y,j.z),d.push(ee/T),d.push(1-J/C),U+=1}for(let J=0;J<C;J++)for(let Q=0;Q<T;Q++){const be=f+Q+O*(J+1),He=f+(Q+1)+O*(J+1),we=f+(Q+1)+O*J;l.push(f+Q+O*J,be,we),l.push(be,He,we),k+=6}a.addGroup(h,k,R),h+=k,f+=U}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new ge(c,3)),this.setAttribute("normal",new ge(u,3)),this.setAttribute("uv",new ge(d,2))}static fromJSON(e){return new Ao(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ul(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function On(n){const e={};for(let t=0;t<n.length;t++){const i=ul(n[t]);for(const r in i)e[r]=i[r]}return e}const xG={clone:ul,merge:On};class Qi extends kt{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ul(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}Qi.prototype.isShaderMaterial=!0;class ch extends ut{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new me,this.projectionMatrix=new me,this.projectionMatrixInverse=new me}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}ch.prototype.isCamera=!0;class Bt extends ch{constructor(e=50,t=1,i=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Kc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*bo*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Kc*Math.atan(Math.tan(.5*bo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*bo*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}Bt.prototype.isPerspectiveCamera=!0;class A_ extends ut{constructor(e,t,i){if(super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const r=new Bt(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new E(1,0,0)),this.add(r);const s=new Bt(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new E(-1,0,0)),this.add(s);const o=new Bt(90,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new E(0,1,0)),this.add(o);const a=new Bt(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new E(0,-1,0)),this.add(a);const l=new Bt(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new E(0,0,1)),this.add(l);const c=new Bt(90,1,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new E(0,0,-1)),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.xr.enabled,d=e.getRenderTarget();e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(d),e.xr.enabled=u,i.texture.needsPMREMUpdate=!0}}class ru extends Fn{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:mo,i,r,s,o,a,l,c,u),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}ru.prototype.isCubeTexture=!0;class I_ extends ai{constructor(e,t={}){super(e,e,t);const i={width:e,height:e,depth:1};this.texture=new ru([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Rt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=Xn,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Ao(5,5,5),s=new Qi({name:"CubemapFromEquirect",uniforms:ul(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:on,blending:ys});s.uniforms.tEquirect.value=t;const o=new _n(r,s),a=t.minFilter;return t.minFilter===vs&&(t.minFilter=Rt),new A_(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}I_.prototype.isWebGLCubeRenderTarget=!0;const R_=new E,MG=new E,SG=new xn;class Xr{constructor(e=new E(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=R_.subVectors(i,t).cross(MG.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(R_),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||SG.getNormalMatrix(e),r=this.coplanarPoint(R_).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Xr.prototype.isPlane=!0;const hl=new Ss,uh=new E;class dh{constructor(e=new Xr,t=new Xr,i=new Xr,r=new Xr,s=new Xr,o=new Xr){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7],f=i[8],h=i[9],p=i[10],g=i[11],_=i[12],y=i[13],m=i[14],x=i[15];return t[0].setComponents(a-r,d-l,g-f,x-_).normalize(),t[1].setComponents(a+r,d+l,g+f,x+_).normalize(),t[2].setComponents(a+s,d+c,g+h,x+y).normalize(),t[3].setComponents(a-s,d-c,g-h,x-y).normalize(),t[4].setComponents(a-o,d-u,g-p,x-m).normalize(),t[5].setComponents(a+o,d+u,g+p,x+m).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),hl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(hl)}intersectsSprite(e){return hl.center.set(0,0,0),hl.radius=.7071067811865476,hl.applyMatrix4(e.matrixWorld),this.intersectsSphere(hl)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(uh.x=r.normal.x>0?e.max.x:e.min.x,uh.y=r.normal.y>0?e.max.y:e.min.y,uh.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(uh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function e1(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function EG(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const f=i.get(c);return void((!f||f.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,f=c.usage,h=n.createBuffer();let p;if(n.bindBuffer(u,h),n.bufferData(u,d,f),c.onUploadCallback(),d instanceof Float32Array)p=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=5131}else p=5123;else if(d instanceof Int16Array)p=5122;else if(d instanceof Uint32Array)p=5125;else if(d instanceof Int32Array)p=5124;else if(d instanceof Int8Array)p=5120;else if(d instanceof Uint8Array)p=5121;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);p=5121}return{buffer:h,type:p,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const f=u.array,h=u.updateRange;n.bindBuffer(d,c),-1===h.count?n.bufferSubData(d,0,f):(t?n.bufferSubData(d,h.offset*f.BYTES_PER_ELEMENT,f,h.offset,h.count):n.bufferSubData(d,h.offset*f.BYTES_PER_ELEMENT,f.subarray(h.offset,h.offset+h.count)),h.count=-1)}(d.buffer,c,u),d.version=c.version)}}}class su extends Te{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,f=t/l,h=[],p=[],g=[],_=[];for(let y=0;y<u;y++){const m=y*f-o;for(let x=0;x<c;x++)p.push(x*d-s,-m,0),g.push(0,0,1),_.push(x/a),_.push(1-y/l)}for(let y=0;y<l;y++)for(let m=0;m<a;m++){const v=m+c*(y+1),w=m+1+c*(y+1),M=m+1+c*y;h.push(m+c*y,v,M),h.push(v,w,M)}this.setIndex(h),this.setAttribute("position",new ge(p,3)),this.setAttribute("normal",new ge(g,3)),this.setAttribute("uv",new ge(_,2))}static fromJSON(e){return new su(e.width,e.height,e.widthSegments,e.heightSegments)}}const Je={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ]\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tfloat texelIndex = float( vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},oe={common:{diffuse:{value:new re(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new xn},uv2Transform:{value:new xn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new X(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new re(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new re(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new xn}},sprite:{diffuse:{value:new re(16777215)},opacity:{value:1},center:{value:new X(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new xn}}},yr={basic:{uniforms:On([oe.common,oe.specularmap,oe.envmap,oe.aomap,oe.lightmap,oe.fog]),vertexShader:Je.meshbasic_vert,fragmentShader:Je.meshbasic_frag},lambert:{uniforms:On([oe.common,oe.specularmap,oe.envmap,oe.aomap,oe.lightmap,oe.emissivemap,oe.fog,oe.lights,{emissive:{value:new re(0)}}]),vertexShader:Je.meshlambert_vert,fragmentShader:Je.meshlambert_frag},phong:{uniforms:On([oe.common,oe.specularmap,oe.envmap,oe.aomap,oe.lightmap,oe.emissivemap,oe.bumpmap,oe.normalmap,oe.displacementmap,oe.fog,oe.lights,{emissive:{value:new re(0)},specular:{value:new re(1118481)},shininess:{value:30}}]),vertexShader:Je.meshphong_vert,fragmentShader:Je.meshphong_frag},standard:{uniforms:On([oe.common,oe.envmap,oe.aomap,oe.lightmap,oe.emissivemap,oe.bumpmap,oe.normalmap,oe.displacementmap,oe.roughnessmap,oe.metalnessmap,oe.fog,oe.lights,{emissive:{value:new re(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Je.meshphysical_vert,fragmentShader:Je.meshphysical_frag},toon:{uniforms:On([oe.common,oe.aomap,oe.lightmap,oe.emissivemap,oe.bumpmap,oe.normalmap,oe.displacementmap,oe.gradientmap,oe.fog,oe.lights,{emissive:{value:new re(0)}}]),vertexShader:Je.meshtoon_vert,fragmentShader:Je.meshtoon_frag},matcap:{uniforms:On([oe.common,oe.bumpmap,oe.normalmap,oe.displacementmap,oe.fog,{matcap:{value:null}}]),vertexShader:Je.meshmatcap_vert,fragmentShader:Je.meshmatcap_frag},points:{uniforms:On([oe.points,oe.fog]),vertexShader:Je.points_vert,fragmentShader:Je.points_frag},dashed:{uniforms:On([oe.common,oe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Je.linedashed_vert,fragmentShader:Je.linedashed_frag},depth:{uniforms:On([oe.common,oe.displacementmap]),vertexShader:Je.depth_vert,fragmentShader:Je.depth_frag},normal:{uniforms:On([oe.common,oe.bumpmap,oe.normalmap,oe.displacementmap,{opacity:{value:1}}]),vertexShader:Je.meshnormal_vert,fragmentShader:Je.meshnormal_frag},sprite:{uniforms:On([oe.sprite,oe.fog]),vertexShader:Je.sprite_vert,fragmentShader:Je.sprite_frag},background:{uniforms:{uvTransform:{value:new xn},t2D:{value:null}},vertexShader:Je.background_vert,fragmentShader:Je.background_frag},cube:{uniforms:On([oe.envmap,{opacity:{value:1}}]),vertexShader:Je.cube_vert,fragmentShader:Je.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Je.equirect_vert,fragmentShader:Je.equirect_frag},distanceRGBA:{uniforms:On([oe.common,oe.displacementmap,{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Je.distanceRGBA_vert,fragmentShader:Je.distanceRGBA_frag},shadow:{uniforms:On([oe.lights,oe.fog,{color:{value:new re(0)},opacity:{value:1}}]),vertexShader:Je.shadow_vert,fragmentShader:Je.shadow_frag}};function w5(n,e,t,i,r,s){const o=new re(0);let l,c,a=!0===r?0:1,u=null,d=0,f=null;function p(g,_){t.buffers.color.setClear(g.r,g.g,g.b,_,s)}return{getClearColor:function(){return o},setClearColor:function(g,_=1){o.set(g),a=_,p(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(g){a=g,p(o,a)},render:function h(g,_){let y=!1,m=!0===_.isScene?_.background:null;m&&m.isTexture&&(m=e.get(m));const x=n.xr,v=x.getSession&&x.getSession();v&&"additive"===v.environmentBlendMode&&(m=null),null===m?p(o,a):m&&m.isColor&&(p(m,1),y=!0),(n.autoClear||y)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),m&&(m.isCubeTexture||m.mapping===jc)?(void 0===c&&(c=new _n(new Ao(1,1,1),new Qi({name:"BackgroundCubeMaterial",uniforms:ul(yr.cube.uniforms),vertexShader:yr.cube.vertexShader,fragmentShader:yr.cube.fragmentShader,side:on,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(w,M,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=m,c.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,(u!==m||d!==m.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,u=m,d=m.version,f=n.toneMapping),g.unshift(c,c.geometry,c.material,0,0,null)):m&&m.isTexture&&(void 0===l&&(l=new _n(new su(2,2),new Qi({name:"BackgroundMaterial",uniforms:ul(yr.background.uniforms),vertexShader:yr.background.vertexShader,fragmentShader:yr.background.fragmentShader,side:ho,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),l.material.uniforms.uvTransform.value.copy(m.matrix),(u!==m||d!==m.version||f!==n.toneMapping)&&(l.material.needsUpdate=!0,u=m,d=m.version,f=n.toneMapping),g.unshift(l,l.geometry,l.material,0,0,null))}}}function b5(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=g(null);let c=l;function f(L){return i.isWebGL2?n.bindVertexArray(L):s.bindVertexArrayOES(L)}function h(L){return i.isWebGL2?n.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function g(L){const F=[],O=[],B=[];for(let U=0;U<r;U++)F[U]=0,O[U]=0,B[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:O,attributeDivisors:B,object:L,attributes:{},index:null}}function m(){const L=c.newAttributes;for(let F=0,O=L.length;F<O;F++)L[F]=0}function x(L){v(L,0)}function v(L,F){const B=c.enabledAttributes,U=c.attributeDivisors;c.newAttributes[L]=1,0===B[L]&&(n.enableVertexAttribArray(L),B[L]=1),U[L]!==F&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,F),U[L]=F)}function w(){const L=c.newAttributes,F=c.enabledAttributes;for(let O=0,B=F.length;O<B;O++)F[O]!==L[O]&&(n.disableVertexAttribArray(O),F[O]=0)}function M(L,F,O,B,U,k){!0!==i.isWebGL2||5124!==O&&5125!==O?n.vertexAttribPointer(L,F,O,B,U,k):n.vertexAttribIPointer(L,F,O,U,k)}function b(){I(),c!==l&&(c=l,f(c.object))}function I(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function u(L,F,O,B,U){let k=!1;if(o){const j=function p(L,F,O){const B=!0===O.wireframe;let U=a[L.id];void 0===U&&(U={},a[L.id]=U);let k=U[F.id];void 0===k&&(k={},U[F.id]=k);let j=k[B];return void 0===j&&(j=g(function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),k[B]=j),j}(B,O,F);c!==j&&(c=j,f(c.object)),k=function _(L,F){const O=c.attributes,B=L.attributes;let U=0;for(const k in B){const j=O[k],J=B[k];if(void 0===j||j.attribute!==J||j.data!==J.data)return!0;U++}return c.attributesNum!==U||c.index!==F}(B,U),k&&function y(L,F){const O={},B=L.attributes;let U=0;for(const k in B){const j=B[k],J={};J.attribute=j,j.data&&(J.data=j.data),O[k]=J,U++}c.attributes=O,c.attributesNum=U,c.index=F}(B,U)}else{const j=!0===F.wireframe;(c.geometry!==B.id||c.program!==O.id||c.wireframe!==j)&&(c.geometry=B.id,c.program=O.id,c.wireframe=j,k=!0)}!0===L.isInstancedMesh&&(k=!0),null!==U&&t.update(U,34963),k&&(function T(L,F,O,B){if(!1===i.isWebGL2&&(L.isInstancedMesh||B.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;m();const U=B.attributes,k=O.getAttributes(),j=F.defaultAttributeValues;for(const J in k){const Q=k[J];if(Q.location>=0){let ee=U[J];if(void 0===ee&&("instanceMatrix"===J&&L.instanceMatrix&&(ee=L.instanceMatrix),"instanceColor"===J&&L.instanceColor&&(ee=L.instanceColor)),void 0!==ee){const be=ee.normalized,He=ee.itemSize,we=t.get(ee);if(void 0===we)continue;const Z=we.buffer,dt=we.type,$e=we.bytesPerElement;if(ee.isInterleavedBufferAttribute){const _e=ee.data,ve=_e.stride,nt=ee.offset;if(_e.isInstancedInterleavedBuffer){for(let z=0;z<Q.locationSize;z++)v(Q.location+z,_e.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===B._maxInstanceCount&&(B._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let z=0;z<Q.locationSize;z++)x(Q.location+z);n.bindBuffer(34962,Z);for(let z=0;z<Q.locationSize;z++)M(Q.location+z,He/Q.locationSize,dt,be,ve*$e,(nt+He/Q.locationSize*z)*$e)}else{if(ee.isInstancedBufferAttribute){for(let _e=0;_e<Q.locationSize;_e++)v(Q.location+_e,ee.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===B._maxInstanceCount&&(B._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let _e=0;_e<Q.locationSize;_e++)x(Q.location+_e);n.bindBuffer(34962,Z);for(let _e=0;_e<Q.locationSize;_e++)M(Q.location+_e,He/Q.locationSize,dt,be,He*$e,He/Q.locationSize*_e*$e)}}else if(void 0!==j){const be=j[J];if(void 0!==be)switch(be.length){case 2:n.vertexAttrib2fv(Q.location,be);break;case 3:n.vertexAttrib3fv(Q.location,be);break;case 4:n.vertexAttrib4fv(Q.location,be);break;default:n.vertexAttrib1fv(Q.location,be)}}}}w()}(L,F,O,B),null!==U&&n.bindBuffer(34963,t.get(U).buffer))},reset:b,resetDefaultState:I,dispose:function C(){b();for(const L in a){const F=a[L];for(const O in F){const B=F[O];for(const U in B)h(B[U].object),delete B[U];delete F[O]}delete a[L]}},releaseStatesOfGeometry:function R(L){if(void 0===a[L.id])return;const F=a[L.id];for(const O in F){const B=F[O];for(const U in B)h(B[U].object),delete B[U];delete F[O]}delete a[L.id]},releaseStatesOfProgram:function P(L){for(const F in a){const O=a[F];if(void 0===O[L.id])continue;const B=O[L.id];for(const U in B)h(B[U].object),delete B[U];delete O[L.id]}},initAttributes:m,enableAttribute:x,disableUnusedAttributes:w}}function M5(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let f,h;if(r)f=n,h="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),h="drawArraysInstancedANGLE",null===f)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");f[h](s,c,u,d),t.update(u,s,d)}}function S5(n,e,t){let i;function s(T){if("highp"===T){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return"mediump"===T&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(34930),f=n.getParameter(35660),h=n.getParameter(3379),p=n.getParameter(34076),g=n.getParameter(34921),_=n.getParameter(36347),y=n.getParameter(36348),m=n.getParameter(36349),x=f>0,v=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const T=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:f,maxTextureSize:h,maxCubemapSize:p,maxAttributes:g,maxVertexUniforms:_,maxVaryings:y,maxFragmentUniforms:m,vertexTextures:x,floatFragmentTextures:v,floatVertexTextures:x&&v,maxSamples:o?n.getParameter(36183):0}}function E5(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Xr,a=new xn,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(d,f,h,p){const g=null!==d?d.length:0;let _=null;if(0!==g){if(_=l.value,!0!==p||null===_){const y=h+4*g,m=f.matrixWorldInverse;a.getNormalMatrix(m),(null===_||_.length<y)&&(_=new Float32Array(y));for(let x=0,v=h;x!==g;++x,v+=4)o.copy(d[x]).applyMatrix4(m,a),o.normal.toArray(_,v),_[v+3]=o.constant}l.value=_,l.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,_}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,f,h){const p=0!==d.length||f||0!==i||r;return r=f,t=u(d,h,0),i=d.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(d,f,h){const p=d.clippingPlanes,g=d.clipIntersection,_=d.clipShadows,y=n.get(d);if(!r||null===p||0===p.length||s&&!_)s?u(null):c();else{const m=s?0:i,x=4*m;let v=y.clippingState||null;l.value=v,v=u(p,f,x,h);for(let w=0;w!==x;++w)v[w]=t[w];y.clippingState=v,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=m}}}function T5(n){let e=new WeakMap;function t(o,a){return a===Of?o.mapping=mo:a===kf&&(o.mapping=go),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===Of||a===kf){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new I_(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}yr.physical={uniforms:On([yr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new X(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new re(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new X},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new re(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new re(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Je.meshphysical_vert,fragmentShader:Je.meshphysical_frag};class ou extends ch{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}ou.prototype.isOrthographicCamera=!0;const t1=[.125,.215,.35,.446,.526,.582],P_=new ou,n1=new re;let L_=null;const Ro=(1+Math.sqrt(5))/2,ml=1/Ro,i1=[new E(1,1,1),new E(-1,1,1),new E(1,1,-1),new E(-1,1,-1),new E(0,Ro,ml),new E(0,Ro,-ml),new E(ml,0,Ro),new E(-ml,0,Ro),new E(Ro,ml,0),new E(-Ro,ml,0)];class r1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){L_=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=a1(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=o1(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(L_),e.scissorTest=!1,fh(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===mo||e.mapping===go?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),L_=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize-32,i={magFilter:Rt,minFilter:Rt,generateMipmaps:!1,type:ja,format:Xn,encoding:ws,depthBuffer:!1},r=s1(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=s1(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function D5(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+t1.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=t1[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-1),u=-c/2,d=1+c/2,f=[u,u,d,u,d,d,u,u,d,d,u,d],h=6,p=6,g=3,_=2,y=1,m=new Float32Array(g*p*h),x=new Float32Array(_*p*h),v=new Float32Array(y*p*h);for(let M=0;M<h;M++){const T=M%3*2/3-1,C=M>2?0:-1;m.set([T,C,0,T+2/3,C,0,T+2/3,C+1,0,T,C,0,T+2/3,C+1,0,T,C+1,0],g*p*M),x.set(f,_*p*M),v.set([M,M,M,M,M,M],y*p*M)}const w=new Te;w.setAttribute("position",new yt(m,g)),w.setAttribute("uv",new yt(x,_)),w.setAttribute("faceIndex",new yt(v,y)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function C5(n,e,t){const i=new Float32Array(20),r=new E(0,1,0);return new Qi({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:ys,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new _n(this._lodPlanes[0],e);this._renderer.compile(t,P_)}_sceneToCubeUV(e,t,i,r){const a=new Bt(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,f=u.toneMapping;u.getClearColor(n1),u.toneMapping=_s,u.autoClear=!1;const h=new bi({name:"PMREM.Background",side:on,depthWrite:!1,depthTest:!1}),p=new _n(new Ao,h);let g=!1;const _=e.background;_?_.isColor&&(h.color.copy(_),e.background=null,g=!0):(h.color.copy(n1),g=!0);for(let y=0;y<6;y++){const m=y%3;0===m?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===m?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const x=this._cubeSize;fh(r,m*x,y>2?x:0,x,x),u.setRenderTarget(r),g&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=f,u.autoClear=d,e.background=_}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===mo||e.mapping===go;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=a1()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=o1());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new _n(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;fh(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,P_)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,i1[(r-1)%i1.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new _n(this._lodPlanes[r],c),f=c.uniforms,h=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*h):2*Math.PI/39,g=s/p,_=isFinite(s)?1+Math.floor(3*g):20;_>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to 20`);const y=[];let m=0;for(let T=0;T<20;++T){const C=T/g,R=Math.exp(-C*C/2);y.push(R),0===T?m+=R:T<_&&(m+=2*R)}for(let T=0;T<y.length;T++)y[T]=y[T]/m;f.envMap.value=e.texture,f.samples.value=_,f.weights.value=y,f.latitudinal.value="latitudinal"===o,a&&(f.poleAxis.value=a);const{_lodMax:x}=this;f.dTheta.value=p,f.mipInt.value=x-i;const v=this._sizeLods[r];fh(t,3*v*(r>x-4?r-x+4:0),4*(this._cubeSize-v),3*v,2*v),l.setRenderTarget(t),l.render(d,P_)}}function s1(n,e,t){const i=new ai(n,e,t);return i.texture.mapping=jc,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function fh(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function o1(){return new Qi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:ys,depthTest:!1,depthWrite:!1})}function a1(){return new Qi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:ys,depthTest:!1,depthWrite:!1})}function A5(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===Of||l===kf,u=l===mo||l===go;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new r1(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new r1(n));const f=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,f),a.addEventListener("dispose",s),f.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function I5(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function R5(n,e,t,i){const r={},s=new WeakMap;function o(d){const f=d.target;null!==f.index&&e.remove(f.index);for(const p in f.attributes)e.remove(f.attributes[p]);f.removeEventListener("dispose",o),delete r[f.id];const h=s.get(f);h&&(e.remove(h),s.delete(f)),i.releaseStatesOfGeometry(f),!0===f.isInstancedBufferGeometry&&delete f._maxInstanceCount,t.memory.geometries--}function c(d){const f=[],h=d.index,p=d.attributes.position;let g=0;if(null!==h){const m=h.array;g=h.version;for(let x=0,v=m.length;x<v;x+=3){const w=m[x+0],M=m[x+1],T=m[x+2];f.push(w,M,M,T,T,w)}}else{g=p.version;for(let x=0,v=p.array.length/3-1;x<v;x+=3){const w=x+0,M=x+1,T=x+2;f.push(w,M,M,T,T,w)}}const _=new(VD(f)?b_:w_)(f,1);_.version=g;const y=s.get(d);y&&e.remove(y),s.set(d,_)}return{get:function a(d,f){return!0===r[f.id]||(f.addEventListener("dispose",o),r[f.id]=!0,t.memory.geometries++),f},update:function l(d){const f=d.attributes;for(const p in f)e.update(f[p],34962);const h=d.morphAttributes;for(const p in h){const g=h[p];for(let _=0,y=g.length;_<y;_++)e.update(g[_],34962)}},getWireframeAttribute:function u(d){const f=s.get(d);if(f){const h=d.index;null!==h&&f.version<h.version&&c(d)}else c(d);return s.get(d)}}}function P5(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(f){s=f},this.setIndex=function c(f){a=f.type,l=f.bytesPerElement},this.render=function u(f,h){n.drawElements(s,h,a,f*l),t.update(h,s,1)},this.renderInstances=function d(f,h,p){if(0===p)return;let g,_;if(r)g=n,_="drawElementsInstanced";else if(g=e.get("ANGLE_instanced_arrays"),_="drawElementsInstancedANGLE",null===g)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g[_](s,h,a,f*l,p),t.update(h,s,p)}}function L5(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function N5(n,e){return n[0]-e[0]}function F5(n,e){return Math.abs(e[1])-Math.abs(n[1])}function F_(n,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),n.divideScalar(t)}function O5(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new gt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d,f){const h=c.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,g=void 0!==p?p.length:0;let _=s.get(u);if(void 0===_||_.count!==g){let O=function(){L.dispose(),s.delete(u),u.removeEventListener("dispose",O)};void 0!==_&&_.texture.dispose();const x=void 0!==u.morphAttributes.position,v=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,M=u.morphAttributes.position||[],T=u.morphAttributes.normal||[],C=u.morphAttributes.color||[];let R=0;!0===x&&(R=1),!0===v&&(R=2),!0===w&&(R=3);let P=u.attributes.position.count*R,b=1;P>e.maxTextureSize&&(b=Math.ceil(P/e.maxTextureSize),P=e.maxTextureSize);const I=new Float32Array(P*b*4*g),L=new eu(I,P,b,g);L.format=Xn,L.type=xs,L.needsUpdate=!0;const F=4*R;for(let B=0;B<g;B++){const U=M[B],k=T[B],j=C[B],J=P*b*4*B;for(let Q=0;Q<U.count;Q++){const ee=Q*F;!0===x&&(o.fromBufferAttribute(U,Q),!0===U.normalized&&F_(o,U),I[J+ee+0]=o.x,I[J+ee+1]=o.y,I[J+ee+2]=o.z,I[J+ee+3]=0),!0===v&&(o.fromBufferAttribute(k,Q),!0===k.normalized&&F_(o,k),I[J+ee+4]=o.x,I[J+ee+5]=o.y,I[J+ee+6]=o.z,I[J+ee+7]=0),!0===w&&(o.fromBufferAttribute(j,Q),!0===j.normalized&&F_(o,k),I[J+ee+8]=o.x,I[J+ee+9]=o.y,I[J+ee+10]=o.z,I[J+ee+11]=4===j.itemSize?o.w:1)}}_={count:g,texture:L,size:new X(P,b)},s.set(u,_),u.addEventListener("dispose",O)}let y=0;for(let x=0;x<h.length;x++)y+=h[x];const m=u.morphTargetsRelative?1:1-y;f.getUniforms().setValue(n,"morphTargetBaseInfluence",m),f.getUniforms().setValue(n,"morphTargetInfluences",h),f.getUniforms().setValue(n,"morphTargetsTexture",_.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",_.size)}else{const p=void 0===h?0:h.length;let g=i[u.id];if(void 0===g||g.length!==p){g=[];for(let v=0;v<p;v++)g[v]=[v,0];i[u.id]=g}for(let v=0;v<p;v++){const w=g[v];w[0]=v,w[1]=h[v]}g.sort(F5);for(let v=0;v<8;v++)v<p&&g[v][1]?(a[v][0]=g[v][0],a[v][1]=g[v][1]):(a[v][0]=Number.MAX_SAFE_INTEGER,a[v][1]=0);a.sort(N5);const _=u.morphAttributes.position,y=u.morphAttributes.normal;let m=0;for(let v=0;v<8;v++){const w=a[v],M=w[0],T=w[1];M!==Number.MAX_SAFE_INTEGER&&T?(_&&u.getAttribute("morphTarget"+v)!==_[M]&&u.setAttribute("morphTarget"+v,_[M]),y&&u.getAttribute("morphNormal"+v)!==y[M]&&u.setAttribute("morphNormal"+v,y[M]),r[v]=T,m+=T):(_&&!0===u.hasAttribute("morphTarget"+v)&&u.deleteAttribute("morphTarget"+v),y&&!0===u.hasAttribute("morphNormal"+v)&&u.deleteAttribute("morphNormal"+v),r[v]=0)}const x=u.morphTargetsRelative?1:1-m;f.getUniforms().setValue(n,"morphTargetBaseInfluence",x),f.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function k5(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);return r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),d},dispose:function o(){r=new WeakMap}}}const l1=new Fn,c1=new eu,u1=new $f,d1=new ru,f1=[],h1=[],p1=new Float32Array(16),m1=new Float32Array(9),g1=new Float32Array(4);function gl(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=f1[r];if(void 0===s&&(s=new Float32Array(r),f1[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Yn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function kn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function hh(n,e){let t=h1[e];void 0===t&&(t=new Int32Array(e),h1[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function B5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function H5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Yn(t,e))return;n.uniform2fv(this.addr,e),kn(t,e)}}function U5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Yn(t,e))return;n.uniform3fv(this.addr,e),kn(t,e)}}function V5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Yn(t,e))return;n.uniform4fv(this.addr,e),kn(t,e)}}function z5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Yn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),kn(t,e)}else{if(Yn(t,i))return;g1.set(i),n.uniformMatrix2fv(this.addr,!1,g1),kn(t,i)}}function G5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Yn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),kn(t,e)}else{if(Yn(t,i))return;m1.set(i),n.uniformMatrix3fv(this.addr,!1,m1),kn(t,i)}}function W5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Yn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),kn(t,e)}else{if(Yn(t,i))return;p1.set(i),n.uniformMatrix4fv(this.addr,!1,p1),kn(t,i)}}function j5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function $5(n,e){const t=this.cache;Yn(t,e)||(n.uniform2iv(this.addr,e),kn(t,e))}function q5(n,e){const t=this.cache;Yn(t,e)||(n.uniform3iv(this.addr,e),kn(t,e))}function X5(n,e){const t=this.cache;Yn(t,e)||(n.uniform4iv(this.addr,e),kn(t,e))}function Y5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Z5(n,e){const t=this.cache;Yn(t,e)||(n.uniform2uiv(this.addr,e),kn(t,e))}function K5(n,e){const t=this.cache;Yn(t,e)||(n.uniform3uiv(this.addr,e),kn(t,e))}function J5(n,e){const t=this.cache;Yn(t,e)||(n.uniform4uiv(this.addr,e),kn(t,e))}function Q5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||l1,r)}function eW(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||u1,r)}function tW(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||d1,r)}function nW(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||c1,r)}function rW(n,e){n.uniform1fv(this.addr,e)}function sW(n,e){const t=gl(e,this.size,2);n.uniform2fv(this.addr,t)}function oW(n,e){const t=gl(e,this.size,3);n.uniform3fv(this.addr,t)}function aW(n,e){const t=gl(e,this.size,4);n.uniform4fv(this.addr,t)}function lW(n,e){const t=gl(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function cW(n,e){const t=gl(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function uW(n,e){const t=gl(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function dW(n,e){n.uniform1iv(this.addr,e)}function fW(n,e){n.uniform2iv(this.addr,e)}function hW(n,e){n.uniform3iv(this.addr,e)}function pW(n,e){n.uniform4iv(this.addr,e)}function mW(n,e){n.uniform1uiv(this.addr,e)}function gW(n,e){n.uniform2uiv(this.addr,e)}function yW(n,e){n.uniform3uiv(this.addr,e)}function _W(n,e){n.uniform4uiv(this.addr,e)}function vW(n,e,t){const i=e.length,r=hh(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2D(e[s]||l1,r[s])}function xW(n,e,t){const i=e.length,r=hh(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture3D(e[s]||u1,r[s])}function wW(n,e,t){const i=e.length,r=hh(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTextureCube(e[s]||d1,r[s])}function bW(n,e,t){const i=e.length,r=hh(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2DArray(e[s]||c1,r[s])}function SW(n,e,t){this.id=n,this.addr=t,this.cache=[],this.setValue=function iW(n){switch(n){case 5126:return B5;case 35664:return H5;case 35665:return U5;case 35666:return V5;case 35674:return z5;case 35675:return G5;case 35676:return W5;case 5124:case 35670:return j5;case 35667:case 35671:return $5;case 35668:case 35672:return q5;case 35669:case 35673:return X5;case 5125:return Y5;case 36294:return Z5;case 36295:return K5;case 36296:return J5;case 35678:case 36198:case 36298:case 36306:case 35682:return Q5;case 35679:case 36299:case 36307:return eW;case 35680:case 36300:case 36308:case 36293:return tW;case 36289:case 36303:case 36311:case 36292:return nW}}(e.type)}function y1(n,e,t){this.id=n,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function MW(n){switch(n){case 5126:return rW;case 35664:return sW;case 35665:return oW;case 35666:return aW;case 35674:return lW;case 35675:return cW;case 35676:return uW;case 5124:case 35670:return dW;case 35667:case 35671:return fW;case 35668:case 35672:return hW;case 35669:case 35673:return pW;case 5125:return mW;case 36294:return gW;case 36295:return yW;case 36296:return _W;case 35678:case 36198:case 36298:case 36306:case 35682:return vW;case 35679:case 36299:case 36307:return xW;case 35680:case 36300:case 36308:case 36293:return wW;case 36289:case 36303:case 36311:case 36292:return bW}}(e.type)}function _1(n){this.id=n,this.seq=[],this.map={}}y1.prototype.updateCache=function(n){const e=this.cache;n instanceof Float32Array&&e.length!==n.length&&(this.cache=new Float32Array(n.length)),kn(e,n)},_1.prototype.setValue=function(n,e,t){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const o=i[r];o.setValue(n,e[o.id],t)}};const O_=/(\w+)(\])?(\[|\.)?/g;function v1(n,e){n.seq.push(e),n.map[e.id]=e}function EW(n,e,t){const i=n.name,r=i.length;for(O_.lastIndex=0;;){const s=O_.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&O_.lastIndex+2===r){v1(t,void 0===c?new SW(a,n,e):new y1(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new _1(a),v1(t,d)),t=d}}}function Is(n,e){this.seq=[],this.map={};const t=n.getProgramParameter(e,35718);for(let i=0;i<t;++i){const r=n.getActiveUniform(e,i);EW(r,n.getUniformLocation(e,r.name),this)}}function x1(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}Is.prototype.setValue=function(n,e,t,i){const r=this.map[e];void 0!==r&&r.setValue(n,t,i)},Is.prototype.setOptional=function(n,e,t){const i=e[t];void 0!==i&&this.setValue(n,t,i)},Is.upload=function(n,e,t,i){for(let r=0,s=e.length;r!==s;++r){const o=e[r],a=t[o.id];!1!==a.needsUpdate&&o.setValue(n,a.value,i)}},Is.seqWithValue=function(n,e){const t=[];for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.id in e&&t.push(s)}return t};let TW=0;function w1(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();return i&&""===r?"":t.toUpperCase()+"\n\n"+r+"\n\n"+function DW(n){const e=n.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(n.getShaderSource(e))}function AW(n,e){const t=function CW(n){switch(n){case ws:return["Linear","( value )"];case xt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function IW(n,e){let t;switch(e){case cz:t="Linear";break;case uz:t="Reinhard";break;case dz:t="OptimizedCineon";break;case fz:t="ACESFilmic";break;case hz:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function au(n){return""!==n}function b1(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function M1(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const NW=/^[ \t]*#include +<([\w\d./]+)>/gm;function k_(n){return n.replace(NW,FW)}function FW(n,e){const t=Je[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return k_(t)}const OW=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,kW=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function S1(n){return n.replace(kW,E1).replace(OW,BW)}function BW(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),E1(0,e,t,i)}function E1(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function T1(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function WW(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function HW(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===aD?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===VV?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Wc&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function UW(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case mo:case go:e="ENVMAP_TYPE_CUBE";break;case jc:case Bf:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function VW(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case go:case Bf:e="ENVMAP_MODE_REFRACTION"}return e}(t),d=function zW(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Ff:e="ENVMAP_BLENDING_MULTIPLY";break;case az:e="ENVMAP_BLENDING_MIX";break;case lz:e="ENVMAP_BLENDING_ADD"}return e}(t),f=function GW(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e/32+1)+3,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),h=t.isWebGL2?"":function RW(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(au).join("\n")}(t),p=function PW(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),g=r.createProgram();let _,y,m=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(_=[p].filter(au).join("\n"),_.length>0&&(_+="\n"),y=[h,p].filter(au).join("\n"),y.length>0&&(y+="\n")):(_=[T1(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(au).join("\n"),y=[h,T1(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==_s?"#define TONE_MAPPING":"",t.toneMapping!==_s?Je.tonemapping_pars_fragment:"",t.toneMapping!==_s?IW("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Je.encodings_pars_fragment,AW("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(au).join("\n")),o=k_(o),o=b1(o,t),o=M1(o,t),a=k_(a),a=b1(a,t),a=M1(a,t),o=S1(o),a=S1(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(m="#version 300 es\n",_=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+_,y=["#define varying in",t.glslVersion===HD?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===HD?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const v=m+y+a,w=x1(r,35633,m+_+o),M=x1(r,35632,v);if(r.attachShader(g,w),r.attachShader(g,M),void 0!==t.index0AttributeName?r.bindAttribLocation(g,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g),n.debug.checkShaderErrors){const R=r.getProgramInfoLog(g).trim(),P=r.getShaderInfoLog(w).trim(),b=r.getShaderInfoLog(M).trim();let I=!0,L=!0;if(!1===r.getProgramParameter(g,35714)){I=!1;const F=w1(r,w,"vertex"),O=w1(r,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,35715)+"\n\nProgram Info Log: "+R+"\n"+F+"\n"+O)}else""!==R?console.warn("THREE.WebGLProgram: Program Info Log:",R):(""===P||""===b)&&(L=!1);L&&(this.diagnostics={runnable:I,programLog:R,vertexShader:{log:P,prefix:_},fragmentShader:{log:b,prefix:y}})}let T,C;return r.deleteShader(w),r.deleteShader(M),this.getUniforms=function(){return void 0===T&&(T=new Is(r,g)),T},this.getAttributes=function(){return void 0===C&&(C=function LW(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,g)),C},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.name=t.shaderName,this.id=TW++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=M,this}let jW=0;class $W{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const i=new qW;t.set(e,i)}return t.get(e)}}class qW{constructor(){this.id=jW++,this.usedTimes=0}}function XW(n,e,t,i,r,s,o){const a=new g_,l=new $W,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,f=r.floatVertexTextures,h=r.maxVertexUniforms,p=r.vertexTextures;let g=r.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function m(b,I,L,F,O){const B=F.fog,U=O.geometry,j=(b.isMeshStandardMaterial?t:e).get(b.envMap||(b.isMeshStandardMaterial?F.environment:null)),J=!j||j.mapping!==jc&&j.mapping!==Bf?null:j.image.height,Q=_[b.type],ee=O.isSkinnedMesh?function y(b){const L=b.skeleton.bones;if(f)return 1024;{const O=Math.floor((h-20)/4),B=Math.min(O,L.length);return B<L.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+L.length+" bones. This GPU supports "+B+"."),0):B}}(O):0;null!==b.precision&&(g=r.getMaxPrecision(b.precision),g!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",g,"instead."));const be=U.morphAttributes.position||U.morphAttributes.normal||U.morphAttributes.color,He=void 0!==be?be.length:0;let Z,dt,$e,_e,we=0;if(void 0!==U.morphAttributes.position&&(we=1),void 0!==U.morphAttributes.normal&&(we=2),void 0!==U.morphAttributes.color&&(we=3),Q){const ie=yr[Q];Z=ie.vertexShader,dt=ie.fragmentShader}else Z=b.vertexShader,dt=b.fragmentShader,l.update(b),$e=l.getVertexShaderID(b),_e=l.getFragmentShaderID(b);const ve=n.getRenderTarget(),z=b.clearcoat>0;return{isWebGL2:u,shaderID:Q,shaderName:b.type,vertexShader:Z,fragmentShader:dt,defines:b.defines,customVertexShaderID:$e,customFragmentShaderID:_e,isRawShaderMaterial:!0===b.isRawShaderMaterial,glslVersion:b.glslVersion,precision:g,instancing:!0===O.isInstancedMesh,instancingColor:!0===O.isInstancedMesh&&null!==O.instanceColor,supportsVertexTextures:p,outputEncoding:null===ve?n.outputEncoding:!0===ve.isXRRenderTarget?ve.texture.encoding:ws,map:!!b.map,matcap:!!b.matcap,envMap:!!j,envMapMode:j&&j.mapping,envMapCubeUVHeight:J,lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,objectSpaceNormalMap:b.normalMapType===Oz,tangentSpaceNormalMap:b.normalMapType===xo,decodeVideoTexture:!!b.map&&!0===b.map.isVideoTexture&&b.map.encoding===xt,clearcoat:z,clearcoatMap:z&&!!b.clearcoatMap,clearcoatRoughnessMap:z&&!!b.clearcoatRoughnessMap,clearcoatNormalMap:z&&!!b.clearcoatNormalMap,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,specularIntensityMap:!!b.specularIntensityMap,specularColorMap:!!b.specularColorMap,opaque:!1===b.transparent&&b.blending===Ga,alphaMap:!!b.alphaMap,alphaTest:b.alphaTest>0,gradientMap:!!b.gradientMap,sheen:b.sheen>0,sheenColorMap:!!b.sheenColorMap,sheenRoughnessMap:!!b.sheenRoughnessMap,transmission:b.transmission>0,transmissionMap:!!b.transmissionMap,thicknessMap:!!b.thicknessMap,combine:b.combine,vertexTangents:!!b.normalMap&&!!U.attributes.tangent,vertexColors:b.vertexColors,vertexAlphas:!0===b.vertexColors&&!!U.attributes.color&&4===U.attributes.color.itemSize,vertexUvs:!!(b.map||b.bumpMap||b.normalMap||b.specularMap||b.alphaMap||b.emissiveMap||b.roughnessMap||b.metalnessMap||b.clearcoatMap||b.clearcoatRoughnessMap||b.clearcoatNormalMap||b.displacementMap||b.transmissionMap||b.thicknessMap||b.specularIntensityMap||b.specularColorMap||b.sheenColorMap||b.sheenRoughnessMap),uvsVertexOnly:!(b.map||b.bumpMap||b.normalMap||b.specularMap||b.alphaMap||b.emissiveMap||b.roughnessMap||b.metalnessMap||b.clearcoatNormalMap||b.transmission>0||b.transmissionMap||b.thicknessMap||b.specularIntensityMap||b.specularColorMap||b.sheen>0||b.sheenColorMap||b.sheenRoughnessMap||!b.displacementMap),fog:!!B,useFog:b.fog,fogExp2:B&&B.isFogExp2,flatShading:!!b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===O.isSkinnedMesh&&ee>0,maxBones:ee,useVertexTexture:f,morphTargets:void 0!==U.morphAttributes.position,morphNormals:void 0!==U.morphAttributes.normal,morphColors:void 0!==U.morphAttributes.color,morphTargetsCount:He,morphTextureStride:we,numDirLights:I.directional.length,numPointLights:I.point.length,numSpotLights:I.spot.length,numRectAreaLights:I.rectArea.length,numHemiLights:I.hemi.length,numDirLightShadows:I.directionalShadowMap.length,numPointLightShadows:I.pointShadowMap.length,numSpotLightShadows:I.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:b.dithering,shadowMapEnabled:n.shadowMap.enabled&&L.length>0,shadowMapType:n.shadowMap.type,toneMapping:b.toneMapped?n.toneMapping:_s,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,doubleSided:b.side===po,flipSided:b.side===on,depthPacking:void 0!==b.depthPacking&&b.depthPacking,index0AttributeName:b.index0AttributeName,extensionDerivatives:b.extensions&&b.extensions.derivatives,extensionFragDepth:b.extensions&&b.extensions.fragDepth,extensionDrawBuffers:b.extensions&&b.extensions.drawBuffers,extensionShaderTextureLOD:b.extensions&&b.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:b.customProgramCacheKey()}},getProgramCacheKey:function x(b){const I=[];if(b.shaderID?I.push(b.shaderID):(I.push(b.customVertexShaderID),I.push(b.customFragmentShaderID)),void 0!==b.defines)for(const L in b.defines)I.push(L),I.push(b.defines[L]);return!1===b.isRawShaderMaterial&&(function v(b,I){b.push(I.precision),b.push(I.outputEncoding),b.push(I.envMapMode),b.push(I.envMapCubeUVHeight),b.push(I.combine),b.push(I.vertexUvs),b.push(I.fogExp2),b.push(I.sizeAttenuation),b.push(I.maxBones),b.push(I.morphTargetsCount),b.push(I.morphAttributeCount),b.push(I.numDirLights),b.push(I.numPointLights),b.push(I.numSpotLights),b.push(I.numHemiLights),b.push(I.numRectAreaLights),b.push(I.numDirLightShadows),b.push(I.numPointLightShadows),b.push(I.numSpotLightShadows),b.push(I.shadowMapType),b.push(I.toneMapping),b.push(I.numClippingPlanes),b.push(I.numClipIntersection)}(I,b),function w(b,I){a.disableAll(),I.isWebGL2&&a.enable(0),I.supportsVertexTextures&&a.enable(1),I.instancing&&a.enable(2),I.instancingColor&&a.enable(3),I.map&&a.enable(4),I.matcap&&a.enable(5),I.envMap&&a.enable(6),I.lightMap&&a.enable(7),I.aoMap&&a.enable(8),I.emissiveMap&&a.enable(9),I.bumpMap&&a.enable(10),I.normalMap&&a.enable(11),I.objectSpaceNormalMap&&a.enable(12),I.tangentSpaceNormalMap&&a.enable(13),I.clearcoat&&a.enable(14),I.clearcoatMap&&a.enable(15),I.clearcoatRoughnessMap&&a.enable(16),I.clearcoatNormalMap&&a.enable(17),I.displacementMap&&a.enable(18),I.specularMap&&a.enable(19),I.roughnessMap&&a.enable(20),I.metalnessMap&&a.enable(21),I.gradientMap&&a.enable(22),I.alphaMap&&a.enable(23),I.alphaTest&&a.enable(24),I.vertexColors&&a.enable(25),I.vertexAlphas&&a.enable(26),I.vertexUvs&&a.enable(27),I.vertexTangents&&a.enable(28),I.uvsVertexOnly&&a.enable(29),I.fog&&a.enable(30),b.push(a.mask),a.disableAll(),I.useFog&&a.enable(0),I.flatShading&&a.enable(1),I.logarithmicDepthBuffer&&a.enable(2),I.skinning&&a.enable(3),I.useVertexTexture&&a.enable(4),I.morphTargets&&a.enable(5),I.morphNormals&&a.enable(6),I.morphColors&&a.enable(7),I.premultipliedAlpha&&a.enable(8),I.shadowMapEnabled&&a.enable(9),I.physicallyCorrectLights&&a.enable(10),I.doubleSided&&a.enable(11),I.flipSided&&a.enable(12),I.depthPacking&&a.enable(13),I.dithering&&a.enable(14),I.specularIntensityMap&&a.enable(15),I.specularColorMap&&a.enable(16),I.transmission&&a.enable(17),I.transmissionMap&&a.enable(18),I.thicknessMap&&a.enable(19),I.sheen&&a.enable(20),I.sheenColorMap&&a.enable(21),I.sheenRoughnessMap&&a.enable(22),I.decodeVideoTexture&&a.enable(23),I.opaque&&a.enable(24),b.push(a.mask)}(I,b),I.push(n.outputEncoding)),I.push(b.customProgramCacheKey),I.join()},getUniforms:function M(b){const I=_[b.type];let L;return L=I?xG.clone(yr[I].uniforms):b.uniforms,L},acquireProgram:function T(b,I){let L;for(let F=0,O=c.length;F<O;F++){const B=c[F];if(B.cacheKey===I){L=B,++L.usedTimes;break}}return void 0===L&&(L=new WW(n,I,b,s),c.push(L)),L},releaseProgram:function C(b){if(0==--b.usedTimes){const I=c.indexOf(b);c[I]=c[c.length-1],c.pop(),b.destroy()}},releaseShaderCache:function R(b){l.remove(b)},programs:c,dispose:function P(){l.dispose()}}}function YW(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function ZW(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function D1(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function C1(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,f,h,p,g,_){let y=n[e];return void 0===y?(y={id:d.id,object:d,geometry:f,material:h,groupOrder:p,renderOrder:d.renderOrder,z:g,group:_},n[e]=y):(y.id=d.id,y.object=d,y.geometry=f,y.material=h,y.groupOrder=p,y.renderOrder=d.renderOrder,y.z=g,y.group=_),e++,y}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,f,h,p,g,_){const y=o(d,f,h,p,g,_);h.transmission>0?i.push(y):!0===h.transparent?r.push(y):t.push(y)},unshift:function l(d,f,h,p,g,_){const y=o(d,f,h,p,g,_);h.transmission>0?i.unshift(y):!0===h.transparent?r.unshift(y):t.unshift(y)},finish:function u(){for(let d=e,f=n.length;d<f;d++){const h=n[d];if(null===h.id)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}},sort:function c(d,f){t.length>1&&t.sort(d||ZW),i.length>1&&i.sort(f||D1),r.length>1&&r.sort(f||D1)}}}function KW(){let n=new WeakMap;return{get:function e(i,r){let s;return!1===n.has(i)?(s=new C1,n.set(i,[s])):r>=n.get(i).length?(s=new C1,n.get(i).push(s)):s=n.get(i)[r],s},dispose:function t(){n=new WeakMap}}}function JW(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new E,color:new re};break;case"SpotLight":t={position:new E,direction:new E,color:new re,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new E,color:new re,distance:0,decay:0};break;case"HemisphereLight":t={direction:new E,skyColor:new re,groundColor:new re};break;case"RectAreaLight":t={color:new re,position:new E,halfWidth:new E,halfHeight:new E}}return n[e.id]=t,t}}}let e8=0;function t8(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function n8(n,e){const t=new JW,i=function QW(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new E);const s=new E,o=new me,a=new me;return{setup:function l(u,d){let f=0,h=0,p=0;for(let R=0;R<9;R++)r.probe[R].set(0,0,0);let g=0,_=0,y=0,m=0,x=0,v=0,w=0,M=0;u.sort(t8);const T=!0!==d?Math.PI:1;for(let R=0,P=u.length;R<P;R++){const b=u[R],I=b.color,L=b.intensity,F=b.distance,O=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)f+=I.r*L*T,h+=I.g*L*T,p+=I.b*L*T;else if(b.isLightProbe)for(let B=0;B<9;B++)r.probe[B].addScaledVector(b.sh.coefficients[B],L);else if(b.isDirectionalLight){const B=t.get(b);if(B.color.copy(b.color).multiplyScalar(b.intensity*T),b.castShadow){const U=b.shadow,k=i.get(b);k.shadowBias=U.bias,k.shadowNormalBias=U.normalBias,k.shadowRadius=U.radius,k.shadowMapSize=U.mapSize,r.directionalShadow[g]=k,r.directionalShadowMap[g]=O,r.directionalShadowMatrix[g]=b.shadow.matrix,v++}r.directional[g]=B,g++}else if(b.isSpotLight){const B=t.get(b);if(B.position.setFromMatrixPosition(b.matrixWorld),B.color.copy(I).multiplyScalar(L*T),B.distance=F,B.coneCos=Math.cos(b.angle),B.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),B.decay=b.decay,b.castShadow){const U=b.shadow,k=i.get(b);k.shadowBias=U.bias,k.shadowNormalBias=U.normalBias,k.shadowRadius=U.radius,k.shadowMapSize=U.mapSize,r.spotShadow[y]=k,r.spotShadowMap[y]=O,r.spotShadowMatrix[y]=b.shadow.matrix,M++}r.spot[y]=B,y++}else if(b.isRectAreaLight){const B=t.get(b);B.color.copy(I).multiplyScalar(L),B.halfWidth.set(.5*b.width,0,0),B.halfHeight.set(0,.5*b.height,0),r.rectArea[m]=B,m++}else if(b.isPointLight){const B=t.get(b);if(B.color.copy(b.color).multiplyScalar(b.intensity*T),B.distance=b.distance,B.decay=b.decay,b.castShadow){const U=b.shadow,k=i.get(b);k.shadowBias=U.bias,k.shadowNormalBias=U.normalBias,k.shadowRadius=U.radius,k.shadowMapSize=U.mapSize,k.shadowCameraNear=U.camera.near,k.shadowCameraFar=U.camera.far,r.pointShadow[_]=k,r.pointShadowMap[_]=O,r.pointShadowMatrix[_]=b.shadow.matrix,w++}r.point[_]=B,_++}else if(b.isHemisphereLight){const B=t.get(b);B.skyColor.copy(b.color).multiplyScalar(L*T),B.groundColor.copy(b.groundColor).multiplyScalar(L*T),r.hemi[x]=B,x++}}m>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=oe.LTC_FLOAT_1,r.rectAreaLTC2=oe.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=oe.LTC_HALF_1,r.rectAreaLTC2=oe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=f,r.ambient[1]=h,r.ambient[2]=p;const C=r.hash;(C.directionalLength!==g||C.pointLength!==_||C.spotLength!==y||C.rectAreaLength!==m||C.hemiLength!==x||C.numDirectionalShadows!==v||C.numPointShadows!==w||C.numSpotShadows!==M)&&(r.directional.length=g,r.spot.length=y,r.rectArea.length=m,r.point.length=_,r.hemi.length=x,r.directionalShadow.length=v,r.directionalShadowMap.length=v,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=v,r.pointShadowMatrix.length=w,r.spotShadowMatrix.length=M,C.directionalLength=g,C.pointLength=_,C.spotLength=y,C.rectAreaLength=m,C.hemiLength=x,C.numDirectionalShadows=v,C.numPointShadows=w,C.numSpotShadows=M,r.version=e8++)},setupView:function c(u,d){let f=0,h=0,p=0,g=0,_=0;const y=d.matrixWorldInverse;for(let m=0,x=u.length;m<x;m++){const v=u[m];if(v.isDirectionalLight){const w=r.directional[f];w.direction.setFromMatrixPosition(v.matrixWorld),s.setFromMatrixPosition(v.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(y),f++}else if(v.isSpotLight){const w=r.spot[p];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(y),w.direction.setFromMatrixPosition(v.matrixWorld),s.setFromMatrixPosition(v.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(y),p++}else if(v.isRectAreaLight){const w=r.rectArea[g];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(y),a.identity(),o.copy(v.matrixWorld),o.premultiply(y),a.extractRotation(o),w.halfWidth.set(.5*v.width,0,0),w.halfHeight.set(0,.5*v.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),g++}else if(v.isPointLight){const w=r.point[h];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(y),h++}else if(v.isHemisphereLight){const w=r.hemi[_];w.direction.setFromMatrixPosition(v.matrixWorld),w.direction.transformDirection(y),w.direction.normalize(),_++}}},state:r}}function A1(n,e){const t=new n8(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function i8(n,e){let t=new WeakMap;return{get:function i(s,o=0){let a;return!1===t.has(s)?(a=new A1(n,e),t.set(s,[a])):o>=t.get(s).length?(a=new A1(n,e),t.get(s).push(a)):a=t.get(s)[o],a},dispose:function r(){t=new WeakMap}}}class B_ extends kt{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}B_.prototype.isMeshDepthMaterial=!0;class H_ extends kt{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new E,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}H_.prototype.isMeshDistanceMaterial=!0;const r8="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",s8="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function I1(n,e,t){let i=new dh;const r=new X,s=new X,o=new gt,a=new B_({depthPacking:Fz}),l=new H_,c={},u=t.maxTextureSize,d={0:on,1:ho,2:po},f=new Qi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new X},radius:{value:4}},vertexShader:r8,fragmentShader:s8}),h=f.clone();h.defines.HORIZONTAL_PASS=1;const p=new Te;p.setAttribute("position",new yt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new _n(p,f),_=this;function y(v,w){const M=e.update(g);f.defines.VSM_SAMPLES!==v.blurSamples&&(f.defines.VSM_SAMPLES=v.blurSamples,h.defines.VSM_SAMPLES=v.blurSamples,f.needsUpdate=!0,h.needsUpdate=!0),f.uniforms.shadow_pass.value=v.map.texture,f.uniforms.resolution.value=v.mapSize,f.uniforms.radius.value=v.radius,n.setRenderTarget(v.mapPass),n.clear(),n.renderBufferDirect(w,null,M,f,g,null),h.uniforms.shadow_pass.value=v.mapPass.texture,h.uniforms.resolution.value=v.mapSize,h.uniforms.radius.value=v.radius,n.setRenderTarget(v.map),n.clear(),n.renderBufferDirect(w,null,M,h,g,null)}function m(v,w,M,T,C,R){let P=null;const b=!0===M.isPointLight?v.customDistanceMaterial:v.customDepthMaterial;if(P=void 0!==b?b:!0===M.isPointLight?l:a,n.localClippingEnabled&&!0===w.clipShadows&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0){const I=P.uuid,L=w.uuid;let F=c[I];void 0===F&&(F={},c[I]=F);let O=F[L];void 0===O&&(O=P.clone(),F[L]=O),P=O}return P.visible=w.visible,P.wireframe=w.wireframe,P.side=R===Wc?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:d[w.side],P.alphaMap=w.alphaMap,P.alphaTest=w.alphaTest,P.clipShadows=w.clipShadows,P.clippingPlanes=w.clippingPlanes,P.clipIntersection=w.clipIntersection,P.displacementMap=w.displacementMap,P.displacementScale=w.displacementScale,P.displacementBias=w.displacementBias,P.wireframeLinewidth=w.wireframeLinewidth,P.linewidth=w.linewidth,!0===M.isPointLight&&!0===P.isMeshDistanceMaterial&&(P.referencePosition.setFromMatrixPosition(M.matrixWorld),P.nearDistance=T,P.farDistance=C),P}function x(v,w,M,T,C){if(!1===v.visible)return;if(v.layers.test(w.layers)&&(v.isMesh||v.isLine||v.isPoints)&&(v.castShadow||v.receiveShadow&&C===Wc)&&(!v.frustumCulled||i.intersectsObject(v))){v.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,v.matrixWorld);const b=e.update(v),I=v.material;if(Array.isArray(I)){const L=b.groups;for(let F=0,O=L.length;F<O;F++){const B=L[F],U=I[B.materialIndex];if(U&&U.visible){const k=m(v,U,T,M.near,M.far,C);n.renderBufferDirect(M,null,b,k,v,B)}}}else if(I.visible){const L=m(v,I,T,M.near,M.far,C);n.renderBufferDirect(M,null,b,L,v,null)}}const P=v.children;for(let b=0,I=P.length;b<I;b++)x(P[b],w,M,T,C)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=aD,this.render=function(v,w,M){if(!1===_.enabled||!1===_.autoUpdate&&!1===_.needsUpdate||0===v.length)return;const T=n.getRenderTarget(),C=n.getActiveCubeFace(),R=n.getActiveMipmapLevel(),P=n.state;P.setBlending(ys),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let b=0,I=v.length;b<I;b++){const L=v[b],F=L.shadow;if(void 0===F){console.warn("THREE.WebGLShadowMap:",L,"has no shadow.");continue}if(!1===F.autoUpdate&&!1===F.needsUpdate)continue;r.copy(F.mapSize);const O=F.getFrameExtents();if(r.multiply(O),s.copy(F.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/O.x),r.x=s.x*O.x,F.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/O.y),r.y=s.y*O.y,F.mapSize.y=s.y)),null===F.map&&!F.isPointLightShadow&&this.type===Wc){const U={minFilter:Rt,magFilter:Rt,format:Xn};F.map=new ai(r.x,r.y,U),F.map.texture.name=L.name+".shadowMap",F.mapPass=new ai(r.x,r.y,U),F.camera.updateProjectionMatrix()}null===F.map&&(F.map=new ai(r.x,r.y,{minFilter:an,magFilter:an,format:Xn}),F.map.texture.name=L.name+".shadowMap",F.camera.updateProjectionMatrix()),n.setRenderTarget(F.map),n.clear();const B=F.getViewportCount();for(let U=0;U<B;U++){const k=F.getViewport(U);o.set(s.x*k.x,s.y*k.y,s.x*k.z,s.y*k.w),P.viewport(o),F.updateMatrices(L,U),i=F.getFrustum(),x(w,M,F.camera,L,this.type)}!F.isPointLightShadow&&this.type===Wc&&y(F,M),F.needsUpdate=!1}_.needsUpdate=!1,n.setRenderTarget(T,C,R)}}function o8(n,e,t){const i=t.isWebGL2,a=new function r(){let N=!1;const pe=new gt;let ue=null;const Ge=new gt(0,0,0,0);return{setMask:function(de){ue!==de&&!N&&(n.colorMask(de,de,de,de),ue=de)},setLocked:function(de){N=de},setClear:function(de,ne,ze,st,Kn){!0===Kn&&(de*=st,ne*=st,ze*=st),pe.set(de,ne,ze,st),!1===Ge.equals(pe)&&(n.clearColor(de,ne,ze,st),Ge.copy(pe))},reset:function(){N=!1,ue=null,Ge.set(-1,0,0,0)}}},l=new function s(){let N=!1,pe=null,ue=null,Ge=null;return{setTest:function(de){de?we(2929):Z(2929)},setMask:function(de){pe!==de&&!N&&(n.depthMask(de),pe=de)},setFunc:function(de){if(ue!==de){if(de)switch(de){case ez:n.depthFunc(512);break;case tz:n.depthFunc(519);break;case nz:n.depthFunc(513);break;case qy:n.depthFunc(515);break;case iz:n.depthFunc(514);break;case rz:n.depthFunc(518);break;case sz:n.depthFunc(516);break;case oz:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);ue=de}},setLocked:function(de){N=de},setClear:function(de){Ge!==de&&(n.clearDepth(de),Ge=de)},reset:function(){N=!1,pe=null,ue=null,Ge=null}}},c=new function o(){let N=!1,pe=null,ue=null,Ge=null,de=null,ne=null,ze=null,st=null,Kn=null;return{setTest:function(Mt){N||(Mt?we(2960):Z(2960))},setMask:function(Mt){pe!==Mt&&!N&&(n.stencilMask(Mt),pe=Mt)},setFunc:function(Mt,Tr,Dr){(ue!==Mt||Ge!==Tr||de!==Dr)&&(n.stencilFunc(Mt,Tr,Dr),ue=Mt,Ge=Tr,de=Dr)},setOp:function(Mt,Tr,Dr){(ne!==Mt||ze!==Tr||st!==Dr)&&(n.stencilOp(Mt,Tr,Dr),ne=Mt,ze=Tr,st=Dr)},setLocked:function(Mt){N=Mt},setClear:function(Mt){Kn!==Mt&&(n.clearStencil(Mt),Kn=Mt)},reset:function(){N=!1,pe=null,ue=null,Ge=null,de=null,ne=null,ze=null,st=null,Kn=null}}};let u={},d={},f=new WeakMap,h=[],p=null,g=!1,_=null,y=null,m=null,x=null,v=null,w=null,M=null,T=!1,C=null,R=null,P=null,b=null,I=null;const L=n.getParameter(35661);let F=!1,O=0;const B=n.getParameter(7938);-1!==B.indexOf("WebGL")?(O=parseFloat(/^WebGL (\d)/.exec(B)[1]),F=O>=1):-1!==B.indexOf("OpenGL ES")&&(O=parseFloat(/^OpenGL ES (\d)/.exec(B)[1]),F=O>=2);let U=null,k={};const j=n.getParameter(3088),J=n.getParameter(2978),Q=(new gt).fromArray(j),ee=(new gt).fromArray(J);function be(N,pe,ue){const Ge=new Uint8Array(4),de=n.createTexture();n.bindTexture(N,de),n.texParameteri(N,10241,9728),n.texParameteri(N,10240,9728);for(let ne=0;ne<ue;ne++)n.texImage2D(pe+ne,0,6408,1,1,0,6408,5121,Ge);return de}const He={};function we(N){!0!==u[N]&&(n.enable(N),u[N]=!0)}function Z(N){!1!==u[N]&&(n.disable(N),u[N]=!1)}He[3553]=be(3553,3553,1),He[34067]=be(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),we(2929),l.setFunc(qy),ie(!1),ye(oD),we(2884),z(ys);const ve={[Wa]:32774,[GV]:32778,[WV]:32779};if(i)ve[fD]=32775,ve[hD]=32776;else{const N=e.get("EXT_blend_minmax");null!==N&&(ve[fD]=N.MIN_EXT,ve[hD]=N.MAX_EXT)}const nt={[jV]:0,[$V]:1,[qV]:768,[pD]:770,[QV]:776,[KV]:774,[YV]:772,[XV]:769,[mD]:771,[JV]:775,[ZV]:773};function z(N,pe,ue,Ge,de,ne,ze,st){if(N!==ys){if(!1===g&&(we(3042),g=!0),N===zV)de=de||pe,ne=ne||ue,ze=ze||Ge,(pe!==y||de!==v)&&(n.blendEquationSeparate(ve[pe],ve[de]),y=pe,v=de),(ue!==m||Ge!==x||ne!==w||ze!==M)&&(n.blendFuncSeparate(nt[ue],nt[Ge],nt[ne],nt[ze]),m=ue,x=Ge,w=ne,M=ze),_=N,T=null;else if(N!==_||st!==T){if((y!==Wa||v!==Wa)&&(n.blendEquation(32774),y=Wa,v=Wa),st)switch(N){case Ga:n.blendFuncSeparate(1,771,1,771);break;case cD:n.blendFunc(1,1);break;case uD:n.blendFuncSeparate(0,769,0,1);break;case dD:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",N)}else switch(N){case Ga:n.blendFuncSeparate(770,771,1,771);break;case cD:n.blendFunc(770,1);break;case uD:n.blendFuncSeparate(0,769,0,1);break;case dD:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",N)}m=null,x=null,w=null,M=null,_=N,T=st}}else!0===g&&(Z(3042),g=!1)}function ie(N){C!==N&&(n.frontFace(N?2304:2305),C=N)}function ye(N){N!==HV?(we(2884),N!==R&&n.cullFace(N===oD?1029:N===UV?1028:1032)):Z(2884),R=N}function Pe(N,pe,ue){N?(we(32823),(b!==pe||I!==ue)&&(n.polygonOffset(pe,ue),b=pe,I=ue)):Z(32823)}function Xe(N){void 0===N&&(N=33984+L-1),U!==N&&(n.activeTexture(N),U=N)}return{buffers:{color:a,depth:l,stencil:c},enable:we,disable:Z,bindFramebuffer:function dt(N,pe){return d[N]!==pe&&(n.bindFramebuffer(N,pe),d[N]=pe,i&&(36009===N&&(d[36160]=pe),36160===N&&(d[36009]=pe)),!0)},drawBuffers:function $e(N,pe){let ue=h,Ge=!1;if(N)if(ue=f.get(pe),void 0===ue&&(ue=[],f.set(pe,ue)),N.isWebGLMultipleRenderTargets){const de=N.texture;if(ue.length!==de.length||36064!==ue[0]){for(let ne=0,ze=de.length;ne<ze;ne++)ue[ne]=36064+ne;ue.length=de.length,Ge=!0}}else 36064!==ue[0]&&(ue[0]=36064,Ge=!0);else 1029!==ue[0]&&(ue[0]=1029,Ge=!0);Ge&&(t.isWebGL2?n.drawBuffers(ue):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ue))},useProgram:function _e(N){return p!==N&&(n.useProgram(N),p=N,!0)},setBlending:z,setMaterial:function te(N,pe){N.side===po?Z(2884):we(2884);let ue=N.side===on;pe&&(ue=!ue),ie(ue),N.blending===Ga&&!1===N.transparent?z(ys):z(N.blending,N.blendEquation,N.blendSrc,N.blendDst,N.blendEquationAlpha,N.blendSrcAlpha,N.blendDstAlpha,N.premultipliedAlpha),l.setFunc(N.depthFunc),l.setTest(N.depthTest),l.setMask(N.depthWrite),a.setMask(N.colorWrite);const Ge=N.stencilWrite;c.setTest(Ge),Ge&&(c.setMask(N.stencilWriteMask),c.setFunc(N.stencilFunc,N.stencilRef,N.stencilFuncMask),c.setOp(N.stencilFail,N.stencilZFail,N.stencilZPass)),Pe(N.polygonOffset,N.polygonOffsetFactor,N.polygonOffsetUnits),!0===N.alphaToCoverage?we(32926):Z(32926)},setFlipSided:ie,setCullFace:ye,setLineWidth:function ce(N){N!==P&&(F&&n.lineWidth(N),P=N)},setPolygonOffset:Pe,setScissorTest:function Me(N){N?we(3089):Z(3089)},activeTexture:Xe,bindTexture:function Lt(N,pe){null===U&&Xe();let ue=k[U];void 0===ue&&(ue={type:void 0,texture:void 0},k[U]=ue),(ue.type!==N||ue.texture!==pe)&&(n.bindTexture(N,pe||He[N]),ue.type=N,ue.texture=pe)},unbindTexture:function A(){const N=k[U];void 0!==N&&void 0!==N.type&&(n.bindTexture(N.type,null),N.type=void 0,N.texture=void 0)},compressedTexImage2D:function S(){try{n.compressedTexImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texImage2D:function $(){try{n.texImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texImage3D:function Ue(){try{n.texImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texStorage2D:function he(){try{n.texStorage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texStorage3D:function Ce(){try{n.texStorage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texSubImage2D:function W(){try{n.texSubImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texSubImage3D:function K(){try{n.texSubImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},compressedTexSubImage2D:function se(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},scissor:function Ve(N){!1===Q.equals(N)&&(n.scissor(N.x,N.y,N.z,N.w),Q.copy(N))},viewport:function Ee(N){!1===ee.equals(N)&&(n.viewport(N.x,N.y,N.z,N.w),ee.copy(N))},reset:function xe(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},U=null,k={},d={},f=new WeakMap,h=[],p=null,g=!1,_=null,y=null,m=null,x=null,v=null,w=null,M=null,T=!1,C=null,R=null,P=null,b=null,I=null,Q.set(0,0,n.canvas.width,n.canvas.height),ee.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function a8(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,f=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=new WeakMap;let p;const g=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function y(A,S){return _?new OffscreenCanvas(A,S):Qc("canvas")}function m(A,S,W,K){let se=1;if((A.width>K||A.height>K)&&(se=K/Math.max(A.width,A.height)),se<1||!0===S){if(typeof HTMLImageElement<"u"&&A instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&A instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&A instanceof ImageBitmap){const he=S?Wf:Math.floor,Ce=he(se*A.width),$=he(se*A.height);void 0===p&&(p=y(Ce,$));const Ue=W?y(Ce,$):p;return Ue.width=Ce,Ue.height=$,Ue.getContext("2d").drawImage(A,0,0,Ce,$),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+A.width+"x"+A.height+") to ("+Ce+"x"+$+")."),Ue}return"data"in A&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+A.width+"x"+A.height+")."),A}return A}function x(A){return s_(A.width)&&s_(A.height)}function w(A,S){return A.generateMipmaps&&S&&A.minFilter!==an&&A.minFilter!==Rt}function M(A){n.generateMipmap(A)}function T(A,S,W,K,se=!1){if(!1===a)return S;if(null!==A){if(void 0!==n[A])return n[A];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+A+"'")}let he=S;return 6403===S&&(5126===W&&(he=33326),5131===W&&(he=33325),5121===W&&(he=33321)),33319===S&&(5126===W&&(he=33328),5131===W&&(he=33327),5121===W&&(he=33323)),6408===S&&(5126===W&&(he=34836),5131===W&&(he=34842),5121===W&&(he=K===xt&&!1===se?35907:32856),32819===W&&(he=32854),32820===W&&(he=32855)),(33325===he||33326===he||33327===he||33328===he||34842===he||34836===he)&&e.get("EXT_color_buffer_float"),he}function C(A,S,W){return!0===w(A,W)||A.isFramebufferTexture&&A.minFilter!==an&&A.minFilter!==Rt?Math.log2(Math.max(S.width,S.height))+1:void 0!==A.mipmaps&&A.mipmaps.length>0?A.mipmaps.length:A.isCompressedTexture&&Array.isArray(A.image)?S.mipmaps.length:1}function R(A){return A===an||A===Hf||A===Uf?9728:9729}function P(A){const S=A.target;S.removeEventListener("dispose",P),function I(A){const S=i.get(A);if(void 0===S.__webglInit)return;const W=A.source,K=g.get(W);if(K){const se=K[S.__cacheKey];se.usedTimes--,0===se.usedTimes&&L(A),0===Object.keys(K).length&&g.delete(W)}i.remove(A)}(S),S.isVideoTexture&&h.delete(S)}function b(A){const S=A.target;S.removeEventListener("dispose",b),function F(A){const S=A.texture,W=i.get(A),K=i.get(S);if(void 0!==K.__webglTexture&&(n.deleteTexture(K.__webglTexture),o.memory.textures--),A.depthTexture&&A.depthTexture.dispose(),A.isWebGLCubeRenderTarget)for(let se=0;se<6;se++)n.deleteFramebuffer(W.__webglFramebuffer[se]),W.__webglDepthbuffer&&n.deleteRenderbuffer(W.__webglDepthbuffer[se]);else n.deleteFramebuffer(W.__webglFramebuffer),W.__webglDepthbuffer&&n.deleteRenderbuffer(W.__webglDepthbuffer),W.__webglMultisampledFramebuffer&&n.deleteFramebuffer(W.__webglMultisampledFramebuffer),W.__webglColorRenderbuffer&&n.deleteRenderbuffer(W.__webglColorRenderbuffer),W.__webglDepthRenderbuffer&&n.deleteRenderbuffer(W.__webglDepthRenderbuffer);if(A.isWebGLMultipleRenderTargets)for(let se=0,he=S.length;se<he;se++){const Ce=i.get(S[se]);Ce.__webglTexture&&(n.deleteTexture(Ce.__webglTexture),o.memory.textures--),i.remove(S[se])}i.remove(S),i.remove(A)}(S)}function L(A){const S=i.get(A);n.deleteTexture(S.__webglTexture),delete g.get(A.source)[S.__cacheKey],o.memory.textures--}let O=0;function j(A,S){const W=i.get(A);if(A.isVideoTexture&&function Xe(A){const S=o.render.frame;h.get(A)!==S&&(h.set(A,S),A.update())}(A),A.version>0&&W.__version!==A.version){const K=A.image;if(null===K)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==K.complete)return void dt(W,A,S);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+S),t.bindTexture(3553,W.__webglTexture)}const be={[yo]:10497,[qn]:33071,[$c]:33648},He={[an]:9728,[Hf]:9984,[Uf]:9986,[Rt]:9729,[Yy]:9985,[vs]:9987};function we(A,S,W){if(W?(n.texParameteri(A,10242,be[S.wrapS]),n.texParameteri(A,10243,be[S.wrapT]),(32879===A||35866===A)&&n.texParameteri(A,32882,be[S.wrapR]),n.texParameteri(A,10240,He[S.magFilter]),n.texParameteri(A,10241,He[S.minFilter])):(n.texParameteri(A,10242,33071),n.texParameteri(A,10243,33071),(32879===A||35866===A)&&n.texParameteri(A,32882,33071),(S.wrapS!==qn||S.wrapT!==qn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(A,10240,R(S.magFilter)),n.texParameteri(A,10241,R(S.minFilter)),S.minFilter!==an&&S.minFilter!==Rt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const K=e.get("EXT_texture_filter_anisotropic");if(S.type===xs&&!1===e.has("OES_texture_float_linear")||!1===a&&S.type===ja&&!1===e.has("OES_texture_half_float_linear"))return;(S.anisotropy>1||i.get(S).__currentAnisotropy)&&(n.texParameterf(A,K.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(S.anisotropy,r.getMaxAnisotropy())),i.get(S).__currentAnisotropy=S.anisotropy)}}function Z(A,S){let W=!1;void 0===A.__webglInit&&(A.__webglInit=!0,S.addEventListener("dispose",P));const K=S.source;let se=g.get(K);void 0===se&&(se={},g.set(K,se));const he=function k(A){const S=[];return S.push(A.wrapS),S.push(A.wrapT),S.push(A.magFilter),S.push(A.minFilter),S.push(A.anisotropy),S.push(A.internalFormat),S.push(A.format),S.push(A.type),S.push(A.generateMipmaps),S.push(A.premultiplyAlpha),S.push(A.flipY),S.push(A.unpackAlignment),S.push(A.encoding),S.join()}(S);if(he!==A.__cacheKey){void 0===se[he]&&(se[he]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,W=!0),se[he].usedTimes++;const Ce=se[A.__cacheKey];void 0!==Ce&&(se[A.__cacheKey].usedTimes--,0===Ce.usedTimes&&L(S)),A.__cacheKey=he,A.__webglTexture=se[he].texture}return W}function dt(A,S,W){let K=3553;S.isDataArrayTexture&&(K=35866),S.isData3DTexture&&(K=32879);const se=Z(A,S),he=S.source;if(t.activeTexture(33984+W),t.bindTexture(K,A.__webglTexture),he.version!==he.__currentVersion||!0===se){n.pixelStorei(37440,S.flipY),n.pixelStorei(37441,S.premultiplyAlpha),n.pixelStorei(3317,S.unpackAlignment),n.pixelStorei(37443,0);const Ce=function v(A){return!a&&(A.wrapS!==qn||A.wrapT!==qn||A.minFilter!==an&&A.minFilter!==Rt)}(S)&&!1===x(S.image);let $=m(S.image,Ce,!1,u);$=Lt(S,$);const Ue=x($)||a,Ve=s.convert(S.format,S.encoding);let N,Ee=s.convert(S.type),xe=T(S.internalFormat,Ve,Ee,S.encoding,S.isVideoTexture);we(K,S,Ue);const pe=S.mipmaps,ue=a&&!0!==S.isVideoTexture,Ge=void 0===A.__version,de=C(S,$,Ue);if(S.isDepthTexture)xe=6402,a?xe=S.type===xs?36012:S.type===Vf?33190:S.type===$a?35056:33189:S.type===xs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),S.format===vo&&6402===xe&&S.type!==qc&&S.type!==Vf&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),S.type=qc,Ee=s.convert(S.type)),S.format===qa&&6402===xe&&(xe=34041,S.type!==$a&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),S.type=$a,Ee=s.convert(S.type))),ue&&Ge?t.texStorage2D(3553,1,xe,$.width,$.height):t.texImage2D(3553,0,xe,$.width,$.height,0,Ve,Ee,null);else if(S.isDataTexture)if(pe.length>0&&Ue){ue&&Ge&&t.texStorage2D(3553,de,xe,pe[0].width,pe[0].height);for(let ne=0,ze=pe.length;ne<ze;ne++)N=pe[ne],ue?t.texSubImage2D(3553,ne,0,0,N.width,N.height,Ve,Ee,N.data):t.texImage2D(3553,ne,xe,N.width,N.height,0,Ve,Ee,N.data);S.generateMipmaps=!1}else ue?(Ge&&t.texStorage2D(3553,de,xe,$.width,$.height),t.texSubImage2D(3553,0,0,0,$.width,$.height,Ve,Ee,$.data)):t.texImage2D(3553,0,xe,$.width,$.height,0,Ve,Ee,$.data);else if(S.isCompressedTexture){ue&&Ge&&t.texStorage2D(3553,de,xe,pe[0].width,pe[0].height);for(let ne=0,ze=pe.length;ne<ze;ne++)N=pe[ne],S.format!==Xn?null!==Ve?ue?t.compressedTexSubImage2D(3553,ne,0,0,N.width,N.height,Ve,N.data):t.compressedTexImage2D(3553,ne,xe,N.width,N.height,0,N.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ue?t.texSubImage2D(3553,ne,0,0,N.width,N.height,Ve,Ee,N.data):t.texImage2D(3553,ne,xe,N.width,N.height,0,Ve,Ee,N.data)}else if(S.isDataArrayTexture)ue?(Ge&&t.texStorage3D(35866,de,xe,$.width,$.height,$.depth),t.texSubImage3D(35866,0,0,0,0,$.width,$.height,$.depth,Ve,Ee,$.data)):t.texImage3D(35866,0,xe,$.width,$.height,$.depth,0,Ve,Ee,$.data);else if(S.isData3DTexture)ue?(Ge&&t.texStorage3D(32879,de,xe,$.width,$.height,$.depth),t.texSubImage3D(32879,0,0,0,0,$.width,$.height,$.depth,Ve,Ee,$.data)):t.texImage3D(32879,0,xe,$.width,$.height,$.depth,0,Ve,Ee,$.data);else if(S.isFramebufferTexture)ue&&Ge?t.texStorage2D(3553,de,xe,$.width,$.height):t.texImage2D(3553,0,xe,$.width,$.height,0,Ve,Ee,null);else if(pe.length>0&&Ue){ue&&Ge&&t.texStorage2D(3553,de,xe,pe[0].width,pe[0].height);for(let ne=0,ze=pe.length;ne<ze;ne++)N=pe[ne],ue?t.texSubImage2D(3553,ne,0,0,Ve,Ee,N):t.texImage2D(3553,ne,xe,Ve,Ee,N);S.generateMipmaps=!1}else ue?(Ge&&t.texStorage2D(3553,de,xe,$.width,$.height),t.texSubImage2D(3553,0,0,0,Ve,Ee,$)):t.texImage2D(3553,0,xe,Ve,Ee,$);w(S,Ue)&&M(K),he.__currentVersion=he.version,S.onUpdate&&S.onUpdate(S)}A.__version=S.version}function _e(A,S,W,K,se){const he=s.convert(W.format,W.encoding),Ce=s.convert(W.type),$=T(W.internalFormat,he,Ce,W.encoding);i.get(S).__hasExternalTextures||(32879===se||35866===se?t.texImage3D(se,0,$,S.width,S.height,S.depth,0,he,Ce,null):t.texImage2D(se,0,$,S.width,S.height,0,he,Ce,null)),t.bindFramebuffer(36160,A),Me(S)?f.framebufferTexture2DMultisampleEXT(36160,K,se,i.get(W).__webglTexture,0,Pe(S)):n.framebufferTexture2D(36160,K,se,i.get(W).__webglTexture,0),t.bindFramebuffer(36160,null)}function ve(A,S,W){if(n.bindRenderbuffer(36161,A),S.depthBuffer&&!S.stencilBuffer){let K=33189;if(W||Me(S)){const se=S.depthTexture;se&&se.isDepthTexture&&(se.type===xs?K=36012:se.type===Vf&&(K=33190));const he=Pe(S);Me(S)?f.renderbufferStorageMultisampleEXT(36161,he,K,S.width,S.height):n.renderbufferStorageMultisample(36161,he,K,S.width,S.height)}else n.renderbufferStorage(36161,K,S.width,S.height);n.framebufferRenderbuffer(36160,36096,36161,A)}else if(S.depthBuffer&&S.stencilBuffer){const K=Pe(S);W&&!1===Me(S)?n.renderbufferStorageMultisample(36161,K,35056,S.width,S.height):Me(S)?f.renderbufferStorageMultisampleEXT(36161,K,35056,S.width,S.height):n.renderbufferStorage(36161,34041,S.width,S.height),n.framebufferRenderbuffer(36160,33306,36161,A)}else{const K=!0===S.isWebGLMultipleRenderTargets?S.texture[0]:S.texture,se=s.convert(K.format,K.encoding),he=s.convert(K.type),Ce=T(K.internalFormat,se,he,K.encoding),$=Pe(S);W&&!1===Me(S)?n.renderbufferStorageMultisample(36161,$,Ce,S.width,S.height):Me(S)?f.renderbufferStorageMultisampleEXT(36161,$,Ce,S.width,S.height):n.renderbufferStorage(36161,Ce,S.width,S.height)}n.bindRenderbuffer(36161,null)}function z(A){const S=i.get(A),W=!0===A.isWebGLCubeRenderTarget;if(A.depthTexture&&!S.__autoAllocateDepthBuffer){if(W)throw new Error("target.depthTexture not supported in Cube render targets");!function nt(A,S){if(S&&S.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,A),!S.depthTexture||!S.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(S.depthTexture).__webglTexture||S.depthTexture.image.width!==S.width||S.depthTexture.image.height!==S.height)&&(S.depthTexture.image.width=S.width,S.depthTexture.image.height=S.height,S.depthTexture.needsUpdate=!0),j(S.depthTexture,0);const K=i.get(S.depthTexture).__webglTexture,se=Pe(S);if(S.depthTexture.format===vo)Me(S)?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,K,0,se):n.framebufferTexture2D(36160,36096,3553,K,0);else{if(S.depthTexture.format!==qa)throw new Error("Unknown depthTexture format");Me(S)?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,K,0,se):n.framebufferTexture2D(36160,33306,3553,K,0)}}(S.__webglFramebuffer,A)}else if(W){S.__webglDepthbuffer=[];for(let K=0;K<6;K++)t.bindFramebuffer(36160,S.__webglFramebuffer[K]),S.__webglDepthbuffer[K]=n.createRenderbuffer(),ve(S.__webglDepthbuffer[K],A,!1)}else t.bindFramebuffer(36160,S.__webglFramebuffer),S.__webglDepthbuffer=n.createRenderbuffer(),ve(S.__webglDepthbuffer,A,!1);t.bindFramebuffer(36160,null)}function Pe(A){return Math.min(d,A.samples)}function Me(A){const S=i.get(A);return a&&A.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==S.__useRenderToTexture}function Lt(A,S){const W=A.encoding,K=A.format,se=A.type;return!0===A.isCompressedTexture||!0===A.isVideoTexture||A.format===i_||W!==ws&&(W===xt?!1===a?!0===e.has("EXT_sRGB")&&K===Xn?(A.format=i_,A.minFilter=Rt,A.generateMipmaps=!1):S=Mo.sRGBToLinear(S):(K!==Xn||se!==_o)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",W)),S}this.allocateTextureUnit=function U(){const A=O;return A>=l&&console.warn("THREE.WebGLTextures: Trying to use "+A+" texture units while this GPU supports only "+l),O+=1,A},this.resetTextureUnits=function B(){O=0},this.setTexture2D=j,this.setTexture2DArray=function J(A,S){const W=i.get(A);A.version>0&&W.__version!==A.version?dt(W,A,S):(t.activeTexture(33984+S),t.bindTexture(35866,W.__webglTexture))},this.setTexture3D=function Q(A,S){const W=i.get(A);A.version>0&&W.__version!==A.version?dt(W,A,S):(t.activeTexture(33984+S),t.bindTexture(32879,W.__webglTexture))},this.setTextureCube=function ee(A,S){const W=i.get(A);A.version>0&&W.__version!==A.version?function $e(A,S,W){if(6!==S.image.length)return;const K=Z(A,S),se=S.source;if(t.activeTexture(33984+W),t.bindTexture(34067,A.__webglTexture),se.version!==se.__currentVersion||!0===K){n.pixelStorei(37440,S.flipY),n.pixelStorei(37441,S.premultiplyAlpha),n.pixelStorei(3317,S.unpackAlignment),n.pixelStorei(37443,0);const he=S.isCompressedTexture||S.image[0].isCompressedTexture,Ce=S.image[0]&&S.image[0].isDataTexture,$=[];for(let ne=0;ne<6;ne++)$[ne]=he||Ce?Ce?S.image[ne].image:S.image[ne]:m(S.image[ne],!1,!0,c),$[ne]=Lt(S,$[ne]);const Ue=$[0],Ve=x(Ue)||a,Ee=s.convert(S.format,S.encoding),xe=s.convert(S.type),N=T(S.internalFormat,Ee,xe,S.encoding),pe=a&&!0!==S.isVideoTexture,ue=void 0===A.__version;let de,Ge=C(S,Ue,Ve);if(we(34067,S,Ve),he){pe&&ue&&t.texStorage2D(34067,Ge,N,Ue.width,Ue.height);for(let ne=0;ne<6;ne++){de=$[ne].mipmaps;for(let ze=0;ze<de.length;ze++){const st=de[ze];S.format!==Xn?null!==Ee?pe?t.compressedTexSubImage2D(34069+ne,ze,0,0,st.width,st.height,Ee,st.data):t.compressedTexImage2D(34069+ne,ze,N,st.width,st.height,0,st.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pe?t.texSubImage2D(34069+ne,ze,0,0,st.width,st.height,Ee,xe,st.data):t.texImage2D(34069+ne,ze,N,st.width,st.height,0,Ee,xe,st.data)}}}else{de=S.mipmaps,pe&&ue&&(de.length>0&&Ge++,t.texStorage2D(34067,Ge,N,$[0].width,$[0].height));for(let ne=0;ne<6;ne++)if(Ce){pe?t.texSubImage2D(34069+ne,0,0,0,$[ne].width,$[ne].height,Ee,xe,$[ne].data):t.texImage2D(34069+ne,0,N,$[ne].width,$[ne].height,0,Ee,xe,$[ne].data);for(let ze=0;ze<de.length;ze++){const Kn=de[ze].image[ne].image;pe?t.texSubImage2D(34069+ne,ze+1,0,0,Kn.width,Kn.height,Ee,xe,Kn.data):t.texImage2D(34069+ne,ze+1,N,Kn.width,Kn.height,0,Ee,xe,Kn.data)}}else{pe?t.texSubImage2D(34069+ne,0,0,0,Ee,xe,$[ne]):t.texImage2D(34069+ne,0,N,Ee,xe,$[ne]);for(let ze=0;ze<de.length;ze++){const st=de[ze];pe?t.texSubImage2D(34069+ne,ze+1,0,0,Ee,xe,st.image[ne]):t.texImage2D(34069+ne,ze+1,N,Ee,xe,st.image[ne])}}}w(S,Ve)&&M(34067),se.__currentVersion=se.version,S.onUpdate&&S.onUpdate(S)}A.__version=S.version}(W,A,S):(t.activeTexture(33984+S),t.bindTexture(34067,W.__webglTexture))},this.rebindTextures=function te(A,S,W){const K=i.get(A);void 0!==S&&_e(K.__webglFramebuffer,A,A.texture,36064,3553),void 0!==W&&z(A)},this.setupRenderTarget=function ie(A){const S=A.texture,W=i.get(A),K=i.get(S);A.addEventListener("dispose",b),!0!==A.isWebGLMultipleRenderTargets&&(void 0===K.__webglTexture&&(K.__webglTexture=n.createTexture()),K.__version=S.version,o.memory.textures++);const se=!0===A.isWebGLCubeRenderTarget,he=!0===A.isWebGLMultipleRenderTargets,Ce=x(A)||a;if(se){W.__webglFramebuffer=[];for(let $=0;$<6;$++)W.__webglFramebuffer[$]=n.createFramebuffer()}else if(W.__webglFramebuffer=n.createFramebuffer(),he)if(r.drawBuffers){const $=A.texture;for(let Ue=0,Ve=$.length;Ue<Ve;Ue++){const Ee=i.get($[Ue]);void 0===Ee.__webglTexture&&(Ee.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(a&&A.samples>0&&!1===Me(A)){W.__webglMultisampledFramebuffer=n.createFramebuffer(),W.__webglColorRenderbuffer=n.createRenderbuffer(),n.bindRenderbuffer(36161,W.__webglColorRenderbuffer);const $=s.convert(S.format,S.encoding),Ue=s.convert(S.type),Ve=T(S.internalFormat,$,Ue,S.encoding),Ee=Pe(A);n.renderbufferStorageMultisample(36161,Ee,Ve,A.width,A.height),t.bindFramebuffer(36160,W.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064,36161,W.__webglColorRenderbuffer),n.bindRenderbuffer(36161,null),A.depthBuffer&&(W.__webglDepthRenderbuffer=n.createRenderbuffer(),ve(W.__webglDepthRenderbuffer,A,!0)),t.bindFramebuffer(36160,null)}if(se){t.bindTexture(34067,K.__webglTexture),we(34067,S,Ce);for(let $=0;$<6;$++)_e(W.__webglFramebuffer[$],A,S,36064,34069+$);w(S,Ce)&&M(34067),t.unbindTexture()}else if(he){const $=A.texture;for(let Ue=0,Ve=$.length;Ue<Ve;Ue++){const Ee=$[Ue],xe=i.get(Ee);t.bindTexture(3553,xe.__webglTexture),we(3553,Ee,Ce),_e(W.__webglFramebuffer,A,Ee,36064+Ue,3553),w(Ee,Ce)&&M(3553)}t.unbindTexture()}else{let $=3553;(A.isWebGL3DRenderTarget||A.isWebGLArrayRenderTarget)&&(a?$=A.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture($,K.__webglTexture),we($,S,Ce),_e(W.__webglFramebuffer,A,S,36064,$),w(S,Ce)&&M($),t.unbindTexture()}A.depthBuffer&&z(A)},this.updateRenderTargetMipmap=function ye(A){const S=x(A)||a,W=!0===A.isWebGLMultipleRenderTargets?A.texture:[A.texture];for(let K=0,se=W.length;K<se;K++){const he=W[K];if(w(he,S)){const Ce=A.isWebGLCubeRenderTarget?34067:3553,$=i.get(he).__webglTexture;t.bindTexture(Ce,$),M(Ce),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function ce(A){if(a&&A.samples>0&&!1===Me(A)){const S=A.width,W=A.height;let K=16384;const se=[36064],he=A.stencilBuffer?33306:36096;A.depthBuffer&&se.push(he);const Ce=i.get(A),$=void 0===Ce.__ignoreDepthValues||Ce.__ignoreDepthValues;!1===$&&(A.depthBuffer&&(K|=256),A.stencilBuffer&&(K|=1024)),t.bindFramebuffer(36008,Ce.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Ce.__webglFramebuffer),!0===$&&(n.invalidateFramebuffer(36008,[he]),n.invalidateFramebuffer(36009,[he])),n.blitFramebuffer(0,0,S,W,0,0,S,W,K,9728),n.invalidateFramebuffer(36008,se),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,Ce.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=z,this.setupFrameBufferTexture=_e,this.useMultisampledRTT=Me}function l8(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===_o)return 5121;if(s===yz)return 32819;if(s===_z)return 32820;if(s===pz)return 5120;if(s===mz)return 5122;if(s===qc)return 5123;if(s===gz)return 5124;if(s===Vf)return 5125;if(s===xs)return 5126;if(s===ja)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===vz)return 6406;if(s===Xn)return 6408;if(s===wz)return 6409;if(s===bz)return 6410;if(s===vo)return 6402;if(s===qa)return 34041;if(s===Mz)return 6403;if(s===xz)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===i_)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===Sz)return 36244;if(s===Ez)return 33319;if(s===Tz)return 33320;if(s===Dz)return 36249;if(s===Zy||s===Ky||s===Jy||s===Qy)if(o===xt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===Zy)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Ky)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Jy)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Qy)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===Zy)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Ky)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Jy)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Qy)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===gD||s===yD||s===_D||s===vD){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===gD)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===yD)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===_D)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===vD)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===Cz)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===xD||s===wD){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===xD)return o===xt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===wD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===bD||s===MD||s===SD||s===ED||s===TD||s===DD||s===CD||s===AD||s===ID||s===RD||s===PD||s===LD||s===ND||s===FD){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===bD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===MD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===SD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===ED)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===TD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===DD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===CD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===AD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===ID)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===RD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===PD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===LD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===ND)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===FD)return o===xt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===OD){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===OD)return o===xt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===$a?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class R1 extends Bt{constructor(e=[]){super(),this.cameras=e}}R1.prototype.isArrayCamera=!0;class _r extends ut{constructor(){super(),this.type="Group"}}_r.prototype.isGroup=!0;const c8={type:"move"};class U_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new _r,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new _r,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new E,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new E),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new _r,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new E,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new E),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&(r=t.getPose(e.targetRaySpace,i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(c8))),c&&e.hand){o=!0;for(const g of e.hand.values()){const _=t.getJointPose(g,i);if(void 0===c.joints[g.jointName]){const m=new _r;m.matrixAutoUpdate=!1,m.visible=!1,c.joints[g.jointName]=m,c.add(m)}const y=c.joints[g.jointName];null!==_&&(y.matrix.fromArray(_.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=_.radius),y.visible=null!==_}const f=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),h=.02,p=.005;c.inputState.pinching&&f>h+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&f<=h-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}}class P1 extends Fn{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:vo)!==vo&&u!==qa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===vo&&(i=qc),void 0===i&&u===qa&&(i=$a),super(null,r,s,o,a,l,u,i,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:an,this.minFilter=void 0!==l?l:an,this.flipY=!1,this.generateMipmaps=!1}}P1.prototype.isDepthTexture=!0;class u8 extends wo{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=null,c=null,u=null,d=null,f=null;const h=t.getContextAttributes();let p=null,g=null;const _=[],y=new Map,m=new Bt;m.layers.enable(1),m.viewport=new gt;const x=new Bt;x.layers.enable(2),x.viewport=new gt;const v=[m,x],w=new R1;w.layers.enable(1),w.layers.enable(2);let M=null,T=null;function C(k){const j=y.get(k.inputSource);j&&j.dispatchEvent({type:k.type,data:k.inputSource})}function R(){y.forEach(function(k,j){k.disconnect(j)}),y.clear(),M=null,T=null,e.setRenderTarget(p),d=null,u=null,c=null,r=null,g=null,U.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function P(k){const j=r.inputSources;for(let J=0;J<_.length;J++)y.set(j[J],_[J]);for(let J=0;J<k.removed.length;J++){const Q=k.removed[J],ee=y.get(Q);ee&&(ee.dispatchEvent({type:"disconnected",data:Q}),y.delete(Q))}for(let J=0;J<k.added.length;J++){const Q=k.added[J],ee=y.get(Q);ee&&ee.dispatchEvent({type:"connected",data:Q})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(k){let j=_[k];return void 0===j&&(j=new U_,_[k]=j),j.getTargetRaySpace()},this.getControllerGrip=function(k){let j=_[k];return void 0===j&&(j=new U_,_[k]=j),j.getGripSpace()},this.getHand=function(k){let j=_[k];return void 0===j&&(j=new U_,_[k]=j),j.getHandSpace()},this.setFramebufferScaleFactor=function(k){s=k,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(k){a=k,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return null!==u?u:d},this.getBinding=function(){return c},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=function(){var k=function BV(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){sD(s,i,r,o,a,"next",l)}function a(l){sD(s,i,r,o,a,"throw",l)}o(void 0)})}}(function*(j){if(r=j,null!==r){if(p=e.getRenderTarget(),r.addEventListener("select",C),r.addEventListener("selectstart",C),r.addEventListener("selectend",C),r.addEventListener("squeeze",C),r.addEventListener("squeezestart",C),r.addEventListener("squeezeend",C),r.addEventListener("end",R),r.addEventListener("inputsourceschange",P),!0!==h.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||h.antialias,alpha:h.alpha,depth:h.depth,stencil:h.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:d}),g=new ai(d.framebufferWidth,d.framebufferHeight,{format:Xn,type:_o,encoding:e.outputEncoding});else{let J=null,Q=null,ee=null;h.depth&&(ee=h.stencil?35056:33190,J=h.stencil?qa:vo,Q=h.stencil?$a:qc);const be={colorFormat:e.outputEncoding===xt?35907:32856,depthFormat:ee,scaleFactor:s};c=new XRWebGLBinding(r,t),u=c.createProjectionLayer(be),r.updateRenderState({layers:[u]}),g=new ai(u.textureWidth,u.textureHeight,{format:Xn,type:_o,depthTexture:new P1(u.textureWidth,u.textureHeight,Q,void 0,void 0,void 0,void 0,void 0,void 0,J),stencilBuffer:h.stencil,encoding:e.outputEncoding,samples:h.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),o=yield r.requestReferenceSpace(a),U.setContext(r),U.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(j){return k.apply(this,arguments)}}();const b=new E,I=new E;function F(k,j){null===j?k.matrixWorld.copy(k.matrix):k.matrixWorld.multiplyMatrices(j.matrixWorld,k.matrix),k.matrixWorldInverse.copy(k.matrixWorld).invert()}this.updateCamera=function(k){if(null===r)return;w.near=x.near=m.near=k.near,w.far=x.far=m.far=k.far,(M!==w.near||T!==w.far)&&(r.updateRenderState({depthNear:w.near,depthFar:w.far}),M=w.near,T=w.far);const j=k.parent,J=w.cameras;F(w,j);for(let ee=0;ee<J.length;ee++)F(J[ee],j);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),k.position.copy(w.position),k.quaternion.copy(w.quaternion),k.scale.copy(w.scale),k.matrix.copy(w.matrix),k.matrixWorld.copy(w.matrixWorld);const Q=k.children;for(let ee=0,be=Q.length;ee<be;ee++)Q[ee].updateMatrixWorld(!0);2===J.length?function L(k,j,J){b.setFromMatrixPosition(j.matrixWorld),I.setFromMatrixPosition(J.matrixWorld);const Q=b.distanceTo(I),ee=j.projectionMatrix.elements,be=J.projectionMatrix.elements,He=ee[14]/(ee[10]-1),we=ee[14]/(ee[10]+1),Z=(ee[9]+1)/ee[5],dt=(ee[9]-1)/ee[5],$e=(ee[8]-1)/ee[0],_e=(be[8]+1)/be[0],ve=He*$e,nt=He*_e,z=Q/(-$e+_e),te=z*-$e;j.matrixWorld.decompose(k.position,k.quaternion,k.scale),k.translateX(te),k.translateZ(z),k.matrixWorld.compose(k.position,k.quaternion,k.scale),k.matrixWorldInverse.copy(k.matrixWorld).invert();const ie=He+z,ye=we+z;k.projectionMatrix.makePerspective(ve-te,nt+(Q-te),Z*we/ye*ie,dt*we/ye*ie,ie,ye)}(w,m,x):w.projectionMatrix.copy(m.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(k){null!==u&&(u.fixedFoveation=k),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=k)};let O=null;const U=new e1;U.setAnimationLoop(function B(k,j){if(l=j.getViewerPose(o),f=j,null!==l){const Q=l.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let ee=!1;Q.length!==w.cameras.length&&(w.cameras.length=0,ee=!0);for(let be=0;be<Q.length;be++){const He=Q[be];let we=null;if(null!==d)we=d.getViewport(He);else{const dt=c.getViewSubImage(u,He);we=dt.viewport,0===be&&(e.setRenderTargetTextures(g,dt.colorTexture,u.ignoreDepthValues?void 0:dt.depthStencilTexture),e.setRenderTarget(g))}const Z=v[be];Z.matrix.fromArray(He.transform.matrix),Z.projectionMatrix.fromArray(He.projectionMatrix),Z.viewport.set(we.x,we.y,we.width,we.height),0===be&&w.matrix.copy(Z.matrix),!0===ee&&w.cameras.push(Z)}}const J=r.inputSources;for(let Q=0;Q<_.length;Q++)_[Q].update(J[Q],j,o);O&&O(k,j),f=null}),this.setAnimationLoop=function(k){O=k},this.dispose=function(){}}}function d8(n){function i(y,m){y.opacity.value=m.opacity,m.color&&y.diffuse.value.copy(m.color),m.emissive&&y.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(y.map.value=m.map),m.alphaMap&&(y.alphaMap.value=m.alphaMap),m.specularMap&&(y.specularMap.value=m.specularMap),m.alphaTest>0&&(y.alphaTest.value=m.alphaTest);const x=n.get(m).envMap;let v,w;x&&(y.envMap.value=x,y.flipEnvMap.value=x.isCubeTexture&&!1===x.isRenderTargetTexture?-1:1,y.reflectivity.value=m.reflectivity,y.ior.value=m.ior,y.refractionRatio.value=m.refractionRatio),m.lightMap&&(y.lightMap.value=m.lightMap,y.lightMapIntensity.value=m.lightMapIntensity),m.aoMap&&(y.aoMap.value=m.aoMap,y.aoMapIntensity.value=m.aoMapIntensity),m.map?v=m.map:m.specularMap?v=m.specularMap:m.displacementMap?v=m.displacementMap:m.normalMap?v=m.normalMap:m.bumpMap?v=m.bumpMap:m.roughnessMap?v=m.roughnessMap:m.metalnessMap?v=m.metalnessMap:m.alphaMap?v=m.alphaMap:m.emissiveMap?v=m.emissiveMap:m.clearcoatMap?v=m.clearcoatMap:m.clearcoatNormalMap?v=m.clearcoatNormalMap:m.clearcoatRoughnessMap?v=m.clearcoatRoughnessMap:m.specularIntensityMap?v=m.specularIntensityMap:m.specularColorMap?v=m.specularColorMap:m.transmissionMap?v=m.transmissionMap:m.thicknessMap?v=m.thicknessMap:m.sheenColorMap?v=m.sheenColorMap:m.sheenRoughnessMap&&(v=m.sheenRoughnessMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),y.uvTransform.value.copy(v.matrix)),m.aoMap?w=m.aoMap:m.lightMap&&(w=m.lightMap),void 0!==w&&(w.isWebGLRenderTarget&&(w=w.texture),!0===w.matrixAutoUpdate&&w.updateMatrix(),y.uv2Transform.value.copy(w.matrix))}function d(y,m){y.roughness.value=m.roughness,y.metalness.value=m.metalness,m.roughnessMap&&(y.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(y.metalnessMap.value=m.metalnessMap),m.emissiveMap&&(y.emissiveMap.value=m.emissiveMap),m.bumpMap&&(y.bumpMap.value=m.bumpMap,y.bumpScale.value=m.bumpScale,m.side===on&&(y.bumpScale.value*=-1)),m.normalMap&&(y.normalMap.value=m.normalMap,y.normalScale.value.copy(m.normalScale),m.side===on&&y.normalScale.value.negate()),m.displacementMap&&(y.displacementMap.value=m.displacementMap,y.displacementScale.value=m.displacementScale,y.displacementBias.value=m.displacementBias),n.get(m).envMap&&(y.envMapIntensity.value=m.envMapIntensity)}return{refreshFogUniforms:function e(y,m){y.fogColor.value.copy(m.color),m.isFog?(y.fogNear.value=m.near,y.fogFar.value=m.far):m.isFogExp2&&(y.fogDensity.value=m.density)},refreshMaterialUniforms:function t(y,m,x,v,w){m.isMeshBasicMaterial?i(y,m):m.isMeshLambertMaterial?(i(y,m),function l(y,m){m.emissiveMap&&(y.emissiveMap.value=m.emissiveMap)}(y,m)):m.isMeshToonMaterial?(i(y,m),function u(y,m){m.gradientMap&&(y.gradientMap.value=m.gradientMap),m.emissiveMap&&(y.emissiveMap.value=m.emissiveMap),m.bumpMap&&(y.bumpMap.value=m.bumpMap,y.bumpScale.value=m.bumpScale,m.side===on&&(y.bumpScale.value*=-1)),m.normalMap&&(y.normalMap.value=m.normalMap,y.normalScale.value.copy(m.normalScale),m.side===on&&y.normalScale.value.negate()),m.displacementMap&&(y.displacementMap.value=m.displacementMap,y.displacementScale.value=m.displacementScale,y.displacementBias.value=m.displacementBias)}(y,m)):m.isMeshPhongMaterial?(i(y,m),function c(y,m){y.specular.value.copy(m.specular),y.shininess.value=Math.max(m.shininess,1e-4),m.emissiveMap&&(y.emissiveMap.value=m.emissiveMap),m.bumpMap&&(y.bumpMap.value=m.bumpMap,y.bumpScale.value=m.bumpScale,m.side===on&&(y.bumpScale.value*=-1)),m.normalMap&&(y.normalMap.value=m.normalMap,y.normalScale.value.copy(m.normalScale),m.side===on&&y.normalScale.value.negate()),m.displacementMap&&(y.displacementMap.value=m.displacementMap,y.displacementScale.value=m.displacementScale,y.displacementBias.value=m.displacementBias)}(y,m)):m.isMeshStandardMaterial?(i(y,m),m.isMeshPhysicalMaterial?function f(y,m,x){d(y,m),y.ior.value=m.ior,m.sheen>0&&(y.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),y.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(y.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(y.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(y.clearcoat.value=m.clearcoat,y.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(y.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),y.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===on&&y.clearcoatNormalScale.value.negate())),m.transmission>0&&(y.transmission.value=m.transmission,y.transmissionSamplerMap.value=x.texture,y.transmissionSamplerSize.value.set(x.width,x.height),m.transmissionMap&&(y.transmissionMap.value=m.transmissionMap),y.thickness.value=m.thickness,m.thicknessMap&&(y.thicknessMap.value=m.thicknessMap),y.attenuationDistance.value=m.attenuationDistance,y.attenuationColor.value.copy(m.attenuationColor)),y.specularIntensity.value=m.specularIntensity,y.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(y.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(y.specularColorMap.value=m.specularColorMap)}(y,m,w):d(y,m)):m.isMeshMatcapMaterial?(i(y,m),function h(y,m){m.matcap&&(y.matcap.value=m.matcap),m.bumpMap&&(y.bumpMap.value=m.bumpMap,y.bumpScale.value=m.bumpScale,m.side===on&&(y.bumpScale.value*=-1)),m.normalMap&&(y.normalMap.value=m.normalMap,y.normalScale.value.copy(m.normalScale),m.side===on&&y.normalScale.value.negate()),m.displacementMap&&(y.displacementMap.value=m.displacementMap,y.displacementScale.value=m.displacementScale,y.displacementBias.value=m.displacementBias)}(y,m)):m.isMeshDepthMaterial?(i(y,m),function p(y,m){m.displacementMap&&(y.displacementMap.value=m.displacementMap,y.displacementScale.value=m.displacementScale,y.displacementBias.value=m.displacementBias)}(y,m)):m.isMeshDistanceMaterial?(i(y,m),function g(y,m){m.displacementMap&&(y.displacementMap.value=m.displacementMap,y.displacementScale.value=m.displacementScale,y.displacementBias.value=m.displacementBias),y.referencePosition.value.copy(m.referencePosition),y.nearDistance.value=m.nearDistance,y.farDistance.value=m.farDistance}(y,m)):m.isMeshNormalMaterial?(i(y,m),function _(y,m){m.bumpMap&&(y.bumpMap.value=m.bumpMap,y.bumpScale.value=m.bumpScale,m.side===on&&(y.bumpScale.value*=-1)),m.normalMap&&(y.normalMap.value=m.normalMap,y.normalScale.value.copy(m.normalScale),m.side===on&&y.normalScale.value.negate()),m.displacementMap&&(y.displacementMap.value=m.displacementMap,y.displacementScale.value=m.displacementScale,y.displacementBias.value=m.displacementBias)}(y,m)):m.isLineBasicMaterial?(function r(y,m){y.diffuse.value.copy(m.color),y.opacity.value=m.opacity}(y,m),m.isLineDashedMaterial&&function s(y,m){y.dashSize.value=m.dashSize,y.totalSize.value=m.dashSize+m.gapSize,y.scale.value=m.scale}(y,m)):m.isPointsMaterial?function o(y,m,x,v){let w;y.diffuse.value.copy(m.color),y.opacity.value=m.opacity,y.size.value=m.size*x,y.scale.value=.5*v,m.map&&(y.map.value=m.map),m.alphaMap&&(y.alphaMap.value=m.alphaMap),m.alphaTest>0&&(y.alphaTest.value=m.alphaTest),m.map?w=m.map:m.alphaMap&&(w=m.alphaMap),void 0!==w&&(!0===w.matrixAutoUpdate&&w.updateMatrix(),y.uvTransform.value.copy(w.matrix))}(y,m,x,v):m.isSpriteMaterial?function a(y,m){let x;y.diffuse.value.copy(m.color),y.opacity.value=m.opacity,y.rotation.value=m.rotation,m.map&&(y.map.value=m.map),m.alphaMap&&(y.alphaMap.value=m.alphaMap),m.alphaTest>0&&(y.alphaTest.value=m.alphaTest),m.map?x=m.map:m.alphaMap&&(x=m.alphaMap),void 0!==x&&(!0===x.matrixAutoUpdate&&x.updateMatrix(),y.uvTransform.value.copy(x.matrix))}(y,m):m.isShadowMaterial?(y.color.value.copy(m.color),y.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function _t(n={}){const e=void 0!==n.canvas?n.canvas:function f8(){const n=Qc("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=void 0!==n.context?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let d=null,f=null;const h=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ws,this.physicallyCorrectLights=!1,this.toneMapping=_s,this.toneMappingExposure=1;const g=this;let _=!1,y=0,m=0,x=null,v=-1,w=null;const M=new gt,T=new gt;let C=null,R=e.width,P=e.height,b=1,I=null,L=null;const F=new gt(0,0,R,P),O=new gt(0,0,R,P);let B=!1;const U=new dh;let k=!1,j=!1,J=null;const Q=new me,ee=new X,be=new E,He={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function we(){return null===x?b:1}let $e,_e,ve,nt,z,te,ie,ye,ce,Pe,Me,Xe,Lt,A,S,W,K,se,he,Ce,$,Ue,Ve,Z=t;function dt(D,H){for(let G=0;G<D.length;G++){const Y=e.getContext(D[G],H);if(null!==Y)return Y}return null}try{const D={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r138"),e.addEventListener("webglcontextlost",N,!1),e.addEventListener("webglcontextrestored",pe,!1),null===Z){const H=["webgl2","webgl","experimental-webgl"];if(!0===g.isWebGL1Renderer&&H.shift(),Z=dt(H,D),null===Z)throw dt(H)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Z.getShaderPrecisionFormat&&(Z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}function Ee(){$e=new I5(Z),_e=new S5(Z,$e,n),$e.init(_e),Ue=new l8(Z,$e,_e),ve=new o8(Z,$e,_e),nt=new L5(Z),z=new YW,te=new a8(Z,$e,ve,z,_e,Ue,nt),ie=new T5(g),ye=new A5(g),ce=new EG(Z,_e),Ve=new b5(Z,$e,ce,_e),Pe=new R5(Z,ce,nt,Ve),Me=new k5(Z,Pe,ce,nt),he=new O5(Z,_e,te),W=new E5(z),Xe=new XW(g,ie,ye,$e,_e,Ve,W),Lt=new d8(z),A=new KW,S=new i8($e,_e),se=new w5(g,ie,ve,Me,u,o),K=new I1(g,Me,_e),Ce=new M5(Z,$e,nt,_e),$=new P5(Z,$e,nt,_e),nt.programs=Xe.programs,g.capabilities=_e,g.extensions=$e,g.properties=z,g.renderLists=A,g.shadowMap=K,g.state=ve,g.info=nt}Ee();const xe=new u8(g,Z);function N(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function pe(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const D=nt.autoReset,H=K.enabled,G=K.autoUpdate,V=K.needsUpdate,Y=K.type;Ee(),nt.autoReset=D,K.enabled=H,K.autoUpdate=G,K.needsUpdate=V,K.type=Y}function ue(D){const H=D.target;H.removeEventListener("dispose",ue),function Ge(D){(function de(D){const H=z.get(D).programs;void 0!==H&&(H.forEach(function(G){Xe.releaseProgram(G)}),D.isShaderMaterial&&Xe.releaseShaderCache(D))})(D),z.remove(D)}(H)}this.xr=xe,this.getContext=function(){return Z},this.getContextAttributes=function(){return Z.getContextAttributes()},this.forceContextLoss=function(){const D=$e.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=$e.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return b},this.setPixelRatio=function(D){void 0!==D&&(b=D,this.setSize(R,P,!1))},this.getSize=function(D){return D.set(R,P)},this.setSize=function(D,H,G){xe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(R=D,P=H,e.width=Math.floor(D*b),e.height=Math.floor(H*b),!1!==G&&(e.style.width=D+"px",e.style.height=H+"px"),this.setViewport(0,0,D,H))},this.getDrawingBufferSize=function(D){return D.set(R*b,P*b).floor()},this.setDrawingBufferSize=function(D,H,G){R=D,P=H,b=G,e.width=Math.floor(D*G),e.height=Math.floor(H*G),this.setViewport(0,0,D,H)},this.getCurrentViewport=function(D){return D.copy(M)},this.getViewport=function(D){return D.copy(F)},this.setViewport=function(D,H,G,V){D.isVector4?F.set(D.x,D.y,D.z,D.w):F.set(D,H,G,V),ve.viewport(M.copy(F).multiplyScalar(b).floor())},this.getScissor=function(D){return D.copy(O)},this.setScissor=function(D,H,G,V){D.isVector4?O.set(D.x,D.y,D.z,D.w):O.set(D,H,G,V),ve.scissor(T.copy(O).multiplyScalar(b).floor())},this.getScissorTest=function(){return B},this.setScissorTest=function(D){ve.setScissorTest(B=D)},this.setOpaqueSort=function(D){I=D},this.setTransparentSort=function(D){L=D},this.getClearColor=function(D){return D.copy(se.getClearColor())},this.setClearColor=function(){se.setClearColor.apply(se,arguments)},this.getClearAlpha=function(){return se.getClearAlpha()},this.setClearAlpha=function(){se.setClearAlpha.apply(se,arguments)},this.clear=function(D=!0,H=!0,G=!0){let V=0;D&&(V|=16384),H&&(V|=256),G&&(V|=1024),Z.clear(V)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",N,!1),e.removeEventListener("webglcontextrestored",pe,!1),A.dispose(),S.dispose(),z.dispose(),ie.dispose(),ye.dispose(),Me.dispose(),Ve.dispose(),Xe.dispose(),xe.dispose(),xe.removeEventListener("sessionstart",st),xe.removeEventListener("sessionend",Kn),J&&(J.dispose(),J=null),Mt.stop()},this.renderBufferDirect=function(D,H,G,V,Y,Ne){null===H&&(H=He);const je=Y.isMesh&&Y.matrixWorld.determinant()<0,Ze=function N$(D,H,G,V,Y){!0!==H.isScene&&(H=He),te.resetTextureUnits();const Ne=H.fog,Ze=null===x?g.outputEncoding:!0===x.isXRRenderTarget?x.texture.encoding:ws,Ye=(V.isMeshStandardMaterial?ye:ie).get(V.envMap||(V.isMeshStandardMaterial?H.environment:null)),vt=!0===V.vertexColors&&!!G.attributes.color&&4===G.attributes.color.itemSize,ot=!!V.normalMap&&!!G.attributes.tangent,lt=!!G.morphAttributes.position,qt=!!G.morphAttributes.normal,Jo=!!G.morphAttributes.color,Ul=V.toneMapped?g.toneMapping:_s,Vl=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,Cr=void 0!==Vl?Vl.length:0,pt=z.get(V),zl=f.state.lights;!0!==k||!0!==j&&D===w||W.setState(V,D,D===w&&V.id===v);let un=!1;V.version===pt.__version?(pt.needsLights&&pt.lightsStateVersion!==zl.state.version||pt.outputEncoding!==Ze||Y.isInstancedMesh&&!1===pt.instancing||!Y.isInstancedMesh&&!0===pt.instancing||Y.isSkinnedMesh&&!1===pt.skinning||!Y.isSkinnedMesh&&!0===pt.skinning||pt.envMap!==Ye||V.fog&&pt.fog!==Ne||void 0!==pt.numClippingPlanes&&(pt.numClippingPlanes!==W.numPlanes||pt.numIntersection!==W.numIntersection)||pt.vertexAlphas!==vt||pt.vertexTangents!==ot||pt.morphTargets!==lt||pt.morphNormals!==qt||pt.morphColors!==Jo||pt.toneMapping!==Ul||!0===_e.isWebGL2&&pt.morphTargetsCount!==Cr)&&(un=!0):(un=!0,pt.__version=V.version);let Ar=pt.currentProgram;!0===un&&(Ar=cv(V,H,Y));let qs=!1,Gu=!1,uv=!1;const Vn=Ar.getUniforms(),Wu=pt.uniforms;if(ve.useProgram(Ar.program)&&(qs=!0,Gu=!0,uv=!0),V.id!==v&&(v=V.id,Gu=!0),qs||w!==D){if(Vn.setValue(Z,"projectionMatrix",D.projectionMatrix),_e.logarithmicDepthBuffer&&Vn.setValue(Z,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),w!==D&&(w=D,Gu=!0,uv=!0),V.isShaderMaterial||V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshStandardMaterial||V.envMap){const nr=Vn.map.cameraPosition;void 0!==nr&&nr.setValue(Z,be.setFromMatrixPosition(D.matrixWorld))}(V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshLambertMaterial||V.isMeshBasicMaterial||V.isMeshStandardMaterial||V.isShaderMaterial)&&Vn.setValue(Z,"isOrthographic",!0===D.isOrthographicCamera),(V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshLambertMaterial||V.isMeshBasicMaterial||V.isMeshStandardMaterial||V.isShaderMaterial||V.isShadowMaterial||Y.isSkinnedMesh)&&Vn.setValue(Z,"viewMatrix",D.matrixWorldInverse)}if(Y.isSkinnedMesh){Vn.setOptional(Z,Y,"bindMatrix"),Vn.setOptional(Z,Y,"bindMatrixInverse");const nr=Y.skeleton;nr&&(_e.floatVertexTextures?(null===nr.boneTexture&&nr.computeBoneTexture(),Vn.setValue(Z,"boneTexture",nr.boneTexture,te),Vn.setValue(Z,"boneTextureSize",nr.boneTextureSize)):Vn.setOptional(Z,nr,"boneMatrices"))}const dv=G.morphAttributes;return(void 0!==dv.position||void 0!==dv.normal||void 0!==dv.color&&!0===_e.isWebGL2)&&he.update(Y,G,V,Ar),(Gu||pt.receiveShadow!==Y.receiveShadow)&&(pt.receiveShadow=Y.receiveShadow,Vn.setValue(Z,"receiveShadow",Y.receiveShadow)),Gu&&(Vn.setValue(Z,"toneMappingExposure",g.toneMappingExposure),pt.needsLights&&function F$(D,H){D.ambientLightColor.needsUpdate=H,D.lightProbe.needsUpdate=H,D.directionalLights.needsUpdate=H,D.directionalLightShadows.needsUpdate=H,D.pointLights.needsUpdate=H,D.pointLightShadows.needsUpdate=H,D.spotLights.needsUpdate=H,D.spotLightShadows.needsUpdate=H,D.rectAreaLights.needsUpdate=H,D.hemisphereLights.needsUpdate=H,D.directionalShadowMap.needsUpdate=H,D.directionalShadowMatrix.needsUpdate=H,D.spotShadowMap.needsUpdate=H,D.spotShadowMatrix.needsUpdate=H,D.pointShadowMap.needsUpdate=H,D.pointShadowMatrix.needsUpdate=H}(Wu,uv),Ne&&V.fog&&Lt.refreshFogUniforms(Wu,Ne),Lt.refreshMaterialUniforms(Wu,V,b,P,J),Is.upload(Z,pt.uniformsList,Wu,te)),V.isShaderMaterial&&!0===V.uniformsNeedUpdate&&(Is.upload(Z,pt.uniformsList,Wu,te),V.uniformsNeedUpdate=!1),V.isSpriteMaterial&&Vn.setValue(Z,"center",Y.center),Vn.setValue(Z,"modelViewMatrix",Y.modelViewMatrix),Vn.setValue(Z,"normalMatrix",Y.normalMatrix),Vn.setValue(Z,"modelMatrix",Y.matrixWorld),Ar}(D,H,G,V,Y);ve.setMaterial(V,je);let Ye=G.index;const vt=G.attributes.position;if(null===Ye){if(void 0===vt||0===vt.count)return}else if(0===Ye.count)return;let ot=1;!0===V.wireframe&&(Ye=Pe.getWireframeAttribute(G),ot=2),Ve.setup(Y,V,Ze,G,Ye);let lt,qt=Ce;null!==Ye&&(lt=ce.get(Ye),qt=$,qt.setIndex(lt));const Jo=null!==Ye?Ye.count:vt.count,Ul=G.drawRange.start*ot,Vl=G.drawRange.count*ot,Cr=null!==Ne?Ne.start*ot:0,pt=null!==Ne?Ne.count*ot:1/0,zl=Math.max(Ul,Cr),un=Math.min(Jo,Ul+Vl,Cr+pt)-1,Ar=Math.max(0,un-zl+1);if(0!==Ar){if(Y.isMesh)!0===V.wireframe?(ve.setLineWidth(V.wireframeLinewidth*we()),qt.setMode(1)):qt.setMode(4);else if(Y.isLine){let qs=V.linewidth;void 0===qs&&(qs=1),ve.setLineWidth(qs*we()),qt.setMode(Y.isLineSegments?1:Y.isLineLoop?2:3)}else Y.isPoints?qt.setMode(0):Y.isSprite&&qt.setMode(4);if(Y.isInstancedMesh)qt.renderInstances(zl,Ar,Y.count);else if(G.isInstancedBufferGeometry){const qs=Math.min(G.instanceCount,G._maxInstanceCount);qt.renderInstances(zl,Ar,qs)}else qt.render(zl,Ar)}},this.compile=function(D,H){f=S.get(D),f.init(),p.push(f),D.traverseVisible(function(G){G.isLight&&G.layers.test(H.layers)&&(f.pushLight(G),G.castShadow&&f.pushShadow(G))}),f.setupLights(g.physicallyCorrectLights),D.traverse(function(G){const V=G.material;if(V)if(Array.isArray(V))for(let Y=0;Y<V.length;Y++)cv(V[Y],D,G);else cv(V,D,G)}),p.pop(),f=null};let ne=null;function st(){Mt.stop()}function Kn(){Mt.start()}const Mt=new e1;function Tr(D,H,G,V){if(!1===D.visible)return;if(D.layers.test(H.layers))if(D.isGroup)G=D.renderOrder;else if(D.isLOD)!0===D.autoUpdate&&D.update(H);else if(D.isLight)f.pushLight(D),D.castShadow&&f.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||U.intersectsSprite(D)){V&&be.setFromMatrixPosition(D.matrixWorld).applyMatrix4(Q);const je=Me.update(D),Ze=D.material;Ze.visible&&d.push(D,je,Ze,G,be.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(D.isSkinnedMesh&&D.skeleton.frame!==nt.render.frame&&(D.skeleton.update(),D.skeleton.frame=nt.render.frame),!D.frustumCulled||U.intersectsObject(D))){V&&be.setFromMatrixPosition(D.matrixWorld).applyMatrix4(Q);const je=Me.update(D),Ze=D.material;if(Array.isArray(Ze)){const Ye=je.groups;for(let vt=0,ot=Ye.length;vt<ot;vt++){const lt=Ye[vt],qt=Ze[lt.materialIndex];qt&&qt.visible&&d.push(D,je,qt,G,be.z,lt)}}else Ze.visible&&d.push(D,je,Ze,G,be.z,null)}const Ne=D.children;for(let je=0,Ze=Ne.length;je<Ze;je++)Tr(Ne[je],H,G,V)}function Dr(D,H,G,V){const Y=D.opaque,Ne=D.transmissive,je=D.transparent;f.setupLightsView(G),Ne.length>0&&function P$(D,H,G){const V=_e.isWebGL2;null===J&&(J=new ai(1,1,{generateMipmaps:!0,type:null!==Ue.convert(ja)?ja:_o,minFilter:vs,samples:V&&!0===s?4:0})),g.getDrawingBufferSize(ee),V?J.setSize(ee.x,ee.y):J.setSize(Wf(ee.x),Wf(ee.y));const Y=g.getRenderTarget();g.setRenderTarget(J),g.clear();const Ne=g.toneMapping;g.toneMapping=_s,vp(D,H,G),g.toneMapping=Ne,te.updateMultisampleRenderTarget(J),te.updateRenderTargetMipmap(J),g.setRenderTarget(Y)}(Y,H,G),V&&ve.viewport(M.copy(V)),Y.length>0&&vp(Y,H,G),Ne.length>0&&vp(Ne,H,G),je.length>0&&vp(je,H,G),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function vp(D,H,G){const V=!0===H.isScene?H.overrideMaterial:null;for(let Y=0,Ne=D.length;Y<Ne;Y++){const je=D[Y],Ze=je.object,Ye=je.geometry,vt=null===V?je.material:V,ot=je.group;Ze.layers.test(G.layers)&&L$(Ze,H,G,Ye,vt,ot)}}function L$(D,H,G,V,Y,Ne){D.onBeforeRender(g,H,G,V,Y,Ne),D.modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),Y.onBeforeRender(g,H,G,V,D,Ne),!0===Y.transparent&&Y.side===po?(Y.side=on,Y.needsUpdate=!0,g.renderBufferDirect(G,H,V,Y,D,Ne),Y.side=ho,Y.needsUpdate=!0,g.renderBufferDirect(G,H,V,Y,D,Ne),Y.side=po):g.renderBufferDirect(G,H,V,Y,D,Ne),D.onAfterRender(g,H,G,V,Y,Ne)}function cv(D,H,G){!0!==H.isScene&&(H=He);const V=z.get(D),Y=f.state.lights,je=Y.state.version,Ze=Xe.getParameters(D,Y.state,f.state.shadowsArray,H,G),Ye=Xe.getProgramCacheKey(Ze);let vt=V.programs;V.environment=D.isMeshStandardMaterial?H.environment:null,V.fog=H.fog,V.envMap=(D.isMeshStandardMaterial?ye:ie).get(D.envMap||V.environment),void 0===vt&&(D.addEventListener("dispose",ue),vt=new Map,V.programs=vt);let ot=vt.get(Ye);if(void 0!==ot){if(V.currentProgram===ot&&V.lightsStateVersion===je)return DI(D,Ze),ot}else Ze.uniforms=Xe.getUniforms(D),D.onBuild(G,Ze,g),D.onBeforeCompile(Ze,g),ot=Xe.acquireProgram(Ze,Ye),vt.set(Ye,ot),V.uniforms=Ze.uniforms;const lt=V.uniforms;(!D.isShaderMaterial&&!D.isRawShaderMaterial||!0===D.clipping)&&(lt.clippingPlanes=W.uniform),DI(D,Ze),V.needsLights=function O$(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&!0===D.lights}(D),V.lightsStateVersion=je,V.needsLights&&(lt.ambientLightColor.value=Y.state.ambient,lt.lightProbe.value=Y.state.probe,lt.directionalLights.value=Y.state.directional,lt.directionalLightShadows.value=Y.state.directionalShadow,lt.spotLights.value=Y.state.spot,lt.spotLightShadows.value=Y.state.spotShadow,lt.rectAreaLights.value=Y.state.rectArea,lt.ltc_1.value=Y.state.rectAreaLTC1,lt.ltc_2.value=Y.state.rectAreaLTC2,lt.pointLights.value=Y.state.point,lt.pointLightShadows.value=Y.state.pointShadow,lt.hemisphereLights.value=Y.state.hemi,lt.directionalShadowMap.value=Y.state.directionalShadowMap,lt.directionalShadowMatrix.value=Y.state.directionalShadowMatrix,lt.spotShadowMap.value=Y.state.spotShadowMap,lt.spotShadowMatrix.value=Y.state.spotShadowMatrix,lt.pointShadowMap.value=Y.state.pointShadowMap,lt.pointShadowMatrix.value=Y.state.pointShadowMatrix);const qt=ot.getUniforms(),Jo=Is.seqWithValue(qt.seq,lt);return V.currentProgram=ot,V.uniformsList=Jo,ot}function DI(D,H){const G=z.get(D);G.outputEncoding=H.outputEncoding,G.instancing=H.instancing,G.skinning=H.skinning,G.morphTargets=H.morphTargets,G.morphNormals=H.morphNormals,G.morphColors=H.morphColors,G.morphTargetsCount=H.morphTargetsCount,G.numClippingPlanes=H.numClippingPlanes,G.numIntersection=H.numClipIntersection,G.vertexAlphas=H.vertexAlphas,G.vertexTangents=H.vertexTangents,G.toneMapping=H.toneMapping}Mt.setAnimationLoop(function ze(D){ne&&ne(D)}),typeof window<"u"&&Mt.setContext(window),this.setAnimationLoop=function(D){ne=D,xe.setAnimationLoop(D),null===D?Mt.stop():Mt.start()},xe.addEventListener("sessionstart",st),xe.addEventListener("sessionend",Kn),this.render=function(D,H){if(void 0===H||!0===H.isCamera){if(!0!==_){if(!0===D.autoUpdate&&D.updateMatrixWorld(),null===H.parent&&H.updateMatrixWorld(),!0===xe.enabled&&!0===xe.isPresenting&&(!0===xe.cameraAutoUpdate&&xe.updateCamera(H),H=xe.getCamera()),!0===D.isScene&&D.onBeforeRender(g,D,H,x),f=S.get(D,p.length),f.init(),p.push(f),Q.multiplyMatrices(H.projectionMatrix,H.matrixWorldInverse),U.setFromProjectionMatrix(Q),j=this.localClippingEnabled,k=W.init(this.clippingPlanes,j,H),d=A.get(D,h.length),d.init(),h.push(d),Tr(D,H,0,g.sortObjects),d.finish(),!0===g.sortObjects&&d.sort(I,L),!0===k&&W.beginShadows(),K.render(f.state.shadowsArray,D,H),!0===k&&W.endShadows(),!0===this.info.autoReset&&this.info.reset(),se.render(d,D),f.setupLights(g.physicallyCorrectLights),H.isArrayCamera){const V=H.cameras;for(let Y=0,Ne=V.length;Y<Ne;Y++){const je=V[Y];Dr(d,D,je,je.viewport)}}else Dr(d,D,H);null!==x&&(te.updateMultisampleRenderTarget(x),te.updateRenderTargetMipmap(x)),!0===D.isScene&&D.onAfterRender(g,D,H),Ve.resetDefaultState(),v=-1,w=null,p.pop(),f=p.length>0?p[p.length-1]:null,h.pop(),d=h.length>0?h[h.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return m},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(D,H,G){z.get(D.texture).__webglTexture=H,z.get(D.depthTexture).__webglTexture=G;const V=z.get(D);V.__hasExternalTextures=!0,V.__hasExternalTextures&&(V.__autoAllocateDepthBuffer=void 0===G,V.__autoAllocateDepthBuffer||!0===$e.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),D.useRenderToTexture=!1,D.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(D,H){const G=z.get(D);G.__webglFramebuffer=H,G.__useDefaultFramebuffer=void 0===H},this.setRenderTarget=function(D,H=0,G=0){x=D,y=H,m=G;let V=!0;if(D){const Ye=z.get(D);void 0!==Ye.__useDefaultFramebuffer?(ve.bindFramebuffer(36160,null),V=!1):void 0===Ye.__webglFramebuffer?te.setupRenderTarget(D):Ye.__hasExternalTextures&&te.rebindTextures(D,z.get(D.texture).__webglTexture,z.get(D.depthTexture).__webglTexture)}let Y=null,Ne=!1,je=!1;if(D){const Ye=D.texture;(Ye.isData3DTexture||Ye.isDataArrayTexture)&&(je=!0);const vt=z.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(Y=vt[H],Ne=!0):Y=_e.isWebGL2&&D.samples>0&&!1===te.useMultisampledRTT(D)?z.get(D).__webglMultisampledFramebuffer:vt,M.copy(D.viewport),T.copy(D.scissor),C=D.scissorTest}else M.copy(F).multiplyScalar(b).floor(),T.copy(O).multiplyScalar(b).floor(),C=B;if(ve.bindFramebuffer(36160,Y)&&_e.drawBuffers&&V&&ve.drawBuffers(D,Y),ve.viewport(M),ve.scissor(T),ve.setScissorTest(C),Ne){const Ye=z.get(D.texture);Z.framebufferTexture2D(36160,36064,34069+H,Ye.__webglTexture,G)}else if(je){const Ye=z.get(D.texture);Z.framebufferTextureLayer(36160,36064,Ye.__webglTexture,G||0,H||0)}v=-1},this.readRenderTargetPixels=function(D,H,G,V,Y,Ne,je){if(!D||!D.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ze=z.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&void 0!==je&&(Ze=Ze[je]),Ze){ve.bindFramebuffer(36160,Ze);try{const Ye=D.texture,vt=Ye.format,ot=Ye.type;if(vt!==Xn&&Ue.convert(vt)!==Z.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const lt=ot===ja&&($e.has("EXT_color_buffer_half_float")||_e.isWebGL2&&$e.has("EXT_color_buffer_float"));if(!(ot===_o||Ue.convert(ot)===Z.getParameter(35738)||ot===xs&&(_e.isWebGL2||$e.has("OES_texture_float")||$e.has("WEBGL_color_buffer_float"))||lt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Z.checkFramebufferStatus(36160)?H>=0&&H<=D.width-V&&G>=0&&G<=D.height-Y&&Z.readPixels(H,G,V,Y,Ue.convert(vt),Ue.convert(ot),Ne):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ye=null!==x?z.get(x).__webglFramebuffer:null;ve.bindFramebuffer(36160,Ye)}}},this.copyFramebufferToTexture=function(D,H,G=0){if(!0!==H.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const V=Math.pow(2,-G),Y=Math.floor(H.image.width*V),Ne=Math.floor(H.image.height*V);te.setTexture2D(H,0),Z.copyTexSubImage2D(3553,G,0,0,D.x,D.y,Y,Ne),ve.unbindTexture()},this.copyTextureToTexture=function(D,H,G,V=0){const Y=H.image.width,Ne=H.image.height,je=Ue.convert(G.format),Ze=Ue.convert(G.type);te.setTexture2D(G,0),Z.pixelStorei(37440,G.flipY),Z.pixelStorei(37441,G.premultiplyAlpha),Z.pixelStorei(3317,G.unpackAlignment),H.isDataTexture?Z.texSubImage2D(3553,V,D.x,D.y,Y,Ne,je,Ze,H.image.data):H.isCompressedTexture?Z.compressedTexSubImage2D(3553,V,D.x,D.y,H.mipmaps[0].width,H.mipmaps[0].height,je,H.mipmaps[0].data):Z.texSubImage2D(3553,V,D.x,D.y,je,Ze,H.image),0===V&&G.generateMipmaps&&Z.generateMipmap(3553),ve.unbindTexture()},this.copyTextureToTexture3D=function(D,H,G,V,Y=0){if(g.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ne=D.max.x-D.min.x+1,je=D.max.y-D.min.y+1,Ze=D.max.z-D.min.z+1,Ye=Ue.convert(V.format),vt=Ue.convert(V.type);let ot;if(V.isData3DTexture)te.setTexture3D(V,0),ot=32879;else{if(!V.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");te.setTexture2DArray(V,0),ot=35866}Z.pixelStorei(37440,V.flipY),Z.pixelStorei(37441,V.premultiplyAlpha),Z.pixelStorei(3317,V.unpackAlignment);const lt=Z.getParameter(3314),qt=Z.getParameter(32878),Jo=Z.getParameter(3316),Ul=Z.getParameter(3315),Vl=Z.getParameter(32877),Cr=G.isCompressedTexture?G.mipmaps[0]:G.image;Z.pixelStorei(3314,Cr.width),Z.pixelStorei(32878,Cr.height),Z.pixelStorei(3316,D.min.x),Z.pixelStorei(3315,D.min.y),Z.pixelStorei(32877,D.min.z),G.isDataTexture||G.isData3DTexture?Z.texSubImage3D(ot,Y,H.x,H.y,H.z,Ne,je,Ze,Ye,vt,Cr.data):G.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Z.compressedTexSubImage3D(ot,Y,H.x,H.y,H.z,Ne,je,Ze,Ye,Cr.data)):Z.texSubImage3D(ot,Y,H.x,H.y,H.z,Ne,je,Ze,Ye,vt,Cr),Z.pixelStorei(3314,lt),Z.pixelStorei(32878,qt),Z.pixelStorei(3316,Jo),Z.pixelStorei(3315,Ul),Z.pixelStorei(32877,Vl),0===Y&&V.generateMipmaps&&Z.generateMipmap(ot),ve.unbindTexture()},this.initTexture=function(D){te.setTexture2D(D,0),ve.unbindTexture()},this.resetState=function(){y=0,m=0,x=null,ve.reset(),Ve.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}_t.prototype.isWebGLRenderer=!0,class h8 extends _t{}.prototype.isWebGL1Renderer=!0;class ph{constructor(e,t=25e-5){this.name="",this.color=new re(e),this.density=t}clone(){return new ph(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}ph.prototype.isFogExp2=!0;class mh{constructor(e,t=1,i=1e3){this.name="",this.color=new re(e),this.near=t,this.far=i}clone(){return new mh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}mh.prototype.isFog=!0;class gh extends ut{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}gh.prototype.isScene=!0;class Po{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Yc,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=vi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=vi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=vi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Po.prototype.isInterleavedBuffer=!0;const Zt=new E;class Rs{constructor(e,t,i,r=!1){this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Zt.x=this.getX(t),Zt.y=this.getY(t),Zt.z=this.getZ(t),Zt.applyMatrix4(e),this.setXYZ(t,Zt.x,Zt.y,Zt.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Zt.x=this.getX(t),Zt.y=this.getY(t),Zt.z=this.getZ(t),Zt.applyNormalMatrix(e),this.setXYZ(t,Zt.x,Zt.y,Zt.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Zt.x=this.getX(t),Zt.y=this.getY(t),Zt.z=this.getZ(t),Zt.transformDirection(e),this.setXYZ(t,Zt.x,Zt.y,Zt.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new yt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Rs(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Rs.prototype.isInterleavedBufferAttribute=!0;class V_ extends kt{constructor(e){super(),this.type="SpriteMaterial",this.color=new re(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let yl;V_.prototype.isSpriteMaterial=!0;const lu=new E,_l=new E,vl=new E,xl=new X,cu=new X,L1=new me,yh=new E,uu=new E,_h=new E,N1=new X,z_=new X,F1=new X;function vh(n,e,t,i,r,s){xl.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(cu.x=s*xl.x-r*xl.y,cu.y=r*xl.x+s*xl.y):cu.copy(xl),n.copy(e),n.x+=cu.x,n.y+=cu.y,n.applyMatrix4(L1)}(class G_ extends ut{constructor(e){if(super(),this.type="Sprite",void 0===yl){yl=new Te;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Po(t,5);yl.setIndex([0,1,2,0,2,3]),yl.setAttribute("position",new Rs(i,3,0,!1)),yl.setAttribute("uv",new Rs(i,2,3,!1))}this.geometry=yl,this.material=void 0!==e?e:new V_,this.center=new X(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_l.setFromMatrixScale(this.matrixWorld),L1.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),vl.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&_l.multiplyScalar(-vl.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;vh(yh.set(-.5,-.5,0),vl,o,_l,r,s),vh(uu.set(.5,-.5,0),vl,o,_l,r,s),vh(_h.set(.5,.5,0),vl,o,_l,r,s),N1.set(0,0),z_.set(1,0),F1.set(1,1);let a=e.ray.intersectTriangle(yh,uu,_h,!1,lu);if(null===a&&(vh(uu.set(-.5,.5,0),vl,o,_l,r,s),z_.set(0,1),a=e.ray.intersectTriangle(yh,_h,uu,!1,lu),null===a))return;const l=e.ray.origin.distanceTo(lu);l<e.near||l>e.far||t.push({distance:l,point:lu.clone(),uv:ln.getUV(lu,yh,uu,_h,N1,z_,F1,new X),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const k1=new E,B1=new gt,H1=new gt,m8=new E,U1=new me;class wh extends _n{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new me,this.bindMatrixInverse=new me}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new gt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.w=t.getW(i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;B1.fromBufferAttribute(r.attributes.skinIndex,e),H1.fromBufferAttribute(r.attributes.skinWeight,e),k1.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=H1.getComponent(s);if(0!==o){const a=B1.getComponent(s);U1.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(m8.copy(k1).applyMatrix4(U1),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}wh.prototype.isSkinnedMesh=!0;class bh extends ut{constructor(){super(),this.type="Bone"}}bh.prototype.isBone=!0;class wl extends Fn{constructor(e=null,t=1,i=1,r,s,o,a,l,c=an,u=an,d,f){super(null,o,a,l,c,u,r,s,d,f),this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}wl.prototype.isDataTexture=!0;const V1=new me,g8=new me;class Mh{constructor(e=[],t=[]){this.uuid=vi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new me)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new me;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)V1.multiplyMatrices(e[s]?e[s].matrixWorld:g8,t[s]),V1.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new Mh(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=UD(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new wl(t,e,e,Xn,xs);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new bh),this.bones.push(o),this.boneInverses.push((new me).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class bl extends yt{constructor(e,t,i,r=1){"number"==typeof i&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,i),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}bl.prototype.isInstancedBufferAttribute=!0;const z1=new me,G1=new me,Sh=[],du=new _n;(class W1 extends _n{constructor(e,t,i){super(e,t),this.instanceMatrix=new bl(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(du.geometry=this.geometry,du.material=this.material,void 0!==du.material)for(let s=0;s<r;s++){this.getMatrixAt(s,z1),G1.multiplyMatrices(i,z1),du.matrixWorld=G1,du.raycast(e,Sh);for(let o=0,a=Sh.length;o<a;o++){const l=Sh[o];l.instanceId=s,l.object=this,t.push(l)}Sh.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new bl(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class bn extends kt{constructor(e){super(),this.type="LineBasicMaterial",this.color=new re(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}bn.prototype.isLineBasicMaterial=!0;const j1=new E,$1=new E,q1=new me,W_=new Do,Eh=new Ss;class Ps extends ut{constructor(e=new Te,t=new bn){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)j1.fromBufferAttribute(t,r-1),$1.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=j1.distanceTo($1);e.setAttribute("lineDistance",new ge(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Eh.copy(i.boundingSphere),Eh.applyMatrix4(r),Eh.radius+=s,!1===e.ray.intersectsSphere(Eh))return;q1.copy(r).invert(),W_.copy(e.ray).applyMatrix4(q1);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new E,u=new E,d=new E,f=new E,h=this.isLineSegments?2:1;if(i.isBufferGeometry){const p=i.index,_=i.attributes.position;if(null!==p)for(let x=Math.max(0,o.start),v=Math.min(p.count,o.start+o.count)-1;x<v;x+=h){const w=p.getX(x),M=p.getX(x+1);if(c.fromBufferAttribute(_,w),u.fromBufferAttribute(_,M),W_.distanceSqToSegment(c,u,f,d)>l)continue;f.applyMatrix4(this.matrixWorld);const C=e.ray.origin.distanceTo(f);C<e.near||C>e.far||t.push({distance:C,point:d.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}else for(let x=Math.max(0,o.start),v=Math.min(_.count,o.start+o.count)-1;x<v;x+=h){if(c.fromBufferAttribute(_,x),u.fromBufferAttribute(_,x+1),W_.distanceSqToSegment(c,u,f,d)>l)continue;f.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(f);M<e.near||M>e.far||t.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else i.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Ps.prototype.isLine=!0;const X1=new E,Y1=new E;class Yr extends Ps{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)X1.fromBufferAttribute(t,r),Y1.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+X1.distanceTo(Y1);e.setAttribute("lineDistance",new ge(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Yr.prototype.isLineSegments=!0;class j_ extends Ps{constructor(e,t){super(e,t),this.type="LineLoop"}}j_.prototype.isLineLoop=!0;class Lo extends kt{constructor(e){super(),this.type="PointsMaterial",this.color=new re(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Lo.prototype.isPointsMaterial=!0;const Z1=new me,$_=new Do,Th=new Ss,Dh=new E;class fu extends ut{constructor(e=new Te,t=new Lo){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Th.copy(i.boundingSphere),Th.applyMatrix4(r),Th.radius+=s,!1===e.ray.intersectsSphere(Th))return;Z1.copy(r).invert(),$_.copy(e.ray).applyMatrix4(Z1);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(i.isBufferGeometry){const c=i.index,d=i.attributes.position;if(null!==c)for(let p=Math.max(0,o.start),g=Math.min(c.count,o.start+o.count);p<g;p++){const _=c.getX(p);Dh.fromBufferAttribute(d,_),K1(Dh,_,l,r,e,t,this)}else for(let p=Math.max(0,o.start),g=Math.min(d.count,o.start+o.count);p<g;p++)Dh.fromBufferAttribute(d,p),K1(Dh,p,l,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function K1(n,e,t,i,r,s,o){const a=$_.distanceSqToPoint(n);if(a<t){const l=new E;$_.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}fu.prototype.isPoints=!0,class y8 extends Fn{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.minFilter=void 0!==o?o:Rt,this.magFilter=void 0!==s?s:Rt,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class _8 extends Fn{constructor(e,t,i){super({width:e,height:t}),this.format=i,this.magFilter=an,this.minFilter=an,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class J1 extends Fn{constructor(e,t,i,r,s,o,a,l,c,u,d,f){super(null,o,a,l,c,u,r,s,d,f),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class v8 extends Fn{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,new E,new E,new E,new ln;class Fi{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,i[r]===o)return r/(s-1);const u=i[r];return(r+(o-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new X:new E);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new E,r=[],s=[],o=[],a=new E,l=new me;for(let h=0;h<=e;h++)r[h]=this.getTangentAt(h/e,new E);s[0]=new E,o[0]=new E;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),f=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),f<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let h=1;h<=e;h++){if(s[h]=s[h-1].clone(),o[h]=o[h-1].clone(),a.crossVectors(r[h-1],r[h]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(Dn(r[h-1].dot(r[h]),-1,1));s[h].applyMatrix4(l.makeRotationAxis(a,p))}o[h].crossVectors(r[h],s[h])}if(!0===t){let h=Math.acos(Dn(s[0].dot(s[e]),-1,1));h/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(h=-h);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],h*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Nh extends Fi{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new X,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),f=l-this.aX,h=c-this.aY;l=f*u-h*d+this.aX,c=f*d+h*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Nh.prototype.isEllipseCurve=!0;class eC extends Nh{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.type="ArcCurve"}}function X_(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,d){let f=(o-s)/c-(a-s)/(c+u)+(a-o)/u,h=(a-o)/u-(l-o)/(u+d)+(l-a)/d;f*=u,h*=u,r(o,a,f,h)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}eC.prototype.isArcCurve=!0;const Fh=new E,Y_=new X_,Z_=new X_,K_=new X_;class tC extends Fi{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new E){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,u,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(Fh.subVectors(r[0],r[1]).add(r[0]),c=Fh);const d=r[a%s],f=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(Fh.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=Fh),"centripetal"===this.curveType||"chordal"===this.curveType){const h="chordal"===this.curveType?.5:.25;let p=Math.pow(c.distanceToSquared(d),h),g=Math.pow(d.distanceToSquared(f),h),_=Math.pow(f.distanceToSquared(u),h);g<1e-4&&(g=1),p<1e-4&&(p=g),_<1e-4&&(_=g),Y_.initNonuniformCatmullRom(c.x,d.x,f.x,u.x,p,g,_),Z_.initNonuniformCatmullRom(c.y,d.y,f.y,u.y,p,g,_),K_.initNonuniformCatmullRom(c.z,d.z,f.z,u.z,p,g,_)}else"catmullrom"===this.curveType&&(Y_.initCatmullRom(c.x,d.x,f.x,u.x,this.tension),Z_.initCatmullRom(c.y,d.y,f.y,u.y,this.tension),K_.initCatmullRom(c.z,d.z,f.z,u.z,this.tension));return i.set(Y_.calc(l),Z_.calc(l),K_.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new E).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function nC(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function hu(n,e,t,i){return function x8(n,e){const t=1-n;return t*t*e}(n,e)+function w8(n,e){return 2*(1-n)*n*e}(n,t)+function b8(n,e){return n*n*e}(n,i)}function pu(n,e,t,i,r){return function M8(n,e){const t=1-n;return t*t*t*e}(n,e)+function S8(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function E8(n,e){return 3*(1-n)*n*n*e}(n,i)+function T8(n,e){return n*n*n*e}(n,r)}tC.prototype.isCatmullRomCurve3=!0;class J_ extends Fi{constructor(e=new X,t=new X,i=new X,r=new X){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new X){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(pu(e,r.x,s.x,o.x,a.x),pu(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}J_.prototype.isCubicBezierCurve=!0;class iC extends Fi{constructor(e=new E,t=new E,i=new E,r=new E){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new E){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(pu(e,r.x,s.x,o.x,a.x),pu(e,r.y,s.y,o.y,a.y),pu(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}iC.prototype.isCubicBezierCurve3=!0;class Oh extends Fi{constructor(e=new X,t=new X){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new X){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new X;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Oh.prototype.isLineCurve=!0;class Q_ extends Fi{constructor(e=new X,t=new X,i=new X){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new X){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(hu(e,r.x,s.x,o.x),hu(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Q_.prototype.isQuadraticBezierCurve=!0;class e0 extends Fi{constructor(e=new E,t=new E,i=new E){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new E){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(hu(e,r.x,s.x,o.x),hu(e,r.y,s.y,o.y),hu(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}e0.prototype.isQuadraticBezierCurve3=!0;class t0 extends Fi{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new X){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(nC(a,l.x,c.x,u.x,d.x),nC(a,l.y,c.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new X).fromArray(r))}return this}}t0.prototype.isSplineCurve=!0;var n0=Object.freeze({__proto__:null,ArcCurve:eC,CatmullRomCurve3:tC,CubicBezierCurve:J_,CubicBezierCurve3:iC,EllipseCurve:Nh,LineCurve:Oh,LineCurve3:class D8 extends Fi{constructor(e=new E,t=new E){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new E){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:Q_,QuadraticBezierCurve3:e0,SplineCurve:t0});class C8 extends Fi{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Oh(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new n0[r.type]).fromJSON(r))}return this}}class kh extends C8{constructor(e){super(),this.type="Path",this.currentPoint=new X,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new Oh(this.currentPoint.clone(),new X(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new Q_(this.currentPoint.clone(),new X(e,t),new X(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new J_(this.currentPoint.clone(),new X(e,t),new X(i,r),new X(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new t0(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new Nh(e,t,i,r,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Zr extends kh{constructor(e){super(e),this.uuid=vi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new kh).fromJSON(r))}return this}}function rC(n,e,t,i,r){let s,o;if(r===function j8(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=aC(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=aC(s,n[s],n[s+1],o);return o&&Bh(o,o.next)&&(yu(o),o=o.next),o}function Ns(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!Bh(t,t.next)&&0!==Ht(t.prev,t,t.next))t=t.next;else{if(yu(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function mu(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function H8(n,e,t,i){let r=n;do{null===r.z&&(r.z=r0(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function U8(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1)}(r)}(n,i,r,s);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,s?R8(n,i,r,s):I8(n))e.push(l.i/t),e.push(n.i/t),e.push(c.i/t),yu(n),n=c.next,a=c.next;else if((n=c)===a){o?1===o?mu(n=P8(Ns(n),e,t),e,t,i,r,s,2):2===o&&L8(n,e,t,i,r,s):mu(Ns(n),e,t,i,r,s,1);break}}function I8(n){const e=n.prev,t=n,i=n.next;if(Ht(e,t,i)>=0)return!1;let r=n.next.next;for(;r!==n.prev;){if(Sl(e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y)&&Ht(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function R8(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Ht(r,s,o)>=0)return!1;const c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,d=r0(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,t,i),f=r0(c,u,e,t,i);let h=n.prevZ,p=n.nextZ;for(;h&&h.z>=d&&p&&p.z<=f;){if(h!==n.prev&&h!==n.next&&Sl(r.x,r.y,s.x,s.y,o.x,o.y,h.x,h.y)&&Ht(h.prev,h,h.next)>=0||(h=h.prevZ,p!==n.prev&&p!==n.next&&Sl(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&Ht(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;h&&h.z>=d;){if(h!==n.prev&&h!==n.next&&Sl(r.x,r.y,s.x,s.y,o.x,o.y,h.x,h.y)&&Ht(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;p&&p.z<=f;){if(p!==n.prev&&p!==n.next&&Sl(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&Ht(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function P8(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!Bh(r,s)&&sC(r,i,i.next,s)&&gu(r,s)&&gu(s,r)&&(e.push(r.i/t),e.push(i.i/t),e.push(s.i/t),yu(i),yu(i.next),i=n=s),i=i.next}while(i!==n);return Ns(i)}function L8(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&z8(o,a)){let l=oC(o,a);return o=Ns(o,o.next),l=Ns(l,l.next),mu(o,e,t,i,r,s),void mu(l,e,t,i,r,s)}a=a.next}o=o.next}while(o!==n)}function F8(n,e){return n.x-e.x}function O8(n,e){if(e=function k8(n,e){let t=e;const i=n.x,r=n.y;let o,s=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const f=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=i&&f>s){if(s=f,f===i){if(r===t.y)return t;if(r===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(i===s)return o;const a=o,l=o.x,c=o.y;let d,u=1/0;t=o;do{i>=t.x&&t.x>=l&&i!==t.x&&Sl(r<c?i:s,r,l,c,r<c?s:i,r,t.x,t.y)&&(d=Math.abs(r-t.y)/(i-t.x),gu(t,n)&&(d<u||d===u&&(t.x>o.x||t.x===o.x&&B8(o,t)))&&(o=t,u=d)),t=t.next}while(t!==a);return o}(n,e),e){const t=oC(e,n);Ns(e,e.next),Ns(t,t.next)}}function B8(n,e){return Ht(n.prev,n,e.prev)<0&&Ht(e.next,n,n.next)<0}function r0(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*r)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function V8(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function Sl(n,e,t,i,r,s,o,a){return(r-o)*(e-a)-(n-o)*(s-a)>=0&&(n-o)*(i-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(r-o)*(i-a)>=0}function z8(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function G8(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&sC(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(gu(n,e)&&gu(e,n)&&function W8(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(Ht(n.prev,n,e.prev)||Ht(n,e.prev,e))||Bh(n,e)&&Ht(n.prev,n,n.next)>0&&Ht(e.prev,e,e.next)>0)}function Ht(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Bh(n,e){return n.x===e.x&&n.y===e.y}function sC(n,e,t,i){const r=Uh(Ht(n,e,t)),s=Uh(Ht(n,e,i)),o=Uh(Ht(t,i,n)),a=Uh(Ht(t,i,e));return!!(r!==s&&o!==a||0===r&&Hh(n,t,e)||0===s&&Hh(n,i,e)||0===o&&Hh(t,n,i)||0===a&&Hh(t,e,i))}function Hh(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Uh(n){return n>0?1:n<0?-1:0}function gu(n,e){return Ht(n.prev,n,n.next)<0?Ht(n,e,n.next)>=0&&Ht(n,n.prev,e)>=0:Ht(n,e,n.prev)<0||Ht(n,n.next,e)<0}function oC(n,e){const t=new s0(n.i,n.x,n.y),i=new s0(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function aC(n,e,t,i){const r=new s0(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function yu(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function s0(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Kr{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return Kr.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];lC(e),cC(i,e);let o=e.length;t.forEach(lC);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,cC(i,t[l]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=rC(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,d,f,h;if(i&&(s=function N8(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=rC(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(V8(c));for(r.sort(F8),s=0;s<r.length;s++)O8(r[s],t),t=Ns(t,t.next);return t}(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let p=t;p<r;p+=t)d=n[p],f=n[p+1],d<a&&(a=d),f<l&&(l=f),d>c&&(c=d),f>u&&(u=f);h=Math.max(c-a,u-l),h=0!==h?1/h:0}return mu(s,o,t,a,l,h),o}(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function lC(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function cC(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Fs extends Te{constructor(e=new Zr([new X(.5,.5),new X(-.5,.5),new X(-.5,-.5),new X(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1;let d=void 0!==t.depth?t.depth:1,f=void 0===t.bevelEnabled||t.bevelEnabled,h=void 0!==t.bevelThickness?t.bevelThickness:.2,p=void 0!==t.bevelSize?t.bevelSize:h-.1,g=void 0!==t.bevelOffset?t.bevelOffset:0,_=void 0!==t.bevelSegments?t.bevelSegments:3;const y=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:$8;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=t.amount);let x,w,M,T,C,v=!1;y&&(x=y.getSpacedPoints(u),v=!0,f=!1,w=y.computeFrenetFrames(u,!1),M=new E,T=new E,C=new E),f||(_=0,h=0,p=0,g=0);const R=a.extractPoints(c);let P=R.shape;const b=R.holes;if(!Kr.isClockWise(P)){P=P.reverse();for(let z=0,te=b.length;z<te;z++){const ie=b[z];Kr.isClockWise(ie)&&(b[z]=ie.reverse())}}const L=Kr.triangulateShape(P,b),F=P;for(let z=0,te=b.length;z<te;z++)P=P.concat(b[z]);function O(z,te,ie){return te||console.error("THREE.ExtrudeGeometry: vec does not exist"),te.clone().multiplyScalar(ie).add(z)}const B=P.length,U=L.length;function k(z,te,ie){let ye,ce,Pe;const Me=z.x-te.x,Xe=z.y-te.y,Lt=ie.x-z.x,A=ie.y-z.y,S=Me*Me+Xe*Xe;if(Math.abs(Me*A-Xe*Lt)>Number.EPSILON){const K=Math.sqrt(S),se=Math.sqrt(Lt*Lt+A*A),he=te.x-Xe/K,Ce=te.y+Me/K,Ve=((ie.x-A/se-he)*A-(ie.y+Lt/se-Ce)*Lt)/(Me*A-Xe*Lt);ye=he+Me*Ve-z.x,ce=Ce+Xe*Ve-z.y;const Ee=ye*ye+ce*ce;if(Ee<=2)return new X(ye,ce);Pe=Math.sqrt(Ee/2)}else{let K=!1;Me>Number.EPSILON?Lt>Number.EPSILON&&(K=!0):Me<-Number.EPSILON?Lt<-Number.EPSILON&&(K=!0):Math.sign(Xe)===Math.sign(A)&&(K=!0),K?(ye=-Xe,ce=Me,Pe=Math.sqrt(S)):(ye=Me,ce=Xe,Pe=Math.sqrt(S/2))}return new X(ye/Pe,ce/Pe)}const j=[];for(let z=0,te=F.length,ie=te-1,ye=z+1;z<te;z++,ie++,ye++)ie===te&&(ie=0),ye===te&&(ye=0),j[z]=k(F[z],F[ie],F[ye]);const J=[];let Q,ee=j.concat();for(let z=0,te=b.length;z<te;z++){const ie=b[z];Q=[];for(let ye=0,ce=ie.length,Pe=ce-1,Me=ye+1;ye<ce;ye++,Pe++,Me++)Pe===ce&&(Pe=0),Me===ce&&(Me=0),Q[ye]=k(ie[ye],ie[Pe],ie[Me]);J.push(Q),ee=ee.concat(Q)}for(let z=0;z<_;z++){const te=z/_,ie=h*Math.cos(te*Math.PI/2),ye=p*Math.sin(te*Math.PI/2)+g;for(let ce=0,Pe=F.length;ce<Pe;ce++){const Me=O(F[ce],j[ce],ye);dt(Me.x,Me.y,-ie)}for(let ce=0,Pe=b.length;ce<Pe;ce++){const Me=b[ce];Q=J[ce];for(let Xe=0,Lt=Me.length;Xe<Lt;Xe++){const A=O(Me[Xe],Q[Xe],ye);dt(A.x,A.y,-ie)}}}const be=p+g;for(let z=0;z<B;z++){const te=f?O(P[z],ee[z],be):P[z];v?(T.copy(w.normals[0]).multiplyScalar(te.x),M.copy(w.binormals[0]).multiplyScalar(te.y),C.copy(x[0]).add(T).add(M),dt(C.x,C.y,C.z)):dt(te.x,te.y,0)}for(let z=1;z<=u;z++)for(let te=0;te<B;te++){const ie=f?O(P[te],ee[te],be):P[te];v?(T.copy(w.normals[z]).multiplyScalar(ie.x),M.copy(w.binormals[z]).multiplyScalar(ie.y),C.copy(x[z]).add(T).add(M),dt(C.x,C.y,C.z)):dt(ie.x,ie.y,d/u*z)}for(let z=_-1;z>=0;z--){const te=z/_,ie=h*Math.cos(te*Math.PI/2),ye=p*Math.sin(te*Math.PI/2)+g;for(let ce=0,Pe=F.length;ce<Pe;ce++){const Me=O(F[ce],j[ce],ye);dt(Me.x,Me.y,d+ie)}for(let ce=0,Pe=b.length;ce<Pe;ce++){const Me=b[ce];Q=J[ce];for(let Xe=0,Lt=Me.length;Xe<Lt;Xe++){const A=O(Me[Xe],Q[Xe],ye);v?dt(A.x,A.y+x[u-1].y,x[u-1].x+ie):dt(A.x,A.y,d+ie)}}}function Z(z,te){let ie=z.length;for(;--ie>=0;){const ye=ie;let ce=ie-1;ce<0&&(ce=z.length-1);for(let Pe=0,Me=u+2*_;Pe<Me;Pe++){const Xe=B*Pe,Lt=B*(Pe+1);_e(te+ye+Xe,te+ce+Xe,te+ce+Lt,te+ye+Lt)}}}function dt(z,te,ie){l.push(z),l.push(te),l.push(ie)}function $e(z,te,ie){ve(z),ve(te),ve(ie);const ye=r.length/3,ce=m.generateTopUV(i,r,ye-3,ye-2,ye-1);nt(ce[0]),nt(ce[1]),nt(ce[2])}function _e(z,te,ie,ye){ve(z),ve(te),ve(ye),ve(te),ve(ie),ve(ye);const ce=r.length/3,Pe=m.generateSideWallUV(i,r,ce-6,ce-3,ce-2,ce-1);nt(Pe[0]),nt(Pe[1]),nt(Pe[3]),nt(Pe[1]),nt(Pe[2]),nt(Pe[3])}function ve(z){r.push(l[3*z+0]),r.push(l[3*z+1]),r.push(l[3*z+2])}function nt(z){s.push(z.x),s.push(z.y)}(function He(){const z=r.length/3;if(f){let te=0,ie=B*te;for(let ye=0;ye<U;ye++){const ce=L[ye];$e(ce[2]+ie,ce[1]+ie,ce[0]+ie)}te=u+2*_,ie=B*te;for(let ye=0;ye<U;ye++){const ce=L[ye];$e(ce[0]+ie,ce[1]+ie,ce[2]+ie)}}else{for(let te=0;te<U;te++){const ie=L[te];$e(ie[2],ie[1],ie[0])}for(let te=0;te<U;te++){const ie=L[te];$e(ie[0]+B*u,ie[1]+B*u,ie[2]+B*u)}}i.addGroup(z,r.length/3-z,0)})(),function we(){const z=r.length/3;let te=0;Z(F,te),te+=F.length;for(let ie=0,ye=b.length;ie<ye;ie++){const ce=b[ie];Z(ce,te),te+=ce.length}i.addGroup(z,r.length/3-z,1)}()}this.setAttribute("position",new ge(r,3)),this.setAttribute("uv",new ge(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function q8(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new n0[r.type]).fromJSON(r)),new Fs(i,e.options)}}const $8={generateTopUV:function(n,e,t,i,r){const a=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new X(e[3*t],e[3*t+1]),new X(a,l),new X(c,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*i],u=e[3*i+1],d=e[3*i+2],f=e[3*r],h=e[3*r+1],p=e[3*r+2],g=e[3*s],_=e[3*s+1],y=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new X(o,1-l),new X(c,1-d),new X(f,1-p),new X(g,1-y)]:[new X(a,1-l),new X(u,1-d),new X(h,1-p),new X(_,1-y)]}};class vu extends Te{constructor(e=new Zr([new X(0,.5),new X(-.5,-.5),new X(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;function c(u){const d=r.length/3,f=u.extractPoints(t);let h=f.shape;const p=f.holes;!1===Kr.isClockWise(h)&&(h=h.reverse());for(let _=0,y=p.length;_<y;_++){const m=p[_];!0===Kr.isClockWise(m)&&(p[_]=m.reverse())}const g=Kr.triangulateShape(h,p);for(let _=0,y=p.length;_<y;_++)h=h.concat(p[_]);for(let _=0,y=h.length;_<y;_++){const m=h[_];r.push(m.x,m.y,0),s.push(0,0,1),o.push(m.x,m.y)}for(let _=0,y=g.length;_<y;_++){const m=g[_];i.push(m[0]+d,m[1]+d,m[2]+d),l+=3}}this.setIndex(i),this.setAttribute("position",new ge(r,3)),this.setAttribute("normal",new ge(s,3)),this.setAttribute("uv",new ge(o,2))}toJSON(){const e=super.toJSON();return function X8(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(t[e.shapes[r]]);return new vu(i,e.curveSegments)}}class hC extends kt{constructor(e){super(),this.type="ShadowMaterial",this.color=new re(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}hC.prototype.isShadowMaterial=!0;class pC extends Qi{constructor(e){super(e),this.type="RawShaderMaterial"}}pC.prototype.isRawShaderMaterial=!0;class El extends kt{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new re(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}El.prototype.isMeshStandardMaterial=!0;class Os extends El{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new X(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Dn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new re(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new re(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new re(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}Os.prototype.isMeshPhysicalMaterial=!0;class mC extends kt{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new re(16777215),this.specular=new re(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ff,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}mC.prototype.isMeshPhongMaterial=!0;class gC extends kt{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new re(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}gC.prototype.isMeshToonMaterial=!0;class yC extends kt{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}yC.prototype.isMeshNormalMaterial=!0;class _C extends kt{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new re(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ff,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}_C.prototype.isMeshLambertMaterial=!0;class vC extends kt{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new re(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}vC.prototype.isMeshMatcapMaterial=!0;class xC extends bn{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}xC.prototype.isLineDashedMaterial=!0;const Y8={ShadowMaterial:hC,SpriteMaterial:V_,RawShaderMaterial:pC,ShaderMaterial:Qi,PointsMaterial:Lo,MeshPhysicalMaterial:Os,MeshStandardMaterial:El,MeshPhongMaterial:mC,MeshToonMaterial:gC,MeshNormalMaterial:yC,MeshLambertMaterial:_C,MeshDepthMaterial:B_,MeshDistanceMaterial:H_,MeshBasicMaterial:bi,MeshMatcapMaterial:vC,LineDashedMaterial:xC,LineBasicMaterial:bn,Material:kt};kt.fromType=function(n){return new Y8[n]};const Pt={arraySlice:function(n,e,t){return Pt.isTypedArray(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)},convertArray:function(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i},sortedArray:function(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r},flattenJSON:function(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)},subclip:function(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],f=[];for(let h=0;h<c.times.length;++h){const p=c.times[h]*r;if(!(p<t||p>=i)){d.push(c.times[h]);for(let g=0;g<u;++g)f.push(c.values[h*u+g])}}0!==d.length&&(c.times=Pt.convertArray(d,c.times.constructor),c.values=Pt.convertArray(f,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=n.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(void 0===c)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let f=0;const h=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=h/3);const p=a.times.length-1;let g;if(s<=a.times[0])g=Pt.arraySlice(a.values,u,d-u);else if(s>=a.times[p]){const y=p*d+u;g=Pt.arraySlice(a.values,y,y+d-u)}else{const y=a.createInterpolant(),m=u,x=d-u;y.evaluate(s),g=Pt.arraySlice(y.resultBuffer,m,x)}"quaternion"===l&&(new Cn).fromArray(g).normalize().conjugate().toArray(g);const _=c.times.length;for(let y=0;y<_;++y){const m=y*h+f;if("quaternion"===l)Cn.multiplyQuaternionsFlat(c.values,m,g,0,c.values,m);else{const x=h-2*f;for(let v=0;v<x;++v)c.values[m+v]-=g[v]}}}return n.blendMode=2501,n}};class Jr{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,s)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,s,e)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Jr.prototype.beforeStart_=Jr.prototype.copySampleValue_,Jr.prototype.afterEnd_=Jr.prototype.copySampleValue_;class Z8 extends Jr{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ya,endingEnd:Ya}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Za:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case Za:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,f=this._weightPrev,h=this._weightNext,p=(i-t)/(r-t),g=p*p,_=g*p,y=-f*_+2*f*g-f*p,m=(1+f)*_+(-1.5-2*f)*g+(-.5+f)*p+1,x=(-1-h)*_+(1.5+h)*g+.5*p,v=h*_-h*g;for(let w=0;w!==a;++w)s[w]=y*o[u+w]+m*o[c+w]+x*o[l+w]+v*o[d+w];return s}}class wC extends Jr{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let f=0;f!==a;++f)s[f]=o[c+f]*d+o[l+f]*u;return s}}class K8 extends Jr{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class vr{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Pt.convertArray(t,this.TimeBufferType),this.values=Pt.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Pt.convertArray(e.times,Array),values:Pt.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new K8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new wC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Z8(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Xc:t=this.InterpolantFactoryMethodDiscrete;break;case Xa:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Xc;case this.InterpolantFactoryMethodLinear:return Xa;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Pt.arraySlice(i,s,o),this.values=Pt.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&Pt.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Pt.arraySlice(this.times),t=Pt.arraySlice(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,f=d-i,h=d+i;for(let p=0;p!==i;++p){const g=t[d+p];if(g!==t[f+p]||g!==t[h+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,f=o*i;for(let h=0;h!==i;++h)t[f+h]=t[d+h]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Pt.arraySlice(e,0,o),this.values=Pt.arraySlice(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=Pt.arraySlice(this.times,0),t=Pt.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}vr.prototype.TimeBufferType=Float32Array,vr.prototype.ValueBufferType=Float32Array,vr.prototype.DefaultInterpolation=Xa;class Tl extends vr{}Tl.prototype.ValueTypeName="bool",Tl.prototype.ValueBufferType=Array,Tl.prototype.DefaultInterpolation=Xc,Tl.prototype.InterpolantFactoryMethodLinear=void 0,Tl.prototype.InterpolantFactoryMethodSmooth=void 0;class bC extends vr{}bC.prototype.ValueTypeName="color";class wu extends vr{}wu.prototype.ValueTypeName="number";class J8 extends Jr{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Cn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class No extends vr{InterpolantFactoryMethodLinear(e){return new J8(this.times,this.values,this.getValueSize(),e)}}No.prototype.ValueTypeName="quaternion",No.prototype.DefaultInterpolation=Xa,No.prototype.InterpolantFactoryMethodSmooth=void 0;class Dl extends vr{}Dl.prototype.ValueTypeName="string",Dl.prototype.ValueBufferType=Array,Dl.prototype.DefaultInterpolation=Xc,Dl.prototype.InterpolantFactoryMethodLinear=void 0,Dl.prototype.InterpolantFactoryMethodSmooth=void 0;class bu extends vr{}bu.prototype.ValueTypeName="vector";class Mu{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=vi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(e6(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(vr.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=Pt.getKeyframeOrder(l);l=Pt.sortedArray(l,1,u),c=Pt.sortedArray(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new wu(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let f=r[d];f||(r[d]=f=[]),f.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,f,h,p,g){if(0!==h.length){const _=[],y=[];Pt.flattenJSON(h,_,y,p),0!==_.length&&g.push(new d(f,_,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const f=c[d].keys;if(f&&0!==f.length)if(f[0].morphTargets){const h={};let p;for(p=0;p<f.length;p++)if(f[p].morphTargets)for(let g=0;g<f[p].morphTargets.length;g++)h[f[p].morphTargets[g]]=-1;for(const g in h){const _=[],y=[];for(let m=0;m!==f[p].morphTargets.length;++m){const x=f[p];_.push(x.time),y.push(x.morphTarget===g?1:0)}r.push(new wu(".morphTargetInfluence["+g+"]",_,y))}l=h.length*o}else{const h=".bones["+t[d].name+"]";i(bu,h+".position",f,"pos",r),i(No,h+".quaternion",f,"rot",r),i(bu,h+".scale",f,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function e6(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Q8(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return wu;case"vector":case"vector2":case"vector3":case"vector4":return bu;case"color":return bC;case"quaternion":return No;case"bool":case"boolean":return Tl;case"string":return Dl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];Pt.flattenJSON(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Cl={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};const t6=new class MC{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,f=c.length;d<f;d+=2){const h=c[d],p=c[d+1];if(h.global&&(h.lastIndex=0),h.test(u))return p}return null}}};class Qr{constructor(e){this.manager=void 0!==e?e:t6,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const es={};class er extends Qr{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Cl.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==es[e])return void es[e].push({onLoad:t,onProgress:i,onError:r});es[e]=[],es[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const u=es[e],d=c.body.getReader(),f=c.headers.get("Content-Length"),h=f?parseInt(f):0,p=0!==h;let g=0;const _=new ReadableStream({start(y){!function m(){d.read().then(({done:x,value:v})=>{if(x)y.close();else{g+=v.byteLength;const w=new ProgressEvent("progress",{lengthComputable:p,loaded:g,total:h});for(let M=0,T=u.length;M<T;M++){const C=u[M];C.onProgress&&C.onProgress(w)}y.enqueue(v),m()}})}()}});return new Response(_)}throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),f=d&&d[1]?d[1].toLowerCase():void 0,h=new TextDecoder(f);return c.arrayBuffer().then(p=>h.decode(p))}}}).then(c=>{Cl.add(e,c);const u=es[e];delete es[e];for(let d=0,f=u.length;d<f;d++){const h=u[d];h.onLoad&&h.onLoad(c)}}).catch(c=>{const u=es[e];if(void 0===u)throw this.manager.itemError(e),c;delete es[e];for(let d=0,f=u.length;d<f;d++){const h=u[d];h.onError&&h.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Xh extends Qr{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Cl.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Qc("img");function l(){u(),Cl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class n6 extends Qr{constructor(e){super(e)}load(e,t,i,r){const s=new ru,o=new Xh(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class SC extends Qr{constructor(e){super(e)}load(e,t,i,r){const s=new Fn,o=new Xh(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class xr extends ut{constructor(e,t=1){super(),this.type="Light",this.color=new re(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}xr.prototype.isLight=!0;(class EC extends xr{constructor(e,t,i){super(e,i),this.type="HemisphereLight",this.position.copy(ut.DefaultUp),this.updateMatrix(),this.groundColor=new re(t)}copy(e){return xr.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const TC=new me,DC=new E,CC=new E;class o0{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new X(512,512),this.map=null,this.mapPass=null,this.matrix=new me,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new dh,this._frameExtents=new X(1,1),this._viewportCount=1,this._viewports=[new gt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;DC.setFromMatrixPosition(e.matrixWorld),t.position.copy(DC),CC.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(CC),t.updateMatrixWorld(),TC.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(TC),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class AC extends o0{constructor(){super(new Bt(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,i=2*Kc*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}AC.prototype.isSpotLightShadow=!0;class Yh extends xr{constructor(e,t,i=0,r=Math.PI/3,s=0,o=1){super(e,t),this.type="SpotLight",this.position.copy(ut.DefaultUp),this.updateMatrix(),this.target=new ut,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new AC}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Yh.prototype.isSpotLight=!0;const IC=new me,Su=new E,a0=new E;class RC extends o0{constructor(){super(new Bt(90,1,.5,500)),this._frameExtents=new X(4,2),this._viewportCount=6,this._viewports=[new gt(2,1,1,1),new gt(0,1,1,1),new gt(3,1,1,1),new gt(1,1,1,1),new gt(3,0,1,1),new gt(1,0,1,1)],this._cubeDirections=[new E(1,0,0),new E(-1,0,0),new E(0,0,1),new E(0,0,-1),new E(0,1,0),new E(0,-1,0)],this._cubeUps=[new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,0,1),new E(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Su.setFromMatrixPosition(e.matrixWorld),i.position.copy(Su),a0.copy(i.position),a0.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(a0),i.updateMatrixWorld(),r.makeTranslation(-Su.x,-Su.y,-Su.z),IC.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(IC)}}RC.prototype.isPointLightShadow=!0;class l0 extends xr{constructor(e,t,i=0,r=1){super(e,t),this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new RC}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}l0.prototype.isPointLight=!0;class PC extends o0{constructor(){super(new ou(-5,5,5,-5,.5,500))}}PC.prototype.isDirectionalLightShadow=!0;class c0 extends xr{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(ut.DefaultUp),this.updateMatrix(),this.target=new ut,this.shadow=new PC}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}c0.prototype.isDirectionalLight=!0;class u0 extends xr{constructor(e,t){super(e,t),this.type="AmbientLight"}}u0.prototype.isAmbientLight=!0;(class LC extends xr{constructor(e,t,i=10,r=10){super(e,t),this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class NC{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new E)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],i*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],i*s*1.092548),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*i),t.addScaledVector(o[4],.858086*i*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}NC.prototype.isSphericalHarmonics3=!0;class Zh extends xr{constructor(e=new NC,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Zh.prototype.isLightProbe=!0;class wr{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}(class FC extends Te{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0;class BC extends Qr{constructor(e){super(e),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Cl.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Cl.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Kh;BC.prototype.isImageBitmapLoader=!0;class a6 extends Qr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new er(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);(void 0===Kh&&(Kh=new(window.AudioContext||window.webkitAudioContext)),Kh).decodeAudioData(l,function(u){t(u)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}}(class l6 extends Zh{constructor(e,t,i=1){super(void 0,i);const r=(new re).set(e),s=(new re).set(t),o=new E(r.r,r.g,r.b),a=new E(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}).prototype.isHemisphereLightProbe=!0,class c6 extends Zh{constructor(e,t=1){super(void 0,t);const i=(new re).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class zC{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=GC(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=GC();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function GC(){return(typeof performance>"u"?Date:performance).now()}class p6{constructor(e,t,i){let r,s,o;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else o+=t,this._mixBufferRegion(i,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(i,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const t=this.buffer,i=this.valueSize,r=i*this._origIndex;this.binding.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){Cn.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;Cn.multiplyQuaternionsFlat(e,o,e,t,e,i),Cn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const d0="\\[\\]\\.:\\/",m6=new RegExp("["+d0+"]","g"),f0="[^"+d0+"]",g6="[^"+d0.replace("\\.","")+"]",y6=/((?:WC+[\/:])*)/.source.replace("WC",f0),_6=/(WCOD+)?/.source.replace("WCOD",g6),v6=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",f0),x6=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",f0),w6=new RegExp("^"+y6+_6+v6+x6+"$"),b6=["material","materials","bones"];class M6{constructor(e,t,i){const r=i||Ct.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Ct=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(m6,"")}static parseTrackName(t){const i=w6.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==b6.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=M6,n})();Ct.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ct.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ct.prototype.GetterByBindingType=[Ct.prototype._getValue_direct,Ct.prototype._getValue_array,Ct.prototype._getValue_arrayElement,Ct.prototype._getValue_toArray],Ct.prototype.SetterByBindingTypeAndVersioning=[[Ct.prototype._setValue_direct,Ct.prototype._setValue_direct_setNeedsUpdate,Ct.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ct.prototype._setValue_array,Ct.prototype._setValue_array_setNeedsUpdate,Ct.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ct.prototype._setValue_arrayElement,Ct.prototype._setValue_arrayElement_setNeedsUpdate,Ct.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ct.prototype._setValue_fromArray,Ct.prototype._setValue_fromArray_setNeedsUpdate,Ct.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class E6{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Ya,endingEnd:Ya};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*i;if(l<0||0===i)return;this._startTime=null,t=i*l}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(2501===this.blendMode)for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);else for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(null!==i){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=2202===i;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(2200===i){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=Za,r.endingEnd=Za):(r.endingStart=e?this.zeroSlopeAtStart?Za:Ya:2402,r.endingEnd=t?this.zeroSlopeAtEnd?Za:Ya:2402)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}(class T6 extends wo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];void 0===u&&(u={},c[l]=u);for(let d=0;d!==s;++d){const f=r[d],h=f.name;let p=u[h];if(void 0!==p)++p.referenceCount,o[d]=p;else{if(p=o[d],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,l,h));continue}p=new p6(Ct.create(i,h,t&&t._propertyBindings[d].binding.parsedPath),f.ValueTypeName,f.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,h),o[d]=p}a[d].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(i=new wC(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o="string"==typeof e?Mu.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===i&&(i=null!==o?o.blendMode:2500),void 0!==l){const d=l.actionByRoot[s];if(void 0!==d&&d.blendMode===i)return d;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const u=new E6(this,o,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const i=t||this._root,r=i.uuid,s="string"==typeof e?Mu.findByName(i,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const t=this._actions,i=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const l=i[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class h0{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new h0(void 0===this.value.clone?this.value:this.value.clone())}}(class D6 extends Po{constructor(e,t,i=1){super(e,t),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}).prototype.isInstancedInterleavedBuffer=!0;const qC=new X;class Eu{constructor(e=new X(1/0,1/0),t=new X(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=qC.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qC.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Eu.prototype.isBox2=!0;const ks=new E,Qh=new me,m0=new me;function ZC(n){const e=[];!0===n.isBone&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,ZC(n.children[t]));return e}const nA=new Float32Array(1);new Int32Array(nA.buffer),Fi.create=function(n,e){return console.log("THREE.Curve.create() has been deprecated"),n.prototype=Object.create(Fi.prototype),n.prototype.constructor=n,n.prototype.getPoint=e,n},kh.prototype.fromPoints=function(n){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(n)},class P6 extends Yr{constructor(e=10,t=10,i=4473924,r=8947848){i=new re(i),r=new re(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let f=0,h=0,p=-a;f<=t;f++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const g=f===s?i:r;g.toArray(c,h),h+=3,g.toArray(c,h),h+=3,g.toArray(c,h),h+=3,g.toArray(c,h),h+=3}const u=new Te;u.setAttribute("position",new ge(l,3)),u.setAttribute("color",new ge(c,3)),super(u,new bn({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class I6 extends Yr{constructor(e){const t=ZC(e),i=new Te,r=[],s=[],o=new re(0,0,1),a=new re(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new ge(r,3)),i.setAttribute("color",new ge(s,3)),super(i,new bn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");m0.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Qh.multiplyMatrices(m0,a.matrixWorld),ks.setFromMatrixPosition(Qh),r.setXYZ(o,ks.x,ks.y,ks.z),Qh.multiplyMatrices(m0,a.parent.matrixWorld),ks.setFromMatrixPosition(Qh),r.setXYZ(o+1,ks.x,ks.y,ks.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Qr.prototype.extractUrlBase=function(n){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),wr.extractUrlBase(n)},Qr.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Eu.prototype.center=function(n){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(n)},Eu.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Eu.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Eu.prototype.size=function(n){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(n)},xi.prototype.center=function(n){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(n)},xi.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},xi.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},xi.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},xi.prototype.size=function(n){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(n)},Co.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},Ss.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},dh.prototype.setFromMatrix=function(n){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(n)},xn.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},xn.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},xn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},xn.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},xn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},xn.prototype.getInverse=function(n){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},me.prototype.extractPosition=function(n){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(n)},me.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},me.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new E).setFromMatrixColumn(this,3)},me.prototype.setRotationFromQuaternion=function(n){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(n)},me.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},me.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},me.prototype.multiplyVector4=function(n){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},me.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},me.prototype.rotateAxis=function(n){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),n.transformDirection(this)},me.prototype.crossVector=function(n){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},me.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},me.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},me.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},me.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},me.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},me.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},me.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},me.prototype.makeFrustum=function(n,e,t,i,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(n,e,i,t,r,s)},me.prototype.getInverse=function(n){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},Xr.prototype.isIntersectionLine=function(n){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(n)},Cn.prototype.multiplyVector3=function(n){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),n.applyQuaternion(this)},Cn.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Do.prototype.isIntersectionBox=function(n){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Do.prototype.isIntersectionPlane=function(n){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(n)},Do.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},ln.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ln.prototype.barycoordFromPoint=function(n,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(n,e)},ln.prototype.midpoint=function(n){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(n)},ln.prototypenormal=function(n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(n)},ln.prototype.plane=function(n){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(n)},ln.barycoordFromPoint=function(n,e,t,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ln.getBarycoord(n,e,t,i,r)},ln.normal=function(n,e,t,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ln.getNormal(n,e,t,i)},Zr.prototype.extractAllPoints=function(n){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(n)},Zr.prototype.extrude=function(n){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Fs(this,n)},Zr.prototype.makeGeometry=function(n){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new vu(this,n)},X.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},X.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},X.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},E.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},E.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},E.prototype.getPositionFromMatrix=function(n){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(n)},E.prototype.getScaleFromMatrix=function(n){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(n)},E.prototype.getColumnFromMatrix=function(n,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,n)},E.prototype.applyProjection=function(n){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(n)},E.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},E.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},E.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},gt.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},gt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ut.prototype.getChildByName=function(n){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(n)},ut.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},ut.prototype.translate=function(n,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,n)},ut.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},ut.prototype.applyMatrix=function(n){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(ut.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(n){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=n}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),_n.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(_n.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),wh.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Bt.prototype.setLens=function(n,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(n)},Object.defineProperties(xr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(n){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=n}},shadowCameraLeft:{set:function(n){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=n}},shadowCameraRight:{set:function(n){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=n}},shadowCameraTop:{set:function(n){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=n}},shadowCameraBottom:{set:function(n){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=n}},shadowCameraNear:{set:function(n){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=n}},shadowCameraFar:{set:function(n){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=n}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(n){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=n}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(n){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=n}},shadowMapHeight:{set:function(n){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=n}}}),Object.defineProperties(yt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Zc},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Zc)}}}),yt.prototype.setDynamic=function(n){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===n?Zc:Yc),this},yt.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},yt.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Te.prototype.addIndex=function(n){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(n)},Te.prototype.addAttribute=function(n,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===n?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(n,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(n,new yt(arguments[1],arguments[2])))},Te.prototype.addDrawCall=function(n,e,t){void 0!==t&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(n,e)},Te.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Te.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Te.prototype.removeAttribute=function(n){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(n)},Te.prototype.applyMatrix=function(n){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(Te.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Po.prototype.setDynamic=function(n){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===n?Zc:Yc),this},Po.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Fs.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Fs.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Fs.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},gh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},h0.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(kt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new re}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(n){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=n}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Qi.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(n){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=n}}}),_t.prototype.clearTarget=function(n,e,t,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(n),this.clear(e,t,i)},_t.prototype.animate=function(n){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(n)},_t.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},_t.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},_t.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},_t.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},_t.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},_t.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},_t.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},_t.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},_t.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},_t.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},_t.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},_t.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},_t.prototype.enableScissorTest=function(n){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(n)},_t.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},_t.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},_t.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},_t.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},_t.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},_t.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},_t.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},_t.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},_t.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},_t.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(_t.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=n}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=n}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(n){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===n?xt:ws}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(I1.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ai.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=n}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=n}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=n}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=n}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(n){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=n}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(n){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=n}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(n){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=n}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(n){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=n}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(n){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=n}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(n){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=n}}}),class d6 extends ut{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(n){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new a6).load(n,function(i){e.setBuffer(i)}),this},A_.prototype.updateCubeMap=function(n,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(n,e)},A_.prototype.clear=function(n,e,t,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(n,e,t,i)},Mo.crossOrigin=void 0,Mo.loadTexture=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new SC;r.setCrossOrigin(this.crossOrigin);const s=r.load(n,t,void 0,i);return e&&(s.mapping=e),s},Mo.loadTextureCube=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new n6;r.setCrossOrigin(this.crossOrigin);const s=r.load(n,t,void 0,i);return e&&(s.mapping=e),s},Mo.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Mo.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"138"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="138");class O6 extends Qr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new U6(t)}),this.register(function(t){return new $6(t)}),this.register(function(t){return new q6(t)}),this.register(function(t){return new V6(t)}),this.register(function(t){return new z6(t)}),this.register(function(t){return new G6(t)}),this.register(function(t){return new W6(t)}),this.register(function(t){return new j6(t)}),this.register(function(t){return new B6(t)}),this.register(function(t){return new X6(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:wr.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new er(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={};if("string"==typeof e)s=e;else if(wr.decodeText(new Uint8Array(e,0,4))===iA){try{o[et.KHR_BINARY_GLTF]=new Y6(e)}catch(d){return void(r&&r(d))}s=o[et.KHR_BINARY_GLTF].content}else s=wr.decodeText(new Uint8Array(e));const l=JSON.parse(s);if(void 0===l.asset||l.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new aj(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](c);a[d.name]=d,o[d.name]=!0}if(l.extensionsUsed)for(let u=0;u<l.extensionsUsed.length;++u){const d=l.extensionsUsed[u],f=l.extensionsRequired||[];switch(d){case et.KHR_MATERIALS_UNLIT:o[d]=new H6;break;case et.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[d]=new J6;break;case et.KHR_DRACO_MESH_COMPRESSION:o[d]=new Z6(l,this.dracoLoader);break;case et.KHR_TEXTURE_TRANSFORM:o[d]=new K6;break;case et.KHR_MESH_QUANTIZATION:o[d]=new Q6;break;default:f.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function k6(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const et={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class B6{constructor(e){this.parser=e,this.name=et.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new re(16777215);void 0!==l.color&&u.fromArray(l.color);const d=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new c0(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new l0(u),c.distance=d;break;case"spot":c=new Yh(u),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class H6{constructor(){this.name=et.KHR_MATERIALS_UNLIT}getMaterialType(){return bi}extendParams(e,t,i){const r=[];e.color=new re(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture))}return Promise.all(r)}}class U6{constructor(e){this.parser=e,this.name=et.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Os:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new X(a,a)}return Promise.all(s)}}class V6{constructor(e){this.parser=e,this.name=et.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Os:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new re(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class z6{constructor(e){this.parser=e,this.name=et.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Os:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class G6{constructor(e){this.parser=e,this.name=et.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Os:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new re(a[0],a[1],a[2]),Promise.all(s)}}class W6{constructor(e){this.parser=e,this.name=et.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Os:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class j6{constructor(e){this.parser=e,this.name=et.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Os:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new re(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture).then(function(l){l.encoding=xt})),Promise.all(s)}}class $6{constructor(e){this.parser=e,this.name=et.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class q6{constructor(e){this.parser=e,this.name=et.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=r.images[s.extensions[t].source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,a,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class X6{constructor(e){this.name=et.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,o.ready]).then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,u=r.count,d=r.byteStride,f=new ArrayBuffer(u*d),h=new Uint8Array(a[0],l,c);return o.decodeGltfBuffer(new Uint8Array(f),u,d,h,r.mode,r.filter),f})}return null}}const iA="glTF";class Y6{constructor(e){this.name=et.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:wr.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==iA)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<i;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,1313821514===a){const l=new Uint8Array(e,12+s,o);this.content=wr.decodeText(l)}else if(5130562===a){const l=12+s;this.body=e.slice(l,l+o)}s+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Z6{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=et.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const d=_0[u]||u.toLowerCase();a[d]=o[u]}for(const u in e.attributes){const d=_0[u]||u.toLowerCase();if(void 0!==o[u]){const f=i.accessors[e.attributes[u]];c[d]=Du[f.componentType],l[d]=!0===f.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(d){r.decodeDracoFile(u,function(f){for(const h in f.attributes){const g=l[h];void 0!==g&&(f.attributes[h].normalized=g)}d(f)},a,c)})})}}class K6{constructor(){this.name=et.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class y0 extends El{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),i=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new re).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(l){for(const c in a)l.uniforms[c]=a[c];l.fragmentShader=l.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",i).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(l){a.specular.value=l}},specularMap:{get:function(){return a.specularMap.value},set:function(l){a.specularMap.value=l,l?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(l){a.glossiness.value=l}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(l){a.glossinessMap.value=l,l?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class J6{constructor(){this.name=et.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return y0}extendParams(e,t,i){const r=t.extensions[this.name];e.color=new re(1,1,1),e.opacity=1;const s=[];if(Array.isArray(r.diffuseFactor)){const o=r.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==r.diffuseTexture&&s.push(i.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new re(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new re(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const o=r.specularGlossinessTexture;s.push(i.assignTexture(e,"glossinessMap",o)),s.push(i.assignTexture(e,"specularMap",o))}return Promise.all(s)}createMaterial(e){const t=new y0(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=xo,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}class Q6{constructor(){this.name=et.KHR_MESH_QUANTIZATION}}class Uo extends Jr{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}}Uo.prototype.beforeStart_=Uo.prototype.copySampleValue_,Uo.prototype.afterEnd_=Uo.prototype.copySampleValue_,Uo.prototype.interpolate_=function(n,e,t,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=i-e,u=(t-e)/c,d=u*u,f=d*u,h=n*l,p=h-l,g=-2*f+3*d,_=f-d,y=1-g,m=_-d+u;for(let x=0;x!==o;x++)r[x]=y*s[p+x+o]+m*(s[p+x+a]*c)+g*s[h+x+o]+_*(s[h+x]*c);return r};const ej=new Cn;class tj extends Uo{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return ej.fromArray(s).normalize().toArray(s),s}}const Du={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},sA={9728:an,9729:Rt,9984:Hf,9985:Yy,9986:Uf,9987:vs},oA={33071:qn,33648:$c,10497:yo},aA={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_0={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Bs={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},nj={CUBICSPLINE:void 0,LINEAR:Xa,STEP:Xc};function Cu(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Vo(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function sj(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function oj(n){const e=n.extensions&&n.extensions[et.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+lA(e.attributes):n.indices+":"+lA(n.attributes)+":"+n.mode,t}function lA(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function x0(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class aj{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new k6,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={},this.textureLoader=typeof createImageBitmap<"u"&&!1===/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)?new BC(this.options.manager):new SC(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new er(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};Cu(s,a,r),Vo(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[et.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(wr.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=aA[r.type],c=Du[r.componentType],u=c.BYTES_PER_ELEMENT,f=r.byteOffset||0,h=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let g,_;if(h&&h!==u*l){const y=Math.floor(f/h),m="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let x=t.cache.get(m);x||(g=new c(a,y*h,r.count*h/u),x=new Po(g,h/u),t.cache.add(m,x)),_=new Rs(x,l,f%h/u,p)}else g=null===a?new c(r.count*l):new c(a,f,r.count*l),_=new yt(g,l,p);if(void 0!==r.sparse){const v=r.sparse.values.byteOffset||0,w=new(0,Du[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*aA.SCALAR),M=new c(o[2],v,r.sparse.count*l);null!==a&&(_=new yt(_.array.slice(),_.itemSize,_.normalized));for(let T=0,C=w.length;T<C;T++){const R=w[T];if(_.setX(R,M[T*l]),l>=2&&_.setY(R,M[T*l+1]),l>=3&&_.setZ(R,M[T*l+2]),l>=4&&_.setW(R,M[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return _})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,o.name&&(u.name=o.name);const f=(s.samplers||{})[o.sampler]||{};return u.magFilter=sA[f.magFilter]||Rt,u.minFilter=sA[f.minFilter]||vs,u.wrapS=oA[f.wrapS]||yo,u.wrapT=oA[f.wrapT]||yo,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(function(d){return d.clone()}).catch(function(d){throw d});const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(d){c=!0;const f=new Blob([d],{type:o.mimeType});return l=a.createObjectURL(f),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(d){return new Promise(function(f,h){let p=f;!0===t.isImageBitmapLoader&&(p=function(g){const _=new Fn(g);_.needsUpdate=!0,f(_)}),t.load(wr.resolveURL(d,s.path),p,void 0,h)})}).then(function(d){return!0===c&&a.revokeObjectURL(l),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=u,u}assignTexture(e,t,i){const r=this;return this.getDependency("texture",i.index).then(function(s){if(void 0!==i.texCoord&&0!=i.texCoord&&!("aoMap"===t&&1==i.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),r.extensions[et.KHR_TEXTURE_TRANSFORM]){const o=void 0!==i.extensions?i.extensions[et.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const a=r.associations.get(s);s=r.extensions[et.KHR_TEXTURE_TRANSFORM].extendTexture(s,o),r.associations.set(s,a)}}return e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Lo,kt.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new bn,kt.prototype.copy.call(l,i),l.color.copy(i.color),this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";i.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return El}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[et.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const d=r[et.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=d.getMaterialType(),c.push(d.extendParams(a,s,t))}else if(l[et.KHR_MATERIALS_UNLIT]){const d=r[et.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),c.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new re(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const f=d.baseColorFactor;a.color.fromArray(f),a.opacity=f[3]}void 0!==d.baseColorTexture&&c.push(t.assignTexture(a,"map",d.baseColorTexture)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=po);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==bi&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new X(1,1),void 0!==s.normalTexture.scale)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}return void 0!==s.occlusionTexture&&o!==bi&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==bi&&(a.emissive=(new re).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==bi&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture)),Promise.all(c).then(function(){let d;return d=o===y0?r[et.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new o(a),s.name&&(d.name=s.name),d.map&&(d.map.encoding=xt),d.emissiveMap&&(d.emissiveMap.encoding=xt),Vo(d,s),t.associations.set(d,{materials:e}),s.extensions&&Cu(r,d,s),d})}createUniqueName(e){const t=Ct.sanitizeNodeName(e||"");let i=t;for(let r=1;this.nodeNamesUsed[i];++r)i=t+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[et.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return uA(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=oj(c),d=r[u];if(d)o.push(d.promise);else{let f;f=c.extensions&&c.extensions[et.KHR_DRACO_MESH_COMPRESSION]?s(c):uA(new Te,c,t),r[u]={primitive:c,promise:f},o.push(f)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new El({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ho})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(u)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],d=[];for(let h=0,p=u.length;h<p;h++){const g=u[h],_=o[h];let y;const m=c[h];if(4===_.mode||5===_.mode||6===_.mode||void 0===_.mode)y=!0===s.isSkinnedMesh?new wh(g,m):new _n(g,m),!0===y.isSkinnedMesh&&!y.geometry.attributes.skinWeight.normalized&&y.normalizeSkinWeights(),5===_.mode?y.geometry=dA(y.geometry,1):6===_.mode&&(y.geometry=dA(y.geometry,2));else if(1===_.mode)y=new Yr(g,m);else if(3===_.mode)y=new Ps(g,m);else if(2===_.mode)y=new j_(g,m);else{if(0!==_.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_.mode);y=new fu(g,m)}Object.keys(y.geometry.morphAttributes).length>0&&sj(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),Vo(y,s),_.extensions&&Cu(r,y,_),t.assignFinalMaterial(y),d.push(y)}for(let h=0,p=d.length;h<p;h++)t.associations.set(d[h],{meshes:e,primitives:h});if(1===d.length)return d[0];const f=new _r;t.associations.set(f,{meshes:e});for(let h=0,p=d.length;h<p;h++)f.add(d[h]);return f})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new Bt(Kz.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new ou(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Vo(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then(function(r){return i.inverseBindMatrices=r,i})}loadAnimation(e){const i=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let c=0,u=i.channels.length;c<u;c++){const d=i.channels[c],f=i.samplers[d.sampler],h=d.target,g=void 0!==i.parameters?i.parameters[f.input]:f.input,_=void 0!==i.parameters?i.parameters[f.output]:f.output;r.push(this.getDependency("node",void 0!==h.node?h.node:h.id)),s.push(this.getDependency("accessor",g)),o.push(this.getDependency("accessor",_)),a.push(f),l.push(h)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],d=c[1],f=c[2],h=c[3],p=c[4],g=[];for(let y=0,m=u.length;y<m;y++){const x=u[y],v=d[y],w=f[y],M=h[y],T=p[y];if(void 0===x)continue;let C;switch(x.updateMatrix(),x.matrixAutoUpdate=!0,Bs[T.path]){case Bs.weights:C=wu;break;case Bs.rotation:C=No;break;default:C=bu}const R=x.name?x.name:x.uuid,P=void 0!==M.interpolation?nj[M.interpolation]:Xa,b=[];Bs[T.path]===Bs.weights?x.traverse(function(L){L.morphTargetInfluences&&b.push(L.name?L.name:L.uuid)}):b.push(R);let I=w.array;if(w.normalized){const L=x0(I.constructor),F=new Float32Array(I.length);for(let O=0,B=I.length;O<B;O++)F[O]=I[O]*L;I=F}for(let L=0,F=b.length;L<F;L++){const O=new C(b[L]+"."+Bs[T.path],v.array,I,P);"CUBICSPLINE"===M.interpolation&&(O.createInterpolant=function(U){return new(this instanceof No?tj:Uo)(this.times,this.values,this.getValueSize()/3,U)},O.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),g.push(O)}}return new Mu(i.name?i.name:"animation_"+e,void 0,g)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this.extensions,r=this,s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),Promise.all(a)}().then(function(a){let l;if(l=!0===s.isBone?new bh:a.length>1?new _r:1===a.length?a[0]:new ut,l!==a[0])for(let c=0,u=a.length;c<u;c++)l.add(a[c]);if(s.name&&(l.userData.name=s.name,l.name=o),Vo(l,s),s.extensions&&Cu(i,l,s),void 0!==s.matrix){const c=new me;c.fromArray(s.matrix),l.applyMatrix4(c)}else void 0!==s.translation&&l.position.fromArray(s.translation),void 0!==s.rotation&&l.quaternion.fromArray(s.rotation),void 0!==s.scale&&l.scale.fromArray(s.scale);return r.associations.has(l)||r.associations.set(l,{}),r.associations.get(l).nodes=e,l})}loadScene(e){const t=this.json,i=this.extensions,r=this.json.scenes[e],s=this,o=new _r;r.name&&(o.name=s.createUniqueName(r.name)),Vo(o,r),r.extensions&&Cu(i,o,r);const a=r.nodes||[],l=[];for(let c=0,u=a.length;c<u;c++)l.push(cA(a[c],o,t,s));return Promise.all(l).then(function(){return s.associations=(u=>{const d=new Map;for(const[f,h]of s.associations)(f instanceof kt||f instanceof Fn)&&d.set(f,h);return u.traverse(f=>{const h=s.associations.get(f);null!=h&&d.set(f,h)}),d})(o),o})}}function cA(n,e,t,i){const r=t.nodes[n];return i.getDependency("node",n).then(function(s){if(void 0===r.skin)return s;let o;return i.getDependency("skin",r.skin).then(function(a){o=a;const l=[];for(let c=0,u=o.joints.length;c<u;c++)l.push(i.getDependency("node",o.joints[c]));return Promise.all(l)}).then(function(a){return s.traverse(function(l){if(!l.isMesh)return;const c=[],u=[];for(let d=0,f=a.length;d<f;d++){const h=a[d];if(h){c.push(h);const p=new me;void 0!==o.inverseBindMatrices&&p.fromArray(o.inverseBindMatrices.array,16*d),u.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[d])}l.bind(new Mh(c,u),l.matrixWorld)}),s})}).then(function(s){e.add(s);const o=[];if(r.children){const a=r.children;for(let l=0,c=a.length;l<c;l++)o.push(cA(a[l],s,t,i))}return Promise.all(o)})}function uA(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=_0[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Vo(n,e),function lj(n,e,t){const i=e.attributes,r=new xi;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new E(l[0],l[1],l[2]),new E(c[0],c[1],c[2])),a.normalized){const u=x0(Du[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new E,l=new E;for(let c=0,u=s.length;c<u;c++){const d=s[c];if(void 0!==d.POSITION){const f=t.json.accessors[d.POSITION],h=f.min,p=f.max;if(void 0!==h&&void 0!==p){if(l.setX(Math.max(Math.abs(h[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(h[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(h[2]),Math.abs(p[2]))),f.normalized){const g=x0(Du[f.componentType]);l.multiplyScalar(g)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new Ss;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function rj(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const d=e[c];if(void 0!==d.POSITION&&(i=!0),void 0!==d.NORMAL&&(r=!0),void 0!==d.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c];if(i){const f=void 0!==d.POSITION?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(f)}if(r){const f=void 0!==d.NORMAL?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(f)}if(s){const f=void 0!==d.COLOR_0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;l.push(f)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const d=c[1],f=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=f),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}function dA(n,e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s}let cj=(()=>{class n{ngOnInit(){const t=document.querySelector(".webgl"),r=(document.querySelector(".border"),new gh);r.background=new re(16777215);let s=new Bt(75,window.innerWidth/window.innerHeight,.1,100),o=new u0(16777215,7);o.castShadow=!0;let a=new Yh(16777215,.01);a.castShadow=!1,a.position.set(-180,-1500,-100);const l=new _r;let c;l.add(a),l.add(o),r.add(l),(new O6).load("../../assets/movile.glb",p=>{c=p.scene,p.scene.scale.set(1,1,1),r.add(p.scene),h()});const d=new _t({canvas:t});d.setSize(90*window.innerWidth/100-6,90*window.innerHeight/100-118),d.setPixelRatio(Math.min(window.devicePixelRatio,20)),window.innerWidth>1200?(s=new Bt(5,window.innerWidth/window.innerHeight,.1,100),s.position.x=0,s.position.y=0,s.position.z=5,d.setSize(90*window.innerWidth/110-6,90*window.innerHeight/110-109)):(s=new Bt(5,window.innerWidth/window.innerHeight,.1,100),s.position.x=0,s.position.y=0,s.position.z=5,d.setSize(90*window.innerWidth/110-6,90*window.innerHeight/110-118));const f=new zC;function h(){const p=f.getElapsedTime();c.rotation.y=.8*p,d.render(r,s),requestAnimationFrame(h)}r.add(s),window.addEventListener("resize",()=>{window,window,s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),d.setSize(90*window.innerWidth/100-6,90*window.innerHeight/100-118),d.setPixelRatio(Math.min(window.devicePixelRatio,20)),window.innerWidth>1200?(s=new Bt(45,window.innerWidth/window.innerHeight,.1,100),s.position.x=0,s.position.y=-1,s.position.z=5,d.setSize(90*window.innerWidth/100-6,90*window.innerHeight/100-110)):(s=new Bt(75,window.innerWidth/window.innerHeight,.1,100),s.position.x=0,s.position.y=0,s.position.z=5,d.setSize(90*window.innerWidth/100-6,90*window.innerHeight/100-118))})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ta({type:n,selectors:[["app-background"]],decls:1,vars:0,consts:[[1,"webgl","aparecer"]],template:function(t,i){1&t&&pn(0,"canvas",0)},styles:[".webgl[_ngcontent-%COMP%]{position:absolute;top:9rem}.aparecer[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_aparecer-animacion 3s ease-out}@keyframes _ngcontent-%COMP%_aparecer-animacion{0%{opacity:0}to{opacity:1}}@media (min-height: 668px){.webgl[_ngcontent-%COMP%]{position:absolute;top:9.6rem}}@media (min-height: 844px){.webgl[_ngcontent-%COMP%]{position:absolute}}"]}),n})();function ns(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function fA(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}var w0,Bn,jt,Ut,ki,D0,C0,_A,wA,Nl,Ou,l,c,u,d,f,h,n,e,t,i,r,s,o,a,p,Si={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Al={duration:.5,overwrite:!1,delay:0},Oi=1e8,wt=1e-8,b0=2*Math.PI,uj=b0/4,dj=0,hA=Math.sqrt,fj=Math.cos,hj=Math.sin,Mn=function(e){return"string"==typeof e},$t=function(e){return"function"==typeof e},is=function(e){return"number"==typeof e},M0=function(e){return typeof e>"u"},br=function(e){return"object"==typeof e},li=function(e){return!1!==e},S0=function(){return typeof window<"u"},rp=function(e){return $t(e)||Mn(e)},pA="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Hn=Array.isArray,E0=/(?:-?\.?\d|\.)+/gi,mA=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Il=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,T0=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,gA=/[+-]=-?[.\d]+/,yA=/[^,'"\[\]\s]+/gi,pj=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Ei={},sp={},vA=function(e){return(sp=Go(e,Ei))&&di},A0=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},op=function(e,t){return!t&&console.warn(e)},xA=function(e,t){return e&&(Ei[e]=t)&&sp&&(sp[e]=t)||Ei},Au=function(){return 0},mj={suppressEvents:!0,isStart:!0,kill:!1},ap={suppressEvents:!0,kill:!1},gj={suppressEvents:!0},I0={},Hs=[],R0={},Ti={},P0={},bA=30,lp=[],L0="",N0=function(e){var i,r,t=e[0];if(br(t)||$t(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(r=lp.length;r--&&!lp[r].targetTest(t););i=lp[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new KA(e[r],i)))||e.splice(r,1);return e},zo=function(e){return e._gsap||N0(Ui(e))[0]._gsap},MA=function(e,t,i){return(i=e[t])&&$t(i)?e[t]():M0(i)&&e.getAttribute&&e.getAttribute(t)||i},ci=function(e,t){return(e=e.split(",")).forEach(t)||e},Jt=function(e){return Math.round(1e5*e)/1e5||0},An=function(e){return Math.round(1e7*e)/1e7||0},Rl=function(e,t){var i=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),"+"===i?e+r:"-"===i?e-r:"*"===i?e*r:e/r},yj=function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i},cp=function(){var i,r,e=Hs.length,t=Hs.slice(0);for(R0={},Hs.length=0,i=0;i<e;i++)(r=t[i])&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},SA=function(e,t,i,r){Hs.length&&!Bn&&cp(),e.render(t,i,r||Bn&&t<0&&(e._initted||e._startAt)),Hs.length&&!Bn&&cp()},EA=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(yA).length<2?t:Mn(e)?e.trim():e},TA=function(e){return e},Bi=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Go=function(e,t){for(var i in t)e[i]=t[i];return e},DA=function n(e,t){for(var i in t)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=br(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},up=function(e,t){var r,i={};for(r in e)r in t||(i[r]=e[r]);return i},Iu=function(e){var t=e.parent||Ut,i=e.keyframes?function(e){return function(t,i){for(var r in i)r in t||"duration"===r&&e||"ease"===r||(t[r]=i[r])}}(Hn(e.keyframes)):Bi;if(li(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},CA=function(e,t,i,r,s){void 0===i&&(i="_first"),void 0===r&&(r="_last");var a,o=e[r];if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},dp=function(e,t,i,r){void 0===i&&(i="_first"),void 0===r&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[i]===t&&(e[i]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},Us=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Wo=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},F0=function(e,t,i,r){return e._startAt&&(Bn?e._startAt.revert(ap):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},wj=function n(e){return!e||e._ts&&n(e.parent)},AA=function(e){return e._repeat?Pl(e._tTime,e=e.duration()+e._rDelay)*e:0},Pl=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},fp=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},hp=function(e){return e._end=An(e._start+(e._tDur/Math.abs(e._ts||e._rts||wt)||0))},pp=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=An(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),hp(e),i._dirty||Wo(i,e)),e},IA=function(e,t){var i;if((t._time||t._initted&&!t._dur)&&(i=fp(e.rawTime(),t),(!t._dur||Pu(0,t.totalDuration(),i)-t._tTime>wt)&&t.render(i,!0)),Wo(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-wt}},Mr=function(e,t,i,r){return t.parent&&Us(t),t._start=An((is(i)?i:i||e!==Ut?Hi(e,i,t):e._time)+t._delay),t._end=An(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),CA(e,t,"_first","_last",e._sort?"_start":0),O0(t)||(e._recent=t),r||IA(e,t),e._ts<0&&pp(e,e._tTime),e},RA=function(e,t){return(Ei.ScrollTrigger||A0("scrollTrigger",t))&&Ei.ScrollTrigger.create(t,e)},PA=function(e,t,i,r,s){return j0(e,t,s),e._initted?!i&&e._pt&&!Bn&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&wA!==Di.frame?(Hs.push(e),e._lazy=[s,r],1):void 0:1},bj=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},O0=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},Ll=function(e,t,i,r){var s=e._repeat,o=An(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:An(o*(s+1)+e._rDelay*s):o,a>0&&!r&&pp(e,e._tTime=e._tDur*a),e.parent&&hp(e),i||Wo(e.parent,e),e},LA=function(e){return e instanceof Zn?Wo(e):Ll(e,e._dur)},Ej={_start:0,endTime:Au,totalDuration:Au},Hi=function n(e,t,i){var a,l,c,r=e.labels,s=e._recent||Ej,o=e.duration()>=Oi?s.endTime(!1):e._dur;return Mn(t)&&(isNaN(t)||t in r)?(l=t.charAt(0),c="%"===t.substr(-1),a=t.indexOf("="),"<"===l||">"===l?(a>=0&&(t=t.replace(/=/,"")),("<"===l?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(a<0?s:i).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),c&&i&&(l=l/100*(Hn(i)?i[0]:i).totalDuration()),a>1?n(e,t.substr(0,a-1),i)+l:o+l)):null==t?o:+t},Ru=function(e,t,i){var a,l,r=is(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s];if(r&&(o.duration=t[1]),o.parent=i,e){for(a=o,l=i;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=li(l.vars.inherit)&&l.parent;o.immediateRender=li(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new cn(t[0],o,t[s+1])},Vs=function(e,t){return e||0===e?t(e):t},Pu=function(e,t,i){return i<e?e:i>t?t:i},Un=function(e,t){return Mn(e)&&(t=pj.exec(e))?t[1]:""},k0=[].slice,NA=function(e,t){return e&&br(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&br(e[0]))&&!e.nodeType&&e!==ki},Ui=function(e,t,i){return jt&&!t&&jt.selector?jt.selector(e):!Mn(e)||i||!D0&&Fl()?Hn(e)?function(e,t,i){return void 0===i&&(i=[]),e.forEach(function(r){var s;return Mn(r)&&!t||NA(r,1)?(s=i).push.apply(s,Ui(r)):i.push(r)})||i}(e,i):NA(e)?k0.call(e,0):e?[e]:[]:k0.call((t||C0).querySelectorAll(e),0)},B0=function(e){return e=Ui(e)[0]||op("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return Ui(t,i.querySelectorAll?i:i===e?op("Invalid scope")||C0.createElement("div"):e)}},FA=function(e){return e.sort(function(){return.5-Math.random()})},OA=function(e){if($t(e))return e;var t=br(e)?e:{each:e},i=jo(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},a=r>0&&r<1,l=isNaN(r)||a,c=t.axis,u=r,d=r;return Mn(r)?u=d={center:.5,edges:.5,end:1}[r]||0:!a&&l&&(u=r[0],d=r[1]),function(f,h,p){var y,m,x,v,w,M,T,C,R,g=(p||t).length,_=o[g];if(!_){if(!(R="auto"===t.grid?0:(t.grid||[1,Oi])[1])){for(T=-Oi;T<(T=p[R++].getBoundingClientRect().left)&&R<g;);R--}for(_=o[g]=[],y=l?Math.min(R,g)*u-.5:r%R,m=R===Oi?0:l?g*d/R-.5:r/R|0,T=0,C=Oi,M=0;M<g;M++)x=M%R-y,v=m-(M/R|0),_[M]=w=c?Math.abs("y"===c?v:x):hA(x*x+v*v),w>T&&(T=w),w<C&&(C=w);"random"===r&&FA(_),_.max=T-C,_.min=C,_.v=g=(parseFloat(t.amount)||parseFloat(t.each)*(R>g?g-1:c?"y"===c?g/R:R:Math.max(R,g/R))||0)*("edges"===r?-1:1),_.b=g<0?s-g:s,_.u=Un(t.amount||t.each)||0,i=i&&g<0?XA(i):i}return g=(_[f]-_.min)/_.max||0,An(_.b+(i?i(g):g)*_.v)+_.u}},H0=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var r=An(Math.round(parseFloat(i)/e)*e*t);return(r-r%1)/t+(is(i)?0:Un(i))}},kA=function(e,t){var r,s,i=Hn(e);return!i&&br(e)&&(r=i=e.radius||Oi,e.values?(e=Ui(e.values),(s=!is(e[0]))&&(r*=r)):e=H0(e.increment)),Vs(t,i?$t(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var f,h,a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),c=Oi,u=0,d=e.length;d--;)(f=s?(f=e[d].x-a)*f+(h=e[d].y-l)*h:Math.abs(e[d]-a))<c&&(c=f,u=d);return u=!r||c<=r?e[u]:o,s||u===o||is(o)?u:u+Un(o)}:H0(e))},BA=function(e,t,i,r){return Vs(Hn(e)?!t:!0===i?!!(i=0):!r,function(){return Hn(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+.99*i))/i)*i*r)/r})},HA=function(e,t,i){return Vs(i,function(r){return e[~~t(r)]})},Lu=function(e){for(var r,s,o,a,t=0,i="";~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),a="["===e.charAt(r+7),s=e.substr(r+7,o-r-7).match(a?yA:E0),i+=e.substr(t,r-t)+BA(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return i+e.substr(t,e.length-t)},UA=function(e,t,i,r,s){var o=t-e,a=r-i;return Vs(s,function(l){return i+((l-e)/o*a||0)})},VA=function(e,t,i){var o,a,l,r=e.labels,s=Oi;for(o in r)(a=r[o]-t)<0==!!i&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},Vi=function(e,t,i){var l,c,u,r=e.vars,s=r[t],o=jt,a=e._ctx;if(s)return l=r[t+"Params"],c=r.callbackScope||e,i&&Hs.length&&cp(),a&&(jt=a),u=l?s.apply(c,l):s.call(c),jt=o,u},Nu=function(e){return Us(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Bn),e.progress()<1&&Vi(e,"onInterrupt"),e},zA=[],GA=function(e){if(S0()&&e){var t=(e=!e.name&&e.default||e).name,i=$t(e),r=t&&!i&&e.init?function(){this._props=[]}:e,s={init:Au,render:X0,add:G0,kill:Yj,modifier:Xj,rawVars:0},o={targetTest:0,get:0,getSetter:q0,aliases:{},register:0};if(Fl(),e!==r){if(Ti[t])return;Bi(r,Bi(up(e,s),o)),Go(r.prototype,Go(s,up(e,o))),Ti[r.prop=t]=r,e.targetTest&&(lp.push(r),I0[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}xA(t,r),e.register&&e.register(di,r,ui)}else e&&zA.push(e)},bt=255,Fu={aqua:[0,bt,bt],lime:[0,bt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,bt],navy:[0,0,128],white:[bt,bt,bt],olive:[128,128,0],yellow:[bt,bt,0],orange:[bt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[bt,0,0],pink:[bt,192,203],cyan:[0,bt,bt],transparent:[bt,bt,bt,0]},U0=function(e,t,i){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(i-t)*e*6:e<.5?i:3*e<2?t+(i-t)*(2/3-e)*6:t)*bt+.5|0},WA=function(e,t,i){var s,o,a,l,c,u,d,f,h,p,r=e?is(e)?[e>>16,e>>8&bt,e&bt]:0:Fu.black;if(!r){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),Fu[e])r=Fu[e];else if("#"===e.charAt(0)){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(r=parseInt(e.substr(1,6),16))>>16,r>>8&bt,r&bt,parseInt(e.substr(7),16)/255];r=[(e=parseInt(e.substr(1),16))>>16,e>>8&bt,e&bt]}else if("hsl"===e.substr(0,3))if(r=p=e.match(E0),t){if(~e.indexOf("="))return r=e.match(mA),i&&r.length<4&&(r[3]=1),r}else l=+r[0]%360/360,c=+r[1]/100,s=2*(u=+r[2]/100)-(o=u<=.5?u*(c+1):u+c-u*c),r.length>3&&(r[3]*=1),r[0]=U0(l+1/3,s,o),r[1]=U0(l,s,o),r[2]=U0(l-1/3,s,o);else r=e.match(E0)||Fu.transparent;r=r.map(Number)}return t&&!p&&(s=r[0]/bt,o=r[1]/bt,a=r[2]/bt,u=((d=Math.max(s,o,a))+(f=Math.min(s,o,a)))/2,d===f?l=c=0:(h=d-f,c=u>.5?h/(2-d-f):h/(d+f),l=d===s?(o-a)/h+(o<a?6:0):d===o?(a-s)/h+2:(s-o)/h+4,l*=60),r[0]=~~(l+.5),r[1]=~~(100*c+.5),r[2]=~~(100*u+.5)),i&&r.length<4&&(r[3]=1),r},jA=function(e){var t=[],i=[],r=-1;return e.split(zs).forEach(function(s){var o=s.match(Il)||[];t.push.apply(t,o),i.push(r+=o.length+1)}),t.c=i,t},$A=function(e,t,i){var l,c,u,d,r="",s=(e+r).match(zs),o=t?"hsla(":"rgba(",a=0;if(!s)return e;if(s=s.map(function(f){return(f=WA(f,t,1))&&o+(t?f[0]+","+f[1]+"%,"+f[2]+"%,"+f[3]:f.join(","))+")"}),i&&(u=jA(e),(l=i.c).join(r)!==u.c.join(r)))for(d=(c=e.replace(zs,"1").split(Il)).length-1;a<d;a++)r+=c[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:i).shift());if(!c)for(d=(c=e.split(zs)).length-1;a<d;a++)r+=c[a]+s[a];return r+c[d]},zs=function(){var e,n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in Fu)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),Nj=/hsl[a]?\(/,qA=function(e){var i,t=e.join(" ");if(zs.lastIndex=0,zs.test(t))return i=Nj.test(t),e[1]=$A(e[1],i),e[0]=$A(e[0],i,jA(e[1])),!0},Di=(n=Date.now,e=500,t=33,i=n(),r=i,o=s=1e3/240,p=function g(_){var x,v,w,M,y=n()-r,m=!0===_;if(y>e&&(i+=y-t),((x=(w=(r+=y)-i)-o)>0||m)&&(M=++d.frame,f=w-1e3*d.time,d.time=w/=1e3,o+=x+(x>=s?4:s-x),v=1),m||(l=c(g)),v)for(h=0;h<a.length;h++)a[h](w,f,M,_)},d={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(_){return f/(1e3/(_||60))},wake:function(){_A&&(!D0&&S0()&&(ki=D0=window,C0=ki.document||{},Ei.gsap=di,(ki.gsapVersions||(ki.gsapVersions=[])).push(di.version),vA(sp||ki.GreenSockGlobals||!ki.gsap&&ki||{}),u=ki.requestAnimationFrame,zA.forEach(GA)),l&&d.sleep(),c=u||function(_){return setTimeout(_,o-1e3*d.time+1|0)},Ou=1,p(2))},sleep:function(){(u?ki.cancelAnimationFrame:clearTimeout)(l),Ou=0,c=Au},lagSmoothing:function(_,y){e=_||1/0,t=Math.min(y||33,e)},fps:function(_){o=1e3*d.time+(s=1e3/(_||240))},add:function(_,y,m){var x=y?function(v,w,M,T){_(v,w,M,T),d.remove(x)}:_;return d.remove(_),a[m?"unshift":"push"](x),Fl(),x},remove:function(_,y){~(y=a.indexOf(_))&&a.splice(y,1)&&h>=y&&h--},_listeners:a=[]}),Fl=function(){return!Ou&&Di.wake()},tt={},Fj=/^[\d.\-M][\d.\-,\s]/,Oj=/["']/g,kj=function(e){for(var a,l,c,t={},i=e.substr(1,e.length-3).split(":"),r=i[0],s=1,o=i.length;s<o;s++)l=i[s],a=s!==o-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),t[r]=isNaN(c)?c.replace(Oj,"").trim():+c,r=l.substr(a+1).trim();return t},XA=function(e){return function(t){return 1-e(1-t)}},YA=function n(e,t){for(var r,i=e._first;i;)i instanceof Zn?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},jo=function(e,t){return e&&($t(e)?e:tt[e]||function(e){var t=(e+"").split("("),i=tt[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[kj(t[1])]:function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<i?e.indexOf(")",i+1):i)}(e).split(",").map(EA)):tt._CE&&Fj.test(e)?tt._CE("",e):i}(e))||t},$o=function(e,t,i,r){void 0===i&&(i=function(l){return 1-t(1-l)}),void 0===r&&(r=function(l){return l<.5?t(2*l)/2:1-t(2*(1-l))/2});var o,s={easeIn:t,easeOut:i,easeInOut:r};return ci(e,function(a){for(var l in tt[a]=Ei[a]=s,tt[o=a.toLowerCase()]=i,s)tt[o+("easeIn"===l?".in":"easeOut"===l?".out":".inOut")]=tt[a+"."+l]=s[l]}),s},ZA=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},V0=function n(e,t,i){var r=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),o=s/b0*(Math.asin(1/r)||0),a=function(u){return 1===u?1:r*Math.pow(2,-10*u)*hj((u-o)*s)+1},l="out"===e?a:"in"===e?function(c){return 1-a(1-c)}:ZA(a);return s=b0/s,l.config=function(c,u){return n(e,c,u)},l},z0=function n(e,t){void 0===t&&(t=1.70158);var i=function(o){return o?--o*o*((t+1)*o+t)+1:0},r="out"===e?i:"in"===e?function(s){return 1-i(1-s)}:ZA(i);return r.config=function(s){return n(e,s)},r};ci("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;$o(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(2*i,t)/2:1-Math.pow(2*(1-i),t)/2})}),tt.Linear.easeNone=tt.none=tt.Linear.easeIn,$o("Elastic",V0("in"),V0("out"),V0()),function(n,e){var s=function(a){return a<.36363636363636365?n*a*a:a<.7272727272727273?n*Math.pow(a-1.5/e,2)+.75:a<.9090909090909092?n*(a-=2.25/e)*a+.9375:n*Math.pow(a-2.625/e,2)+.984375};$o("Bounce",function(o){return 1-s(1-o)},s)}(7.5625,2.75),$o("Expo",function(n){return n?Math.pow(2,10*(n-1)):0}),$o("Circ",function(n){return-(hA(1-n*n)-1)}),$o("Sine",function(n){return 1===n?1:1-fj(n*uj)}),$o("Back",z0("in"),z0("out"),z0()),tt.SteppedEase=tt.steps=Ei.SteppedEase={config:function(e,t){void 0===e&&(e=1);var i=1/e,r=e+(t?0:1),s=t?1:0;return function(a){return((r*Pu(0,.99999999,a)|0)+s)*i}}},Al.ease=tt["quad.out"],ci("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return L0+=n+","+n+"Params,"});var KA=function(e,t){this.id=dj++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:MA,this.set=t?t.getSetter:q0},ku=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Ll(this,+t.duration,1,1),this.data=t.data,jt&&(this._ctx=jt,jt.data.push(this)),Ou||Di.wake()}var e=n.prototype;return e.delay=function(i){return i||0===i?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,Ll(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,r){if(Fl(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(pp(this,i),!s._dp||s.parent||IA(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&Mr(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===wt||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),SA(this,i,r)),this},e.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+AA(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},e.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?i:1-i)+AA(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(i,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,r):this._repeat?Pl(this._tTime,s)+1:1},e.timeScale=function(i){if(!arguments.length)return this._rts===-wt?0:this._rts;if(this._rts===i)return this;var r=this.parent&&this._ts?fp(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-wt?0:this._rts,this.totalTime(Pu(-Math.abs(this._delay),this._tDur,r),!0),hp(this),function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Fl(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==wt&&(this._tTime-=wt)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&Mr(r,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(li(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?fp(r.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){void 0===i&&(i=gj);var r=Bn;return Bn=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),"nested"!==this.data&&!1!==i.kill&&this.kill(),Bn=r,this},e.globalTime=function(i){for(var r=this,s=arguments.length?i:r.rawTime();r;)s=r._start+s/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,LA(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,LA(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,r){return this.totalTime(Hi(this,i),li(r))},e.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,li(r))},e.play=function(i,r){return null!=i&&this.seek(i,r),this.reversed(!1).paused(!1)},e.reverse=function(i,r){return null!=i&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(i,r){return null!=i&&this.seek(i,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-wt:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-wt,this},e.isActive=function(){var s,i=this.parent||this._dp,r=this._start;return!(i&&!(this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=r&&s<this.endTime(!0)-wt))},e.eventCallback=function(i,r,s){var o=this.vars;return arguments.length>1?(r?(o[i]=r,s&&(o[i+"Params"]=s),"onUpdate"===i&&(this._onUpdate=r)):delete o[i],this):o[i]},e.then=function(i){var r=this;return new Promise(function(s){var o=$t(i)?i:TA,a=function(){var c=r.then;r.then=null,$t(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=c),s(o),r.then=c};r._initted&&1===r.totalProgress()&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){Nu(this)},n}();Bi(ku.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-wt,_prom:0,_ps:!1,_rts:1});var Zn=function(n){function e(i,r){var s;return void 0===i&&(i={}),(s=n.call(this,i)||this).labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=li(i.sortChildren),Ut&&Mr(i.parent||Ut,ns(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&RA(ns(s),i.scrollTrigger),s}fA(e,n);var t=e.prototype;return t.to=function(r,s,o){return Ru(0,arguments,this),this},t.from=function(r,s,o){return Ru(1,arguments,this),this},t.fromTo=function(r,s,o,a){return Ru(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,Iu(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new cn(r,s,Hi(this,o),1),this},t.call=function(r,s,o){return Mr(this,cn.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,a,l,c,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=c,o.onCompleteParams=u,o.parent=this,new cn(r,o,Hi(this,l)),this},t.staggerFrom=function(r,s,o,a,l,c,u){return o.runBackwards=1,Iu(o).immediateRender=li(o.immediateRender),this.staggerTo(r,s,o,a,l,c,u)},t.staggerFromTo=function(r,s,o,a,l,c,u,d){return a.startAt=o,Iu(a).immediateRender=li(a.immediateRender),this.staggerTo(r,s,a,l,c,u,d)},t.render=function(r,s,o){var f,h,p,g,_,y,m,x,v,w,M,T,a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,u=r<=0?0:An(r),d=this._zTime<0!=r<0&&(this._initted||!c);if(this!==Ut&&u>l&&r>=0&&(u=l),u!==this._tTime||o||d){if(a!==this._time&&c&&(u+=this._time-a,r+=this._time-a),f=u,v=this._start,y=!(x=this._ts),d&&(c||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(M=this._yoyo,_=c+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(100*_+r,s,o);if(f=An(u%_),u===l?(g=this._repeat,f=c):((g=~~(u/_))&&g===u/_&&(f=c,g--),f>c&&(f=c)),w=Pl(this._tTime,_),!a&&this._tTime&&w!==g&&this._tTime-w*_-this._dur<=0&&(w=g),M&&1&g&&(f=c-f,T=1),g!==w&&!this._lock){var C=M&&1&w,R=C===(M&&1&g);if(g<w&&(C=!C),a=C?0:c,this._lock=1,this.render(a||(T?0:An(g*_)),s,!c)._lock=0,this._tTime=u,!s&&this.parent&&Vi(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),a&&a!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,R&&(this._lock=2,this.render(a=C?c:-1e-4,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;YA(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(m=function(e,t,i){var r;if(i>t)for(r=e._first;r&&r._start<=i;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,An(a),An(f)),m&&(u-=f-(f=m._start))),this._tTime=u,this._time=f,this._act=!x,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&f&&!s&&!g&&(Vi(this,"onStart"),this._tTime!==u))return this;if(f>=a&&r>=0)for(h=this._first;h;){if(p=h._next,(h._act||f>=h._start)&&h._ts&&m!==h){if(h.parent!==this)return this.render(r,s,o);if(h.render(h._ts>0?(f-h._start)*h._ts:(h._dirty?h.totalDuration():h._tDur)+(f-h._start)*h._ts,s,o),f!==this._time||!this._ts&&!y){m=0,p&&(u+=this._zTime=-wt);break}}h=p}else{h=this._last;for(var P=r<0?r:f;h;){if(p=h._prev,(h._act||P<=h._end)&&h._ts&&m!==h){if(h.parent!==this)return this.render(r,s,o);if(h.render(h._ts>0?(P-h._start)*h._ts:(h._dirty?h.totalDuration():h._tDur)+(P-h._start)*h._ts,s,o||Bn&&(h._initted||h._startAt)),f!==this._time||!this._ts&&!y){m=0,p&&(u+=this._zTime=P?-wt:wt);break}}h=p}}if(m&&!s&&(this.pause(),m.render(f>=a?0:-wt)._zTime=f>=a?1:-1,this._ts))return this._start=v,hp(this),this.render(r,s,o);this._onUpdate&&!s&&Vi(this,"onUpdate",!0),(u===l&&this._tTime>=this.totalDuration()||!u&&a)&&(v===this._start||Math.abs(x)!==Math.abs(this._ts))&&(this._lock||((r||!c)&&(u===l&&this._ts>0||!u&&this._ts<0)&&Us(this,1),!s&&(!(r<0)||a)&&(u||a||!l)&&(Vi(this,u===l&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(is(s)||(s=Hi(this,s,r)),!(r instanceof ku)){if(Hn(r))return r.forEach(function(a){return o.add(a,s)}),this;if(Mn(r))return this.addLabel(r,s);if(!$t(r))return this;r=cn.delayedCall(0,r)}return this!==r?Mr(this,r,s):this},t.getChildren=function(r,s,o,a){void 0===r&&(r=!0),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=-Oi);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof cn?s&&l.push(c):(o&&l.push(c),r&&l.push.apply(l,c.getChildren(!0,s,o)))),c=c._next;return l},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return Mn(r)?this.removeLabel(r):$t(r)?this.killTweensOf(r):(dp(this,r),r===this._recent&&(this._recent=this._last),Wo(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=An(Di.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=Hi(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var a=cn.delayedCall(0,s||Au,o);return a.data="isPause",this._hasPause=1,Mr(this,a,Hi(this,r))},t.removePause=function(r){var s=this._first;for(r=Hi(this,r);s;)s._start===r&&"isPause"===s.data&&Us(s),s=s._next},t.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),l=a.length;l--;)Gs!==a[l]&&a[l].kill(r,s);return this},t.getTweensOf=function(r,s){for(var u,o=[],a=Ui(r),l=this._first,c=is(s);l;)l instanceof cn?yj(l._targets,a)&&(c?(!Gs||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(u=l.getTweensOf(a,s)).length&&o.push.apply(o,u),l=l._next;return o},t.tweenTo=function(r,s){s=s||{};var h,o=this,a=Hi(o,r),c=s.startAt,u=s.onStart,d=s.onStartParams,f=s.immediateRender,p=cn.to(o,Bi({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale())||wt,onStart:function(){if(o.pause(),!h){var _=s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale());p._dur!==_&&Ll(p,_,0,1).render(p._time,!0,!0),h=1}u&&u.apply(p,d||[])}},s));return f?p.render(0):p},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,Bi({startAt:{time:Hi(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return void 0===r&&(r=this._time),VA(this,Hi(this,r))},t.previousLabel=function(r){return void 0===r&&(r=this._time),VA(this,Hi(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+wt)},t.shiftChildren=function(r,s,o){void 0===o&&(o=0);for(var c,a=this._first,l=this.labels;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(c in l)l[c]>=o&&(l[c]+=r);return Wo(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return n.prototype.invalidate.call(this,r)},t.clear=function(r){void 0===r&&(r=!0);for(var o,s=this._first;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Wo(this)},t.totalDuration=function(r){var c,u,d,s=0,o=this,a=o._last,l=Oi;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(d=o.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),(u=a._start)>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Mr(o,a,u-a._delay,1)._lock=0):l=u,u<0&&a._ts&&(s-=u,(!d&&!o._dp||d&&d.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=c;Ll(o,o===Ut&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(Ut._ts&&(SA(Ut,fp(r,Ut)),wA=Di.frame),Di.frame>=bA){bA+=Si.autoSleep||120;var s=Ut._first;if((!s||!s._ts)&&Si.autoSleep&&Di._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Di.sleep()}}},e}(ku);Bi(Zn.prototype,{_lock:0,_hasPause:0,_forcing:0});var Gs,W0,Uj=function(e,t,i,r,s,o,a){var d,f,h,p,g,_,y,m,l=new ui(this._pt,e,t,0,1,iI,null,s),c=0,u=0;for(l.b=i,l.e=r,i+="",(y=~(r+="").indexOf("random("))&&(r=Lu(r)),o&&(o(m=[i,r],e,t),i=m[0],r=m[1]),f=i.match(T0)||[];d=T0.exec(r);)p=d[0],g=r.substring(c,d.index),h?h=(h+1)%5:"rgba("===g.substr(-5)&&(h=1),p!==f[u++]&&(_=parseFloat(f[u-1])||0,l._pt={_next:l._pt,p:g||1===u?g:",",s:_,c:"="===p.charAt(1)?Rl(_,p)-_:parseFloat(p)-_,m:h&&h<4?Math.round:0},c=T0.lastIndex);return l.c=c<r.length?r.substring(c,r.length):"",l.fp=a,(gA.test(r)||y)&&(l.e=0),this._pt=l,l},G0=function(e,t,i,r,s,o,a,l,c,u){$t(r)&&(r=r(s||0,e,o));var p,d=e[t],f="get"!==i?i:$t(d)?c?e[t.indexOf("set")||!$t(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():d,h=$t(d)?c?jj:tI:$0;if(Mn(r)&&(~r.indexOf("random(")&&(r=Lu(r)),"="===r.charAt(1)&&((p=Rl(f,r)+(Un(f)||0))||0===p)&&(r=p)),!u||f!==r||W0)return isNaN(f*r)||""===r?(!d&&!(t in e)&&A0(t,r),Uj.call(this,e,t,f,r,h,l||Si.stringFilter,c)):(p=new ui(this._pt,e,t,+f||0,r-(f||0),"boolean"==typeof d?qj:nI,0,h),c&&(p.fp=c),a&&p.modifier(a,this,e),this._pt=p)},JA=function(e,t,i,r,s,o){var a,l,c,u;if(Ti[e]&&!1!==(a=new Ti[e]).init(s,a.rawVars?t[e]:function(e,t,i,r,s){if($t(e)&&(e=Bu(e,s,t,i,r)),!br(e)||e.style&&e.nodeType||Hn(e)||pA(e))return Mn(e)?Bu(e,s,t,i,r):e;var a,o={};for(a in e)o[a]=Bu(e[a],s,t,i,r);return o}(t[e],r,s,o,i),i,r,o)&&(i._pt=l=new ui(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==Nl))for(c=i._ptLookup[i._targets.indexOf(s)],u=a._props.length;u--;)c[a._props[u]]=l;return a},j0=function n(e,t,i){var T,C,R,P,b,I,L,F,O,B,U,k,j,r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,l=r.lazy,c=r.onUpdate,u=r.onUpdateParams,d=r.callbackScope,f=r.runBackwards,h=r.yoyoEase,p=r.keyframes,g=r.autoRevert,_=e._dur,y=e._startAt,m=e._targets,x=e.parent,v=x&&"nested"===x.data?x.vars.targets:m,w="auto"===e._overwrite&&!w0,M=e.timeline;if(M&&(!p||!s)&&(s="none"),e._ease=jo(s,Al.ease),e._yEase=h?XA(jo(!0===h?s:h,Al.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!M&&!!r.runBackwards,!M||p&&!r.stagger){if(k=(F=m[0]?zo(m[0]).harness:0)&&r[F.prop],T=up(r,I0),y&&(y._zTime<0&&y.progress(1),t<0&&f&&a&&!g?y.render(-1,!0):y.revert(f&&_?ap:mj),y._lazy=0),o){if(Us(e._startAt=cn.set(m,Bi({data:"isStart",overwrite:!1,parent:x,immediateRender:!0,lazy:!y&&li(l),startAt:null,delay:0,onUpdate:c,onUpdateParams:u,callbackScope:d,stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Bn||!a&&!g)&&e._startAt.revert(ap),a&&_&&t<=0&&i<=0)return void(t&&(e._zTime=t))}else if(f&&_&&!y)if(t&&(a=!1),R=Bi({overwrite:!1,data:"isFromStart",lazy:a&&!y&&li(l),immediateRender:a,stagger:0,parent:x},T),k&&(R[F.prop]=k),Us(e._startAt=cn.set(m,R)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Bn?e._startAt.revert(ap):e._startAt.render(-1,!0)),e._zTime=t,a){if(!t)return}else n(e._startAt,wt,wt);for(e._pt=e._ptCache=0,l=_&&li(l)||l&&!_,C=0;C<m.length;C++){if(L=(b=m[C])._gsap||N0(m)[C]._gsap,e._ptLookup[C]=B={},R0[L.id]&&Hs.length&&cp(),U=v===m?C:v.indexOf(b),F&&!1!==(O=new F).init(b,k||T,e,U,v)&&(e._pt=P=new ui(e._pt,b,O.name,0,1,O.render,O,0,O.priority),O._props.forEach(function(J){B[J]=P}),O.priority&&(I=1)),!F||k)for(R in T)Ti[R]&&(O=JA(R,T,e,U,b,v))?O.priority&&(I=1):B[R]=P=G0.call(e,b,R,"get",T[R],U,v,0,r.stringFilter);e._op&&e._op[C]&&e.kill(b,e._op[C]),w&&e._pt&&(Gs=e,Ut.killTweensOf(b,B,e.globalTime(t)),j=!e.parent,Gs=0),e._pt&&l&&(R0[L.id]=1)}I&&rI(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!j,p&&t<=0&&M.render(Oi,!0,!0)},Wj=function(e,t,i,r){var o,a,s=t.ease||r||"power1.inOut";if(Hn(t))a=i[e]||(i[e]=[]),t.forEach(function(l,c){return a.push({t:c/(t.length-1)*100,v:l,e:s})});else for(o in t)a=i[o]||(i[o]=[]),"ease"===o||a.push({t:parseFloat(e),v:t[o],e:s})},Bu=function(e,t,i,r,s){return $t(e)?e.call(t,i,r,s):Mn(e)&&~e.indexOf("random(")?Lu(e):e},QA=L0+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",eI={};ci(QA+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return eI[n]=1});var cn=function(n){function e(i,r,s,o){var a;"number"==typeof r&&(s.duration=r,r=s,s=null);var v,w,M,T,C,R,P,b,l=(a=n.call(this,o?r:Iu(r))||this).vars,c=l.duration,u=l.delay,d=l.immediateRender,f=l.stagger,h=l.overwrite,p=l.keyframes,g=l.defaults,_=l.scrollTrigger,y=l.yoyoEase,m=r.parent||Ut,x=(Hn(i)||pA(i)?is(i[0]):"length"in r)?[i]:Ui(i);if(a._targets=x.length?N0(x):op("GSAP target "+i+" not found. https://greensock.com",!Si.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=h,p||f||rp(c)||rp(u)){if(r=a.vars,(v=a.timeline=new Zn({data:"nested",defaults:g||{},targets:m&&"nested"===m.data?m.vars.targets:x})).kill(),v.parent=v._dp=ns(a),v._start=0,f||rp(c)||rp(u)){if(T=x.length,P=f&&OA(f),br(f))for(C in f)~QA.indexOf(C)&&(b||(b={}),b[C]=f[C]);for(w=0;w<T;w++)(M=up(r,eI)).stagger=0,y&&(M.yoyoEase=y),b&&Go(M,b),R=x[w],M.duration=+Bu(c,ns(a),w,R,x),M.delay=(+Bu(u,ns(a),w,R,x)||0)-a._delay,!f&&1===T&&M.delay&&(a._delay=u=M.delay,a._start+=u,M.delay=0),v.to(R,M,P?P(w,R,x):0),v._ease=tt.none;v.duration()?c=u=0:a.timeline=0}else if(p){Iu(Bi(v.vars.defaults,{ease:"none"})),v._ease=jo(p.ease||r.ease||"none");var L,F,O,I=0;if(Hn(p))p.forEach(function(B){return v.to(x,B,">")}),v.duration();else{for(C in M={},p)"ease"===C||"easeEach"===C||Wj(C,p[C],M,p.easeEach);for(C in M)for(L=M[C].sort(function(B,U){return B.t-U.t}),I=0,w=0;w<L.length;w++)(O={ease:(F=L[w]).e,duration:(F.t-(w?L[w-1].t:0))/100*c})[C]=F.v,v.to(x,O,I),I+=O.duration;v.duration()<c&&v.to({},{duration:c-v.duration()})}}c||a.duration(c=v.duration())}else a.timeline=0;return!0===h&&!w0&&(Gs=ns(a),Ut.killTweensOf(x),Gs=0),Mr(m,ns(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(d||!c&&!p&&a._start===An(m._time)&&li(d)&&wj(ns(a))&&"nested"!==m.data)&&(a._tTime=-wt,a.render(Math.max(0,-u)||0)),_&&RA(ns(a),_),a}fA(e,n);var t=e.prototype;return t.render=function(r,s,o){var f,h,p,g,_,y,m,x,v,a=this._time,l=this._tDur,c=this._dur,u=r<0,d=r>l-wt&&!u?l:r<wt?0:r;if(c){if(d!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(f=d,x=this.timeline,this._repeat){if(g=c+this._rDelay,this._repeat<-1&&u)return this.totalTime(100*g+r,s,o);if(f=An(d%g),d===l?(p=this._repeat,f=c):((p=~~(d/g))&&p===d/g&&(f=c,p--),f>c&&(f=c)),(y=this._yoyo&&1&p)&&(v=this._yEase,f=c-f),_=Pl(this._tTime,g),f===a&&!o&&this._initted)return this._tTime=d,this;p!==_&&(x&&this._yEase&&YA(x,y),this.vars.repeatRefresh&&!y&&!this._lock&&(this._lock=o=1,this.render(An(g*p),!0).invalidate()._lock=0))}if(!this._initted){if(PA(this,u?r:f,o,s,d))return this._tTime=0,this;if(a!==this._time)return this;if(c!==this._dur)return this.render(r,s,o)}if(this._tTime=d,this._time=f,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=m=(v||this._ease)(f/c),this._from&&(this.ratio=m=1-m),f&&!a&&!s&&!p&&(Vi(this,"onStart"),this._tTime!==d))return this;for(h=this._pt;h;)h.r(m,h.d),h=h._next;x&&x.render(r<0?r:!f&&y?-wt:x._dur*x._ease(f/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&F0(this,r,0,o),Vi(this,"onUpdate")),this._repeat&&p!==_&&this.vars.onRepeat&&!s&&this.parent&&Vi(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(u&&!this._onUpdate&&F0(this,r,0,!0),(r||!c)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&Us(this,1),!s&&(!u||a)&&(d||a||y)&&(Vi(this,d===l?"onComplete":"onReverseComplete",!0),this._prom&&!(d<l&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,i,r){var c,u,d,s=e.ratio,o=t<0||!t&&(!e._start&&bj(e)&&(e._initted||!O0(e))||(e._ts<0||e._dp._ts<0)&&!O0(e))?0:1,a=e._rDelay,l=0;if(a&&e._repeat&&(l=Pu(0,e._tDur,t),u=Pl(l,a),e._yoyo&&1&u&&(o=1-o),u!==Pl(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||Bn||r||e._zTime===wt||!t&&e._zTime){if(!e._initted&&PA(e,t,r,i,l))return;for(d=e._zTime,e._zTime=t||(i?wt:0),i||(i=t&&!d),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,c=e._pt;c;)c.r(o,c.d),c=c._next;t<0&&F0(e,t,0,!0),e._onUpdate&&!i&&Vi(e,"onUpdate"),l&&e._repeat&&!i&&e.parent&&Vi(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&Us(e,1),!i&&!Bn&&(Vi(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,r,s,o);return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,a){Ou||Di.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||j0(this,l),function(e,t,i,r,s,o,a){var c,u,d,f,l=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!l)for(l=e._ptCache[t]=[],d=e._ptLookup,f=e._targets.length;f--;){if((c=d[f][t])&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==t&&c.fp!==t;)c=c._next;if(!c)return W0=1,e.vars[t]="+=0",j0(e,a),W0=0,1;l.push(c)}for(f=l.length;f--;)(c=(u=l[f])._pt||u).s=!r&&0!==r||s?c.s+(r||0)+o*c.c:r,c.c=i-c.s,u.e&&(u.e=Jt(i)+Un(u.e)),u.b&&(u.b=c.s+Un(u.b))}(this,r,s,o,a,this._ease(l/this._dur),l)?this.resetTo(r,s,o,a):(pp(this,0),this.parent||CA(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(void 0===s&&(s="all"),!(r||s&&"all"!==s))return this._lazy=this._pt=0,this.parent?Nu(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,Gs&&!0!==Gs.vars.overwrite)._first||Nu(this),this.parent&&o!==this.timeline.totalDuration()&&Ll(this,this._dur*this.timeline._tDur/o,0,1),this}var d,f,h,p,g,_,y,a=this._targets,l=r?Ui(r):a,c=this._ptLookup,u=this._pt;if((!s||"all"===s)&&function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0}(a,l))return"all"===s&&(this._pt=0),Nu(this);for(d=this._op=this._op||[],"all"!==s&&(Mn(s)&&(g={},ci(s,function(m){return g[m]=1}),s=g),s=function(e,t){var s,o,a,l,i=e[0]?zo(e[0]).harness:0,r=i&&i.aliases;if(!r)return t;for(o in s=Go({},t),r)if(o in s)for(a=(l=r[o].split(",")).length;a--;)s[l[a]]=s[o];return s}(a,s)),y=a.length;y--;)if(~l.indexOf(a[y]))for(g in f=c[y],"all"===s?(d[y]=s,p=f,h={}):(h=d[y]=d[y]||{},p=s),p)(_=f&&f[g])&&((!("kill"in _.d)||!0===_.d.kill(g))&&dp(this,_,"_pt"),delete f[g]),"all"!==h&&(h[g]=1);return this._initted&&!this._pt&&u&&Nu(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return Ru(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return Ru(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return Ut.killTweensOf(r,s,o)},e}(ku);Bi(cn.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),ci("staggerTo,staggerFrom,staggerFromTo",function(n){cn[n]=function(){var e=new Zn,t=k0.call(arguments,0);return t.splice("staggerFromTo"===n?5:4,0,0),e[n].apply(e,t)}});var $0=function(e,t,i){return e[t]=i},tI=function(e,t,i){return e[t](i)},jj=function(e,t,i,r){return e[t](r.fp,i)},$j=function(e,t,i){return e.setAttribute(t,i)},q0=function(e,t){return $t(e[t])?tI:M0(e[t])&&e.setAttribute?$j:$0},nI=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},qj=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},iI=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round(1e4*(i.s+i.c*e))/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},X0=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},Xj=function(e,t,i,r){for(var o,s=this._pt;s;)o=s._next,s.p===r&&s.modifier(e,t,i),s=o},Yj=function(e){for(var i,r,t=this._pt;t;)r=t._next,t.p===e&&!t.op||t.op===e?dp(this,t,"_pt"):t.dep||(i=1),t=r;return!i},Zj=function(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)},rI=function(e){for(var i,r,s,o,t=e._pt;t;){for(i=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=i}e._pt=s},ui=function(){function n(t,i,r,s,o,a,l,c,u){this.t=i,this.s=s,this.c=o,this.p=r,this.r=a||nI,this.d=l||this,this.set=c||$0,this.pr=u||0,this._next=t,t&&(t._prev=this)}return n.prototype.modifier=function(i,r,s){this.mSet=this.mSet||this.set,this.set=Zj,this.m=i,this.mt=s,this.tween=r},n}();ci(L0+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return I0[n]=1}),Ei.TweenMax=Ei.TweenLite=cn,Ei.TimelineLite=Ei.TimelineMax=Zn,Ut=new Zn({sortChildren:!1,defaults:Al,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Si.stringFilter=qA;var qo=[],mp={},Kj=[],sI=0,Jj=0,Y0=function(e){return(mp[e]||Kj).map(function(t){return t()})},Z0=function(){var e=Date.now(),t=[];e-sI>2&&(Y0("matchMediaInit"),qo.forEach(function(i){var o,a,l,c,r=i.queries,s=i.conditions;for(a in r)(o=ki.matchMedia(r[a]).matches)&&(l=1),o!==s[a]&&(s[a]=o,c=1);c&&(i.revert(),l&&t.push(i))}),Y0("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i)}),sI=e,Y0("matchMedia"))},oI=function(){function n(t,i){this.selector=i&&B0(i),this.data=[],this._r=[],this.isReverted=!1,this.id=Jj++,t&&this.add(t)}var e=n.prototype;return e.add=function(i,r,s){$t(i)&&(s=r,r=i,i=$t);var o=this,a=function(){var d,c=jt,u=o.selector;return c&&c!==o&&c.data.push(o),s&&(o.selector=B0(s)),jt=o,d=r.apply(o,arguments),$t(d)&&o._r.push(d),jt=c,o.selector=u,o.isReverted=!1,d};return o.last=a,i===$t?a(o):i?o[i]=a:a},e.ignore=function(i){var r=jt;jt=null,i(this),jt=r},e.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof n?i.push.apply(i,r.getTweens()):r instanceof cn&&!(r.parent&&"nested"===r.parent.data)&&i.push(r)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,r){var s=this;if(i){var o=this.getTweens();this.data.forEach(function(l){"isFlip"===l.data&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(c){return o.splice(o.indexOf(c),1)}))}),o.map(function(l){return{g:l.globalTime(0),t:l}}).sort(function(l,c){return c.g-l.g||-1}).forEach(function(l){return l.t.revert(i)}),this.data.forEach(function(l){return l instanceof Zn?"nested"!==l.data&&l.kill():!(l instanceof cn)&&l.revert&&l.revert(i)}),this._r.forEach(function(l){return l(i,s)}),this.isReverted=!0}else this.data.forEach(function(l){return l.kill&&l.kill()});if(this.clear(),r)for(var a=qo.length;a--;)qo[a].id===this.id&&qo.splice(a,1)},e.revert=function(i){this.kill(i||{})},n}(),Qj=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(i,r,s){br(i)||(i={matches:i});var l,c,u,o=new oI(0,s||this.scope),a=o.conditions={};for(c in jt&&!o.selector&&(o.selector=jt.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=i,i)"all"===c?u=1:(l=ki.matchMedia(i[c]))&&(qo.indexOf(o)<0&&qo.push(o),(a[c]=l.matches)&&(u=1),l.addListener?l.addListener(Z0):l.addEventListener("change",Z0));return u&&r(o),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},n}(),gp={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(r){return GA(r)})},timeline:function(e){return new Zn(e)},getTweensOf:function(e,t){return Ut.getTweensOf(e,t)},getProperty:function(e,t,i,r){Mn(e)&&(e=Ui(e)[0]);var s=zo(e||{}).get,o=i?TA:EA;return"native"===i&&(i=""),e&&(t?o((Ti[t]&&Ti[t].get||s)(e,t,i,r)):function(a,l,c){return o((Ti[a]&&Ti[a].get||s)(e,a,l,c))})},quickSetter:function(e,t,i){if((e=Ui(e)).length>1){var r=e.map(function(u){return di.quickSetter(u,t,i)}),s=r.length;return function(u){for(var d=s;d--;)r[d](u)}}var o=Ti[t],a=zo(e=e[0]||{}),l=a.harness&&(a.harness.aliases||{})[t]||t,c=o?function(u){var d=new o;Nl._pt=0,d.init(e,i?u+i:u,Nl,0,[e]),d.render(1,d),Nl._pt&&X0(1,Nl)}:a.set(e,l);return o?c:function(u){return c(e,l,i?u+i:u,a,1)}},quickTo:function(e,t,i){var r,s=di.to(e,Go(((r={})[t]="+=0.1",r.paused=!0,r),i||{})),o=function(l,c,u){return s.resetTo(t,l,c,u)};return o.tween=s,o},isTweening:function(e){return Ut.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=jo(e.ease,Al.ease)),DA(Al,e||{})},config:function(e){return DA(Si,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,s=e.defaults,o=e.extendTimeline;(e.plugins||"").split(",").forEach(function(a){return a&&!Ti[a]&&!Ei[a]&&op(t+" effect requires "+a+" plugin.")}),P0[t]=function(a,l,c){return i(Ui(a),Bi(l||{},s),c)},o&&(Zn.prototype[t]=function(a,l,c){return this.add(P0[t](a,br(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){tt[e]=jo(t)},parseEase:function(e,t){return arguments.length?jo(e,t):tt},getById:function(e){return Ut.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,s,i=new Zn(e);for(i.smoothChildTiming=li(e.smoothChildTiming),Ut.remove(i),i._dp=0,i._time=i._tTime=Ut._time,r=Ut._first;r;)s=r._next,(t||!(!r._dur&&r instanceof cn&&r.vars.onComplete===r._targets[0]))&&Mr(i,r,r._start-r._delay),r=s;return Mr(Ut,i,0),i},context:function(e,t){return e?new oI(e,t):jt},matchMedia:function(e){return new Qj(e)},matchMediaRefresh:function(){return qo.forEach(function(e){var i,r,t=e.conditions;for(r in t)t[r]&&(t[r]=!1,i=1);i&&e.revert()})||Z0()},addEventListener:function(e,t){var i=mp[e]||(mp[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=mp[e],r=i&&i.indexOf(t);r>=0&&i.splice(r,1)},utils:{wrap:function n(e,t,i){var r=t-e;return Hn(e)?HA(e,n(0,e.length),t):Vs(i,function(s){return(r+(s-e)%r)%r+e})},wrapYoyo:function n(e,t,i){var r=t-e,s=2*r;return Hn(e)?HA(e,n(0,e.length-1),t):Vs(i,function(o){return e+((o=(s+(o-e)%s)%s||0)>r?s-o:o)})},distribute:OA,random:BA,snap:kA,normalize:function(e,t,i){return UA(e,t,0,1,i)},getUnit:Un,clamp:function(e,t,i){return Vs(i,function(r){return Pu(e,t,r)})},splitColor:WA,toArray:Ui,selector:B0,mapRange:UA,pipe:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduce(function(s,o){return o(s)},r)}},unitize:function(e,t){return function(i){return e(parseFloat(i))+(t||Un(i))}},interpolate:function n(e,t,i,r){var s=isNaN(e+t)?0:function(h){return(1-h)*e+h*t};if(!s){var l,c,u,d,f,o=Mn(e),a={};if(!0===i&&(r=1)&&(i=null),o)e={p:e},t={p:t};else if(Hn(e)&&!Hn(t)){for(u=[],f=(d=e.length)-2,c=1;c<d;c++)u.push(n(e[c-1],e[c]));d--,s=function(p){p*=d;var g=Math.min(f,~~p);return u[g](p-g)},i=t}else r||(e=Go(Hn(e)?[]:{},e));if(!u){for(l in t)G0.call(a,e,l,"get",t[l]);s=function(p){return X0(p,a)||(o?e.p:e)}}}return Vs(i,s)},shuffle:FA},install:vA,effects:P0,ticker:Di,updateRoot:Zn.updateRoot,plugins:Ti,globalTimeline:Ut,core:{PropTween:ui,globals:xA,Tween:cn,Timeline:Zn,Animation:ku,getCache:zo,_removeLinkedListItem:dp,reverting:function(){return Bn},context:function(e){return e&&jt&&(jt.data.push(e),e._ctx=jt),jt},suppressOverwrites:function(e){return w0=e}}};ci("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return gp[n]=cn[n]}),Di.add(Zn.updateRoot),Nl=gp.to({},{duration:0});var e$=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},K0=function(e,t){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var l,c;if(Mn(s)&&(l={},ci(s,function(u){return l[u]=1}),s=l),t){for(c in l={},s)l[c]=t(s[c]);s=l}!function(e,t){var r,s,o,i=e._targets;for(r in t)for(s=i.length;s--;)(o=e._ptLookup[s][r])&&(o=o.d)&&(o._pt&&(o=e$(o,r)),o&&o.modifier&&o.modifier(t[r],e,i[s],r))}(a,s)}}}},di=gp.registerPlugin({name:"attr",init:function(e,t,i,r,s){var o,a,l;for(o in this.tween=i,t)l=e.getAttribute(o)||"",(a=this.add(e,"setAttribute",(l||0)+"",t[o],r,s,0,0,o)).op=o,a.b=l,this._props.push(o)},render:function(e,t){for(var i=t._pt;i;)Bn?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},K0("roundProps",H0),K0("modifiers"),K0("snap",kA))||gp;cn.version=Zn.version=di.version="3.12.1",_A=1,S0()&&Fl();var aI,Ws,Ol,J0,Xo,lI,Q0,pI,rs={},Yo=180/Math.PI,kl=Math.PI/180,Bl=Math.atan2,cI=1e8,ev=/([A-Z])/g,r$=/(left|right|width|margin|padding|x)/i,s$=/[\s,\(]\S/,Sr={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},tv=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},o$=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},a$=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},l$=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},uI=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},dI=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},c$=function(e,t,i){return e.style[t]=i},u$=function(e,t,i){return e.style.setProperty(t,i)},d$=function(e,t,i){return e._gsap[t]=i},f$=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},h$=function(e,t,i,r,s){var o=e._gsap;o.scaleX=o.scaleY=i,o.renderTransform(s,o)},p$=function(e,t,i,r,s){var o=e._gsap;o[t]=i,o.renderTransform(s,o)},Vt="transform",tr=Vt+"Origin",m$=function n(e,t){var i=this,r=this.target,s=r.style;if(e in rs&&s){if(this.tfm=this.tfm||{},"transform"===e)return Sr.transform.split(",").forEach(function(o){return n.call(i,o,t)});if(~(e=Sr[e]||e).indexOf(",")?e.split(",").forEach(function(o){return i.tfm[o]=ss(r,o)}):this.tfm[e]=r._gsap.x?r._gsap[e]:ss(r,e),this.props.indexOf(Vt)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(tr,t,"")),e=Vt}(s||t)&&this.props.push(e,t,s[e])},fI=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},g$=function(){var s,o,e=this.props,t=this.target,i=t.style,r=t._gsap;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty("--"===e[s].substr(0,2)?e[s]:e[s].replace(ev,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),(!(s=Q0())||!s.isStart)&&!i[Vt]&&(fI(i),r.uncache=1)}},hI=function(e,t){var i={target:e,props:[],revert:g$,save:m$};return e._gsap||di.core.getCache(e),t&&t.split(",").forEach(function(r){return i.save(r)}),i},nv=function(e,t){var i=Ws.createElementNS?Ws.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Ws.createElement(e);return i.style?i:Ws.createElement(e)},Er=function n(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(ev,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&n(e,Hl(t)||t,1)||""},mI="O,Moz,ms,Ms,Webkit".split(","),Hl=function(e,t,i){var s=(t||Xo).style,o=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(mI[o]+e in s););return o<0?null:(3===o?"ms":o>=0?mI[o]:"")+e},iv=function(){typeof window<"u"&&window.document&&(aI=window,Ol=(Ws=aI.document).documentElement,Xo=nv("div")||{style:{}},nv("div"),Vt=Hl(Vt),tr=Vt+"Origin",Xo.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",pI=!!Hl("perspective"),Q0=di.core.reverting,J0=1)},rv=function n(e){var o,t=nv("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,s=this.style.cssText;if(Ol.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),Ol.removeChild(t),this.style.cssText=s,o},gI=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},yI=function(e){var t;try{t=e.getBBox()}catch{t=rv.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===rv||(t=rv.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+gI(e,["x","cx","x1"])||0,y:+gI(e,["y","cy","y1"])||0,width:0,height:0}},_I=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!yI(e))},Hu=function(e,t){if(t){var i=e.style;t in rs&&t!==tr&&(t=Vt),i.removeProperty?(("ms"===t.substr(0,2)||"webkit"===t.substr(0,6))&&(t="-"+t),i.removeProperty(t.replace(ev,"-$1").toLowerCase())):i.removeAttribute(t)}},js=function(e,t,i,r,s,o){var a=new ui(e._pt,t,i,0,1,o?dI:uI);return e._pt=a,a.b=r,a.e=s,e._props.push(i),a},vI={deg:1,rad:1,turn:1},y$={grid:1,flex:1},$s=function n(e,t,i,r){var p,g,_,y,s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",a=Xo.style,l=r$.test(t),c="svg"===e.tagName.toLowerCase(),u=(c?"client":"offset")+(l?"Width":"Height"),d=100,f="px"===r,h="%"===r;return r===o||!s||vI[r]||vI[o]?s:("px"!==o&&!f&&(s=n(e,t,i,"px")),y=e.getCTM&&_I(e),!h&&"%"!==o||!rs[t]&&!~t.indexOf("adius")?(a[l?"width":"height"]=d+(f?o:r),g=~t.indexOf("adius")||"em"===r&&e.appendChild&&!c?e:e.parentNode,y&&(g=(e.ownerSVGElement||{}).parentNode),(!g||g===Ws||!g.appendChild)&&(g=Ws.body),(_=g._gsap)&&h&&_.width&&l&&_.time===Di.time&&!_.uncache?Jt(s/_.width*d):((h||"%"===o)&&!y$[Er(g,"display")]&&(a.position=Er(e,"position")),g===e&&(a.position="static"),g.appendChild(Xo),p=Xo[u],g.removeChild(Xo),a.position="absolute",l&&h&&((_=zo(g)).time=Di.time,_.width=g[u]),Jt(f?p*s/d:p&&s?d/p*s:0))):(p=y?e.getBBox()[l?"width":"height"]:e[u],Jt(h?s/p*d:s/100*p)))},ss=function(e,t,i,r){var s;return J0||iv(),t in Sr&&"transform"!==t&&~(t=Sr[t]).indexOf(",")&&(t=t.split(",")[0]),rs[t]&&"transform"!==t?(s=Vu(e,r),s="transformOrigin"!==t?s[t]:s.svg?s.origin:_p(Er(e,tr))+" "+s.zOrigin+"px"):(!(s=e.style[t])||"auto"===s||r||~(s+"").indexOf("calc("))&&(s=yp[t]&&yp[t](e,t,i)||Er(e,t)||MA(e,t)||("opacity"===t?1:0)),i&&!~(s+"").trim().indexOf(" ")?$s(e,t,s,i)+i:s},_$=function(e,t,i,r){if(!i||"none"===i){var s=Hl(t,e,1),o=s&&Er(e,s,1);o&&o!==i?(t=s,i=o):"borderColor"===t&&(i=Er(e,"borderTopColor"))}var u,d,f,h,p,g,_,y,m,x,v,a=new ui(this._pt,e.style,t,0,1,iI),l=0,c=0;if(a.b=i,a.e=r,i+="","auto"==(r+="")&&(e.style[t]=r,r=Er(e,t)||r,e.style[t]=i),qA(u=[i,r]),r=u[1],f=(i=u[0]).match(Il)||[],(r.match(Il)||[]).length){for(;d=Il.exec(r);)_=d[0],m=r.substring(l,d.index),p?p=(p+1)%5:("rgba("===m.substr(-5)||"hsla("===m.substr(-5))&&(p=1),_!==(g=f[c++]||"")&&(h=parseFloat(g)||0,v=g.substr((h+"").length),"="===_.charAt(1)&&(_=Rl(h,_)+v),y=parseFloat(_),x=_.substr((y+"").length),l=Il.lastIndex-x.length,x||(x=x||Si.units[t]||v,l===r.length&&(r+=x,a.e+=x)),v!==x&&(h=$s(e,t,g,x)||0),a._pt={_next:a._pt,p:m||1===c?m:",",s:h,c:y-h,m:p&&p<4||"zIndex"===t?Math.round:0});a.c=l<r.length?r.substring(l,r.length):""}else a.r="display"===t&&"none"===r?dI:uI;return gA.test(r)&&(a.e=0),this._pt=a,a},xI={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},v$=function(e){var t=e.split(" "),i=t[0],r=t[1]||"50%";return("top"===i||"bottom"===i||"left"===r||"right"===r)&&(e=i,i=r,r=e),t[0]=xI[i]||i,t[1]=xI[r]||r,t.join(" ")},x$=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var a,l,c,i=t.t,r=i.style,s=t.u,o=i._gsap;if("all"===s||!0===s)r.cssText="",l=1;else for(c=(s=s.split(",")).length;--c>-1;)rs[a=s[c]]&&(l=1,a="transformOrigin"===a?tr:Vt),Hu(i,a);l&&(Hu(i,Vt),o&&(o.svg&&i.removeAttribute("transform"),Vu(i,1),o.uncache=1,fI(r)))}},yp={clearProps:function(e,t,i,r,s){if("isFromStart"!==s.data){var o=e._pt=new ui(e._pt,t,i,0,0,x$);return o.u=r,o.pr=-10,o.tween=s,e._props.push(i),1}}},Uu=[1,0,0,1,0,0],wI={},bI=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},MI=function(e){var t=Er(e,Vt);return bI(t)?Uu:t.substr(7).match(mA).map(Jt)},sv=function(e,t){var o,a,l,c,i=e._gsap||zo(e),r=e.style,s=MI(e);return i.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(s=[(l=e.transform.baseVal.consolidate().matrix).a,l.b,l.c,l.d,l.e,l.f]).join(",")?Uu:s:(s===Uu&&!e.offsetParent&&e!==Ol&&!i.svg&&(l=r.display,r.display="block",(!(o=e.parentNode)||!e.offsetParent)&&(c=1,a=e.nextElementSibling,Ol.appendChild(e)),s=MI(e),l?r.display=l:Hu(e,"display"),c&&(a?o.insertBefore(e,a):o?o.appendChild(e):Ol.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},ov=function(e,t,i,r,s,o){var M,T,R,a=e._gsap,l=s||sv(e,!0),c=a.xOrigin||0,u=a.yOrigin||0,d=a.xOffset||0,f=a.yOffset||0,h=l[0],p=l[1],g=l[2],_=l[3],y=l[4],m=l[5],x=t.split(" "),v=parseFloat(x[0])||0,w=parseFloat(x[1])||0;i?l!==Uu&&(T=h*_-p*g)&&(R=v*(-p/T)+w*(h/T)-(h*m-p*y)/T,v=v*(_/T)+w*(-g/T)+(g*m-_*y)/T,w=R):(v=(M=yI(e)).x+(~x[0].indexOf("%")?v/100*M.width:v),w=M.y+(~(x[1]||x[0]).indexOf("%")?w/100*M.height:w)),r||!1!==r&&a.smooth?(a.xOffset=d+((y=v-c)*h+(m=w-u)*g)-y,a.yOffset=f+(y*p+m*_)-m):a.xOffset=a.yOffset=0,a.xOrigin=v,a.yOrigin=w,a.smooth=!!r,a.origin=t,a.originIsAbsolute=!!i,e.style[tr]="0px 0px",o&&(js(o,a,"xOrigin",c,v),js(o,a,"yOrigin",u,w),js(o,a,"xOffset",d,a.xOffset),js(o,a,"yOffset",f,a.yOffset)),e.setAttribute("data-svg-origin",v+" "+w)},Vu=function(e,t){var i=e._gsap||new KA(e);if("x"in i&&!t&&!i.uncache)return i;var u,d,f,h,p,g,_,y,m,x,v,w,M,T,C,R,P,b,I,L,F,O,B,U,k,j,J,Q,ee,be,He,we,r=e.style,s=i.scaleX<0,o="px",a="deg",l=getComputedStyle(e),c=Er(e,tr)||"0";return u=d=f=g=_=y=m=x=v=0,h=p=1,i.svg=!(!e.getCTM||!_I(e)),l.translate&&(("none"!==l.translate||"none"!==l.scale||"none"!==l.rotate)&&(r[Vt]=("none"!==l.translate?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==l.rotate?"rotate("+l.rotate+") ":"")+("none"!==l.scale?"scale("+l.scale.split(" ").join(",")+") ":"")+("none"!==l[Vt]?l[Vt]:"")),r.scale=r.rotate=r.translate="none"),T=sv(e,i.svg),i.svg&&(i.uncache?(k=e.getBBox(),c=i.xOrigin-k.x+"px "+(i.yOrigin-k.y)+"px",U=""):U=!t&&e.getAttribute("data-svg-origin"),ov(e,U||c,!!U||i.originIsAbsolute,!1!==i.smooth,T)),w=i.xOrigin||0,M=i.yOrigin||0,T!==Uu&&(b=T[0],I=T[1],L=T[2],F=T[3],u=O=T[4],d=B=T[5],6===T.length?(h=Math.sqrt(b*b+I*I),p=Math.sqrt(F*F+L*L),g=b||I?Bl(I,b)*Yo:0,(m=L||F?Bl(L,F)*Yo+g:0)&&(p*=Math.abs(Math.cos(m*kl))),i.svg&&(u-=w-(w*b+M*L),d-=M-(w*I+M*F))):(be=T[7],J=T[8],Q=T[9],He=T[11],u=T[12],d=T[13],f=T[14],_=(C=Bl(we=T[6],ee=T[10]))*Yo,C&&(U=O*(R=Math.cos(-C))+J*(P=Math.sin(-C)),k=B*R+Q*P,j=we*R+ee*P,J=O*-P+J*R,Q=B*-P+Q*R,ee=we*-P+ee*R,He=be*-P+He*R,O=U,B=k,we=j),y=(C=Bl(-L,ee))*Yo,C&&(R=Math.cos(-C),He=F*(P=Math.sin(-C))+He*R,b=U=b*R-J*P,I=k=I*R-Q*P,L=j=L*R-ee*P),g=(C=Bl(I,b))*Yo,C&&(U=b*(R=Math.cos(C))+I*(P=Math.sin(C)),k=O*R+B*P,I=I*R-b*P,B=B*R-O*P,b=U,O=k),_&&Math.abs(_)+Math.abs(g)>359.9&&(_=g=0,y=180-y),h=Jt(Math.sqrt(b*b+I*I+L*L)),p=Jt(Math.sqrt(B*B+we*we)),C=Bl(O,B),m=Math.abs(C)>2e-4?C*Yo:0,v=He?1/(He<0?-He:He):0),i.svg&&(U=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!bI(Er(e,Vt)),U&&e.setAttribute("transform",U))),Math.abs(m)>90&&Math.abs(m)<270&&(s?(h*=-1,m+=g<=0?180:-180,g+=g<=0?180:-180):(p*=-1,m+=m<=0?180:-180)),t=t||i.uncache,i.x=u-((i.xPercent=u&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+o,i.y=d-((i.yPercent=d&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-d)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+o,i.z=f+o,i.scaleX=Jt(h),i.scaleY=Jt(p),i.rotation=Jt(g)+a,i.rotationX=Jt(_)+a,i.rotationY=Jt(y)+a,i.skewX=m+a,i.skewY=x+a,i.transformPerspective=v+o,(i.zOrigin=parseFloat(c.split(" ")[2])||0)&&(r[tr]=_p(c)),i.xOffset=i.yOffset=0,i.force3D=Si.force3D,i.renderTransform=i.svg?b$:pI?SI:w$,i.uncache=0,i},_p=function(e){return(e=e.split(" "))[0]+" "+e[1]},av=function(e,t,i){var r=Un(t);return Jt(parseFloat(t)+parseFloat($s(e,"x",i+"px",r)))+r},w$=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,SI(e,t)},Zo="0deg",zu="0px",Ko=") ",SI=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,l=i.z,c=i.rotation,u=i.rotationY,d=i.rotationX,f=i.skewX,h=i.skewY,p=i.scaleX,g=i.scaleY,_=i.transformPerspective,y=i.force3D,m=i.target,x=i.zOrigin,v="",w="auto"===y&&e&&1!==e||!0===y;if(x&&(d!==Zo||u!==Zo)){var R,M=parseFloat(u)*kl,T=Math.sin(M),C=Math.cos(M);M=parseFloat(d)*kl,R=Math.cos(M),o=av(m,o,T*R*-x),a=av(m,a,-Math.sin(M)*-x),l=av(m,l,C*R*-x+x)}_!==zu&&(v+="perspective("+_+Ko),(r||s)&&(v+="translate("+r+"%, "+s+"%) "),(w||o!==zu||a!==zu||l!==zu)&&(v+=l!==zu||w?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+Ko),c!==Zo&&(v+="rotate("+c+Ko),u!==Zo&&(v+="rotateY("+u+Ko),d!==Zo&&(v+="rotateX("+d+Ko),(f!==Zo||h!==Zo)&&(v+="skew("+f+", "+h+Ko),(1!==p||1!==g)&&(v+="scale("+p+", "+g+Ko),m.style[Vt]=v||"translate(0, 0)"},b$=function(e,t){var w,M,T,C,R,i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,l=i.rotation,c=i.skewX,u=i.skewY,d=i.scaleX,f=i.scaleY,h=i.target,p=i.xOrigin,g=i.yOrigin,_=i.xOffset,y=i.yOffset,m=i.forceCSS,x=parseFloat(o),v=parseFloat(a);l=parseFloat(l),c=parseFloat(c),(u=parseFloat(u))&&(c+=u=parseFloat(u),l+=u),l||c?(l*=kl,c*=kl,w=Math.cos(l)*d,M=Math.sin(l)*d,T=Math.sin(l-c)*-f,C=Math.cos(l-c)*f,c&&(u*=kl,R=Math.tan(c-u),T*=R=Math.sqrt(1+R*R),C*=R,u&&(R=Math.tan(u),w*=R=Math.sqrt(1+R*R),M*=R)),w=Jt(w),M=Jt(M),T=Jt(T),C=Jt(C)):(w=d,C=f,M=T=0),(x&&!~(o+"").indexOf("px")||v&&!~(a+"").indexOf("px"))&&(x=$s(h,"x",o,"px"),v=$s(h,"y",a,"px")),(p||g||_||y)&&(x=Jt(x+p-(p*w+g*T)+_),v=Jt(v+g-(p*M+g*C)+y)),(r||s)&&(R=h.getBBox(),x=Jt(x+r/100*R.width),v=Jt(v+s/100*R.height)),h.setAttribute("transform",R="matrix("+w+","+M+","+T+","+C+","+x+","+v+")"),m&&(h.style[Vt]=R)},M$=function(e,t,i,r,s){var d,f,o=360,a=Mn(s),c=parseFloat(s)*(a&&~s.indexOf("rad")?Yo:1)-r,u=r+c+"deg";return a&&("short"===(d=s.split("_")[1])&&(c%=o)!=c%180&&(c+=c<0?o:-o),"cw"===d&&c<0?c=(c+o*cI)%o-~~(c/o)*o:"ccw"===d&&c>0&&(c=(c-o*cI)%o-~~(c/o)*o)),e._pt=f=new ui(e._pt,t,i,r,c,o$),f.e=u,f.u="deg",e._props.push(i),f},EI=function(e,t){for(var i in t)e[i]=t[i];return e},S$=function(e,t,i){var a,l,c,u,d,f,p,r=EI({},i._gsap),o=i.style;for(l in r.svg?(c=i.getAttribute("transform"),i.setAttribute("transform",""),o[Vt]=t,a=Vu(i,1),Hu(i,Vt),i.setAttribute("transform",c)):(c=getComputedStyle(i)[Vt],o[Vt]=t,a=Vu(i,1),o[Vt]=c),rs)(c=r[l])!==(u=a[l])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(l)<0&&(d=Un(c)!==(p=Un(u))?$s(i,l,c,p):parseFloat(c),f=parseFloat(u),e._pt=new ui(e._pt,a,l,d,f-d,tv),e._pt.u=p||0,e._props.push(l));EI(a,r)};ci("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",r="Bottom",s="Left",o=(e<3?[t,i,r,s]:[t+s,t+i,r+i,r+s]).map(function(a){return e<2?n+a:"border"+a+n});yp[e>1?"border"+n:n]=function(a,l,c,u,d){var f,h;if(arguments.length<4)return f=o.map(function(p){return ss(a,p,c)}),5===(h=f.join(" ")).split(f[0]).length?f[0]:h;f=(u+"").split(" "),h={},o.forEach(function(p,g){return h[p]=f[g]=f[g]||f[(g-1)/2|0]}),a.init(l,h,d)}});var TI={name:"css",register:iv,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,s){var c,u,d,f,h,p,g,_,y,m,x,v,w,M,T,C,o=this._props,a=e.style,l=i.vars.startAt;for(g in J0||iv(),this.styles=this.styles||hI(e),C=this.styles.props,this.tween=i,t)if("autoRound"!==g&&(u=t[g],!Ti[g]||!JA(g,t,i,r,e,s)))if(p=yp[g],"function"==(h=typeof u)&&(h=typeof(u=u.call(i,r,e,s))),"string"===h&&~u.indexOf("random(")&&(u=Lu(u)),p)p(this,e,g,u,i)&&(T=1);else if("--"===g.substr(0,2))c=(getComputedStyle(e).getPropertyValue(g)+"").trim(),u+="",zs.lastIndex=0,zs.test(c)||(_=Un(c),y=Un(u)),y?_!==y&&(c=$s(e,g,c,y)+y):_&&(u+=_),this.add(a,"setProperty",c,u,r,s,0,0,g),o.push(g),C.push(g,0,a[g]);else if("undefined"!==h){if(l&&g in l?(c="function"==typeof l[g]?l[g].call(i,r,e,s):l[g],Mn(c)&&~c.indexOf("random(")&&(c=Lu(c)),Un(c+"")||(c+=Si.units[g]||Un(ss(e,g))||""),"="===(c+"").charAt(1)&&(c=ss(e,g))):c=ss(e,g),f=parseFloat(c),(m="string"===h&&"="===u.charAt(1)&&u.substr(0,2))&&(u=u.substr(2)),d=parseFloat(u),g in Sr&&("autoAlpha"===g&&(1===f&&"hidden"===ss(e,"visibility")&&d&&(f=0),C.push("visibility",0,a.visibility),js(this,a,"visibility",f?"inherit":"hidden",d?"inherit":"hidden",!d)),"scale"!==g&&"transform"!==g&&~(g=Sr[g]).indexOf(",")&&(g=g.split(",")[0])),x=g in rs)if(this.styles.save(g),v||((w=e._gsap).renderTransform&&!t.parseTransform||Vu(e,t.parseTransform),M=!1!==t.smoothOrigin&&w.smooth,(v=this._pt=new ui(this._pt,a,Vt,0,1,w.renderTransform,w,0,-1)).dep=1),"scale"===g)this._pt=new ui(this._pt,w,"scaleY",w.scaleY,(m?Rl(w.scaleY,m+d):d)-w.scaleY||0,tv),this._pt.u=0,o.push("scaleY",g),g+="X";else{if("transformOrigin"===g){C.push(tr,0,a[tr]),u=v$(u),w.svg?ov(e,u,0,M,0,this):((y=parseFloat(u.split(" ")[2])||0)!==w.zOrigin&&js(this,w,"zOrigin",w.zOrigin,y),js(this,a,g,_p(c),_p(u)));continue}if("svgOrigin"===g){ov(e,u,1,M,0,this);continue}if(g in wI){M$(this,w,g,f,m?Rl(f,m+u):u);continue}if("smoothOrigin"===g){js(this,w,"smooth",w.smooth,u);continue}if("force3D"===g){w[g]=u;continue}if("transform"===g){S$(this,u,e);continue}}else g in a||(g=Hl(g)||g);if(x||(d||0===d)&&(f||0===f)&&!s$.test(u)&&g in a)d||(d=0),(_=(c+"").substr((f+"").length))!==(y=Un(u)||(g in Si.units?Si.units[g]:_))&&(f=$s(e,g,c,y)),this._pt=new ui(this._pt,x?w:a,g,f,(m?Rl(f,m+d):d)-f,x||"px"!==y&&"zIndex"!==g||!1===t.autoRound?tv:l$),this._pt.u=y||0,_!==y&&"%"!==y&&(this._pt.b=c,this._pt.r=a$);else if(g in a)_$.call(this,e,g,c,m?m+u:u);else if(g in e)this.add(e,g,c||e[g],m?m+u:u,r,s);else if("parseTransform"!==g){A0(g,u);continue}x||(g in a?C.push(g,0,a[g]):C.push(g,1,c||e[g])),o.push(g)}T&&rI(this)},render:function(e,t){if(t.tween._time||!Q0())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:ss,aliases:Sr,getSetter:function(e,t,i){var r=Sr[t];return r&&r.indexOf(",")<0&&(t=r),t in rs&&t!==tr&&(e._gsap.x||ss(e,"x"))?i&&lI===i?"scale"===t?f$:d$:(lI=i||{})&&("scale"===t?h$:p$):e.style&&!M0(e.style[t])?c$:~t.indexOf("-")?u$:q0(e,t)},core:{_removeProperty:Hu,_getMatrix:sv}};di.utils.checkPrefix=Hl,di.core.getStyleSaver=hI,function(n,e,t,i){var r=ci(n+","+e+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(s){rs[s]=1});ci(e,function(s){Si.units[s]="deg",wI[s]=1}),Sr[r[13]]=n+","+e,ci("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(s){var o=s.split(":");Sr[o[1]]=r[o[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),ci("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Si.units[n]="px"}),di.registerPlugin(TI);var lv=di.registerPlugin(TI)||di;let E$=(()=>{class n{ngAfterViewInit(){lv.fromTo(".loading-page",{opacity:1},{opacity:0,display:"none",duration:3,delay:3}),lv.fromTo(".logo-name",{opacity:0},{opacity:1,duration:2,delay:2})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ta({type:n,selectors:[["app-loading"]],decls:4,vars:0,consts:[[1,"loading-page"],[1,"name-container"],[1,"logo-name"]],template:function(t,i){1&t&&(En(0,"div",0)(1,"div",1)(2,"div",2),Wn(3,"Bienvienid@"),nn()()())},styles:[".loading-page[_ngcontent-%COMP%]{position:absolute;top:0;left:0;background:linear-gradient(0deg,rgb(156,156,156) 0%,rgb(112,112,112) 50%,rgb(71,71,71) 80%);height:100%;width:100%;display:flex;flex-direction:column;gap:1.5rem;align-items:center;justify-content:center;z-index:999}.name-container[_ngcontent-%COMP%]{height:30px;overflow:hidden}.logo-name[_ngcontent-%COMP%]{color:#000;font-size:20px;letter-spacing:12px;text-transform:uppercase;margin-left:20px;font-weight:bolder}@keyframes _ngcontent-%COMP%_draw{0%{stroke-dashoffset:1048}to{stroke-dashoffset:0}}"]}),n})(),T$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ta({type:n,selectors:[["app-sobre-mi"]],decls:47,vars:0,consts:[[1,"container"],[1,"border","aparecer"]],template:function(t,i){1&t&&(En(0,"div",0)(1,"div",1)(2,"h2")(3,"span"),Wn(4,"\xa1Descubre el futuro con el nuevo InfinitiMobile!"),nn(),pn(5,"br")(6,"br"),En(7,"span"),Wn(8,"Sum\xe9rgete en la tecnolog\xeda de vanguardia con nuestro revolucionario InfinitiMobile, un smartphone que desaf\xeda los l\xedmites de lo posible. Dise\xf1ado para aquellos que buscan lo mejor de la vida, este elegante dispositivo fusiona una belleza sin igual con un rendimiento incomparable."),nn(),pn(9,"br")(10,"br"),En(11,"span"),Wn(12," Potencia inigualable: Experimenta un rendimiento extraordinario con el procesador Octa-Core ultrarr\xe1pido y 8 GB de RAM. \xa1Nunca m\xe1s te preocupar\xe1s por la lentitud! Ejecuta m\xfaltiples aplicaciones sin esfuerzo y disfruta de un rendimiento suave y fluido en cada tarea. "),nn(),pn(13,"br")(14,"br"),En(15,"span"),Wn(16," C\xe1mara profesional: Captura momentos inolvidables con la c\xe1mara trasera cu\xe1druple de 64 MP. Desde impresionantes paisajes hasta retratos detallados, cada foto ser\xe1 una obra maestra. La c\xe1mara frontal de 32 MP es perfecta para selfies con una claridad asombrosa. Adem\xe1s, las capacidades de grabaci\xf3n en 4K aseguran que puedas capturar cada detalle con precisi\xf3n cinematogr\xe1fica. "),nn(),pn(17,"br")(18,"br"),En(19,"span"),Wn(20," Almacenamiento infinito: Con 256 GB de almacenamiento interno, tendr\xe1s espacio de sobra para tus fotos, videos, aplicaciones y m\xe1s. Libera tu creatividad y guarda todo lo que amas sin preocuparte por quedarte sin espacio. "),nn(),pn(21,"br")(22,"br"),En(23,"span"),Wn(24," Duraci\xf3n de la bater\xeda excepcional: La potente bater\xeda de 5000 mAh te mantendr\xe1 conectado durante todo el d\xeda. Olv\xeddate de los cargadores y disfruta de tu InfinitiMobile sin l\xedmites. "),nn(),pn(25,"br")(26,"br"),En(27,"span"),Wn(28," Conexi\xf3n sin fronteras: Navega por la web y descarga contenido a velocidades asombrosas con la tecnolog\xeda 5G integrada. La conectividad Wi-Fi 6 garantiza una conexi\xf3n estable incluso en entornos congestionados. "),nn(),pn(29,"br")(30,"br"),En(31,"span"),Wn(32," Seguridad de vanguardia: Protege tus datos y privacidad con el avanzado esc\xe1ner de huellas dactilares y el reconocimiento facial. Tu seguridad es nuestra prioridad n\xfamero uno. "),nn(),pn(33,"br")(34,"br"),En(35,"span"),Wn(36," \xbfListo para ser parte del futuro? El InfinitiMobile te espera con infinitas posibilidades. No esperes m\xe1s y s\xe9 el primero en experimentar la pr\xf3xima generaci\xf3n de la tecnolog\xeda m\xf3vil. "),nn(),pn(37,"br")(38,"br"),En(39,"span"),Wn(40," \xa1Adquiere tu InfinitiMobile ahora y descubre una nueva era de emociones tecnol\xf3gicas! "),nn(),pn(41,"br")(42,"br"),nn(),pn(43,"br")(44,"br")(45,"br")(46,"br"),nn()())},styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.border[_ngcontent-%COMP%]{width:80%;height:80%;overflow:auto;position:absolute;background-color:#fffc}h2[_ngcontent-%COMP%]{font-size:1rem;z-index:999}.aparecer[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_aparecer-animacion 2s ease-out}@keyframes _ngcontent-%COMP%_aparecer-animacion{0%{opacity:0}to{opacity:1}}.grid-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.grid-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(2,1fr);gap:10px}.size[_ngcontent-%COMP%]{width:50px;height:50px}.habilidades[_ngcontent-%COMP%]{text-align:center}@media (min-width: 1124px){h2[_ngcontent-%COMP%]{font-size:1.3rem;width:300px;margin-left:1rem;margin-top:1rem}.grid-container[_ngcontent-%COMP%]{display:flex;justify-content:start;align-items:center}.grid-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(2,1fr);gap:10px}.border[_ngcontent-%COMP%]{background-color:#fffc}}"]}),n})(),D$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ta({type:n,selectors:[["app-inicio"]],decls:3,vars:0,consts:[[1,"container"],[1,"titulo"]],template:function(t,i){1&t&&(En(0,"div",0)(1,"h1",1),Wn(2," InfinitiMobile \u221e"),nn()())},styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.titulo[_ngcontent-%COMP%]{z-index:1;position:absolute;top:50%;right:28%;width:auto;height:auto;font-size:4rem}.aparecer[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_aparecer-animacion 2s ease-out}@keyframes _ngcontent-%COMP%_aparecer-animacion{0%{opacity:0}to{opacity:1}}@media (max-width: 1123px){.titulo[_ngcontent-%COMP%]{z-index:1;position:absolute;top:60%;right:10%;width:auto;height:auto;font-size:3rem}}@media (max-width: 800px){.titulo[_ngcontent-%COMP%]{z-index:1;position:absolute;top:60%;right:10%;width:auto;height:auto;font-size:1.5rem}}@media (max-width: 1920px){.titulo[_ngcontent-%COMP%]{font-size:3rem}}"]}),n})();function C$(n,e){1&n&&pn(0,"app-inicio")}function A$(n,e){1&n&&pn(0,"app-sobre-mi")}let I$=(()=>{class n{constructor(){this.titulo="Sobre El Modelo",this.title="portafolioNuevo2",this.mostrarSobreMi=!1,this.mostrarInicio=!0,this.mostrarProyecto=!1}mostrarInfoSobreMi(){this.mostrarSobreMi?(this.titulo="Sobre El Modelo",this.mostrarInicio=!0):(this.titulo="Inicio",this.mostrarProyecto=!1,this.mostrarInicio=!1),this.mostrarSobreMi=!this.mostrarSobreMi}mostrarInfoProyectos(){this.mostrarProyecto?this.mostrarInicio=!0:(this.titulo="Sobre Mi",this.mostrarSobreMi=!1,this.mostrarInicio=!1),this.mostrarProyecto=!this.mostrarProyecto}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ta({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:[["rel","preconnect","href","https://fonts.googleapis.com"],["rel","preconnect","href","https://fonts.gstatic.com","crossorigin",""],["href","https://fonts.googleapis.com/css2?family=Julius+Sans+One&display=swap","rel","stylesheet"],[1,"container"],[1,"border"],[1,"menu"],[1,"fuente1",3,"click"],[4,"ngIf"]],template:function(t,i){1&t&&(pn(0,"link",0)(1,"link",1)(2,"link",2),En(3,"body")(4,"div",3)(5,"div",4)(6,"div",5)(7,"h2",6),Ag("click",function(){return i.mostrarInfoSobreMi()}),Wn(8),nn()(),pn(9,"app-background")(10,"app-loading"),Sg(11,C$,1,0,"app-inicio",7),Sg(12,A$,1,0,"app-sobre-mi",7),En(13,"footer")(14,"div")(15,"h5"),Wn(16,"\xa92023 Eduardo C\xe9spedes"),nn()()()()(),pn(17,"app-loading"),nn()),2&t&&(Zd(8),Fg(i.titulo),Zd(3),lf("ngIf",i.mostrarInicio),Zd(1),lf("ngIf",i.mostrarSobreMi))},dependencies:[PT,cj,E$,T$,D$],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}body[_ngcontent-%COMP%]{background-color:#fff;font-family:Julius Sans One,sans-serif;color:#000}.border[_ngcontent-%COMP%]{width:90%;height:90%;border:solid 6px rgb(0,0,0)}footer[_ngcontent-%COMP%]{margin-top:1rem;text-align:center}.container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.h2[_ngcontent-%COMP%]{font-size:1rem;-webkit-user-select:none;user-select:none;cursor:pointer}.menu[_ngcontent-%COMP%]{display:flex;position:absolute;top:0;font-size:.8rem;width:90%;height:auto;justify-content:space-between;align-items:center;z-index:1}@media (min-width: 300px){.menu[_ngcontent-%COMP%]{display:flex;position:absolute;top:0;width:90%;height:auto;justify-content:space-between;align-items:center;z-index:1}h2[_ngcontent-%COMP%]{font-size:.8rem;margin-top:1rem;font-weight:50}}@media (min-width: 600px) and (max-width: 1000px){.menu[_ngcontent-%COMP%]{display:flex;position:absolute;top:0;font-size:.8rem;width:90%;height:auto;justify-content:space-between;align-items:center;z-index:1}h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-top:1rem;font-weight:50}}@media (min-width: 1024px){.menu[_ngcontent-%COMP%]{display:flex;position:absolute;top:0;font-size:.8rem;width:90%;height:auto;justify-content:center;align-items:center;z-index:1}h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-top:1rem;font-weight:100;writing-mode:vertical-rl;-webkit-user-select:none;user-select:none;cursor:pointer}.fuente1[_ngcontent-%COMP%]{position:absolute;white-space:nowrap;top:3rem;right:-2rem;font-size:2rem}.fuente2[_ngcontent-%COMP%]{position:absolute;top:12rem;right:-2rem}}@media (max-width: 800px){.fuente1[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 1920px){.fuente1[_ngcontent-%COMP%]{font-size:2rem}}"]}),n})(),R$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yl({type:n,bootstrap:[I$]}),n.\u0275inj=Qo({imports:[RV]}),n})();AV().bootstrapModule(R$).catch(n=>console.error(n))}},zt=>{zt(zt.s=781)}]);